<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"> <html>
<head>
<title>Chapter 2 - Image Processing Methods - USGS Open File Report 97-287</title>
<meta name="author" content="Trent H. Faust">
<meta name="description" content="Image Processing Methods:
Procedures in selection, registration, normalization and 
enhancement of satellite imagery in coastal wetlands">
<meta name="keywords" content="florida, south carolina, Big Bend, gulf, mexico, wetland">
</head>
<body bgcolor="ffffff" text="000000" link="006666" vlink="663333" alink="ff0000"> 
<!--USGS Identifier Graphic-->
 <a href="http://www.usgs.gov/"><img border=0 width=480 height=72 
alt="USGS Home - www.usgs.gov" src="./ofrbanner.jpg"></a><br><a href="/"><img 
src="/images/usgs/cfcg.gif" alt="Center for Coastal Geology Home" width=219 
height=31 border=0></a>
<br> 
<font face="arial,helvetica"><b><font size=+1>Image Processing Methods</font><br>
Procedures in selection, registration, normalization and 
enhancement of satellite imagery in coastal wetlands</font></b>
<p>

<table border=0 align=left cellpadding=0 cellspacing=0>
<tr><td><table border=0 cellpadding=0 cellspacing=0>

<tr>
<td colspan=3 bgcolor="770000" align=center><font face="arial,helvetica" size=-1 color="ddd9b2"><b>TABLE OF CONTENTS</b></font></td>
</tr>
<tr>
<td colspan=3 height=2><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>

<tr>
<td colspan=3 align=center><font face="arial,helvetica" size=-1><b><a href="disclaimer.html">DISCLAIMER</a></b></font></td>
</tr>

<tr>
<td colspan=3 height=2><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>
<tr>
<td colspan=3 height=2 bgcolor="770000"><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>
<tr>
<td colspan=3 height=2><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>

<tr>
<td colspan=3 align=center><font face="arial,helvetica" size=-1><b><a href="disclaimer.html#illustrations">Illustrations</a></b><br>
<b><a href="disclaimer.html#tables">Tables</a></b><br>
<b><a href="disclaimer.html#equations">Equations</a></b></font></td>
</tr>

<tr>
<td colspan=3 height=2><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>
<tr>
<td colspan=3 height=3 bgcolor="770000"><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>
<tr>
<td colspan=3 height=2><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>

<tr>
<td colspan=3><font face="arial,helvetica" size=-1><b><a href="./">INTRODUCTION</a></b></font></td>
</tr>

<tr>
<td colspan=3 height=2><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>
<tr>
<td colspan=3 height=3 bgcolor="770000"><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>
<tr>
<td colspan=3 height=2><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>

<tr>
<td colspan=3><font face="arial,helvetica" size=-1><b><a href="./chapter1.html">CHAPTER 1: IMAGE<br>PROCESSING METHODS</a></b></font></td>
</tr>

<tr>
<td colspan=3 height=2><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>
<tr>
<td colspan=3 height=2 bgcolor="770000"><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>

<td valign=top><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.1">1.1</a></b></font></td>
<td><font face="arial,helvetica" size=-2>&nbsp;&nbsp;</font></td>
<td><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.1">SCENE SELECTION</a></b></font></td>
</tr>
<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.1.1">1.1.1</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.1.1">Season</a></b></font></td>
</tr>
<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.1.2">1.1.2</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.1.2">Water Level</a></b></font></td>
</tr>
<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.1.3">1.1.3</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.1.3">Cloud cover</a></b></font></td>
</tr>
<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.1.4">1.1.4</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.1.4">Simultaneous coverage</a></b></font></td>
</tr>
<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.1.5">1.1.5</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.1.5">Specifications</a></b></font></td>
</tr>

<tr>
<td colspan=3 height=2><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>
<tr>
<td colspan=3 height=2 bgcolor="770000"><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>

<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.2">1.2</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.2">SCENE PREPARATION</a></b></font></td>
</tr>
<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.2.1">1.2.1</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.2.1">Download raw imagery</a></b></font></td>
</tr>
<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.2.2">1.2.2</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.2.2">Check header file</a></b></font></td>
</tr>
<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.2.3">1.2.3</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.2.3">Visual check</a></b></font></td>
</tr>
<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.2.4">1.2.4</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.2.4">Line replacement<br>and destriping</a></b></font></td>
</tr>

<tr>
<td colspan=3 height=2><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>
<tr>
<td colspan=3 height=2 bgcolor="770000"><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>

<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.3">1.3</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.3">ORTHORECTIFICATION<br>OF IMAGERY</a></b></font></td>
</tr>
<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.3.1">1.3.1</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.3.1">Coordinate System</a></b></font></td>
</tr>
<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.3.2">1.3.2</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.3.2">Ground control in image</a></b></font></td>
</tr>
<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.3.3">1.3.3</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.3.3">Ground control in field</a></b></font></td>
</tr>
<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.3.4">1.3.4</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.3.4">Create model</a></b></font></td>
</tr>
<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.3.5">1.3.5</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.3.5">Satellite image<br>rectification</a></b></font></td>
</tr>
<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.3.6">1.3.6</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.3.6">Accuracy check</a></b></font></td>
</tr>

<tr>
<td colspan=3 height=2><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>
<tr>
<td colspan=3 height=2 bgcolor="770000"><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>

<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.4">1.4</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.4">RADIOMETRIC AND<br>ATMOSPHERIC<br>CORRECTIONS</a></b></font></td>
</tr>
<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.4.1">1.4.1</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.4.1">Radiometric correction</a></b></font></td>
</tr>
<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.4.2">1.4.2</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.4.2">Atmospheric correction</a></b></font></td>
</tr>
<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.4.3">1.4.3</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.4.3">Aerosol correction</a></b></font></td>
</tr>

<tr>
<td colspan=3 height=2><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>
<tr>
<td colspan=3 height=2 bgcolor="770000"><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>

<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.5">1.5</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.5">INDICES</a></b></font></td>
</tr>
<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.5.1">1.5.1</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.5.1">Vegetation Index</a></b></font></td>
</tr>
<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.5.2">1.5.2</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.5.2">Wetness Index</a></b></font></td>
</tr>
<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.5.3">1.5.3</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.5.3">Temperature</a></b></font></td>
</tr>
<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.5.4">1.5.4</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="./chapter1.html#1.5.4">Water Reflectance</a></b></font></td>
</tr>

<tr>
<td colspan=3 height=2><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>
<tr>
<td colspan=3 height=3 bgcolor="770000"><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>
<tr>
<td colspan=3 height=2><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>

<tr>
<td colspan=3 bgcolor="006666"><font face="arial,helvetica" size=-1 color="ddd9b2"><b>&nbsp;CHAPTER 2: IMAGE<br>&nbsp;PROCESSING SOFTWARE<br>PROCEDURES</b></font></td>
</tr>

<tr>
<td colspan=3 height=2><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>
<tr>
<td colspan=3 height=2 bgcolor="770000"><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>

<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="#2.0">2.0</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="#2.0">INTRODUCTION</a></b></font></td>
</tr>

<tr>
<td colspan=3 height=2><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>
<tr>
<td colspan=3 height=2 bgcolor="770000"><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>

<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="#2.1">2.1</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="#2.1">SCENE PREPARATION</a></b></font></td>
</tr>

<tr>
<td colspan=3 height=2><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>
<tr>
<td colspan=3 height=2 bgcolor="770000"><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>

<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="#2.2">2.2</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="#2.2">ORTHORECTIFICATION<br>OF IMAGERY</a></b></font></td>
</tr>
<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="#2.2.1">2.2.1</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="#2.2.1">GCPWORKS</a></b></font></td>
</tr>
<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="#2.2.2">2.2.2</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="#2.2.2">GCPREP</a></b></font></td>
</tr>
<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="#2.2.3">2.2.3</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="#2.2.3">SMODEL</a></b></font></td>
</tr>
<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="#2.2.4">2.2.4</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="#2.2.4">CIM2 - New file<br>creation</a></b></font></td>
</tr>
<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="#2.2.5">2.2.5</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="#2.2.5">GEOSET - georeference<br>segment</a></b></font></td>
</tr>
<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="#2.2.6">2.2.6</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="#2.2.6">SORTHO - satellite image<br>orthorectification</a></b></font></td>
</tr>
<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="#2.2.7">2.2.7</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="#2.2.7">Inter-scene accuracy check</a></b></font></td>
</tr>

<tr>
<td colspan=3 height=2><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>
<tr>
<td colspan=3 height=2 bgcolor="770000"><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>

<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="#2.3">2.3</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="#2.3">RADIOMETRIC AND<br>ATMOSPHERIC CORRECTION</a></b></font></td>
</tr>
<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="#2.3.1">2.3.1</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="#2.3.1">TMRAD</a></b></font></td>
</tr>
<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="#2.3.2">2.3.2</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="#2.3.2">RAYRAD -<br>Rayleigh radiance</a></b></font></td>
</tr>
<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="#2.3.3">2.3.3</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="#2.3.3">Dark object<br>subtraction</a></b></font></td>
</tr>

<tr>
<td colspan=3 height=2><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>
<tr>
<td colspan=3 height=2 bgcolor="770000"><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>

<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="#2.4">2.4</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="#2.4">INDICES</a></b></font></td>
</tr>
<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="#2.4.1">2.4.1</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="#2.4.1">Bitmap creation</a></b></font></td>
</tr>
<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="#2.4.2">2.4.2</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="#2.4.2">Vegetation Index</a></b></font></td>
</tr>
<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="#2.4.3">2.4.3</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="#2.4.3">Wetness Index</a></b></font></td>
</tr>
<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="#2.4.4">2.4.4</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="#2.4.4">Thermal band 6<br>temperature</a></b></font></td>
</tr>
<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="#2.4.5">2.4.5</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="#2.4.5">Water reflectance</a></b></font></td>
</tr>
<tr>
<td valign=top><font face="arial,helvetica" size=-2><b><a href="#2.4.6">2.4.6</a></b></font></td>
<td></td>
<td><font face="arial,helvetica" size=-2><b><a href="#2.4.6">Brightness</a></b></font></td>
</tr>

<tr>
<td colspan=3 height=2><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>
<tr>
<td colspan=3 height=3 bgcolor="770000"><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>
<tr>
<td colspan=3 height=2><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>

<tr>
<td colspan=3><font face="arial,helvetica" size=-1><b><a href="./appendices.html#references">REFERENCES</a></b></font></td>
</tr>

<tr>
<td colspan=3 height=2><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>
<tr>
<td colspan=3 height=2 bgcolor="770000"><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>

<tr>
<td colspan=3><a href="./appendices.html#appendixA"><font face="arial,helvetica" size=-1><b>APPENDIX A:</b></font><br>
<font face="arial,helvetica" size=-2><b>Image Pre-Processing Outline</b></font></a></td>
</tr>

<tr>
<td colspan=3 height=2><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>
<tr>
<td colspan=3 height=2 bgcolor="770000"><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>

<tr>
<td colspan=3><a href="./appendices.html#appendixB"><font face="arial,helvetica" size=-1><b>APPENDIX B:</b></font><br>
<font face="arial,helvetica" size=-2><b>Sample Header File</b></font></a></td>
</tr>

<tr>
<td colspan=3 height=2><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>
<tr>
<td colspan=3 height=2 bgcolor="770000"><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>

<tr>
<td colspan=3><a href="./appendices.html#appendixC"><font face="arial,helvetica" size=-1><b>APPENDIX C:</b></font><br>
<font face="arial,helvetica" size=-2><b>SMODEL Report</b></font></a></td>
</tr>

<tr>
<td colspan=3 height=2><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>
<tr>
<td colspan=3 height=2 bgcolor="770000"><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>

<tr>
<td colspan=3><a href="./appendices.html#appendixD"><font face="arial,helvetica" size=-1><b>APPENDIX D:</b></font><br>
<font face="arial,helvetica" size=-2><b>Data Storage</b></font></a></td>
</tr>

<tr>
<td colspan=3 height=2><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>
<tr>
<td colspan=3 height=2 bgcolor="770000"><img src="/images/tabs/dot_clear.gif" width=1 height=2></td>
</tr>

</table></td>
<td width=9>&nbsp;</td>
</tr></table>

<font face="arial,helvetica" size=+1><b>Chapter 2<br>
Image processing software procedures</b></font>
<a name="2.0">
<a name="plate4">
<p>

<font face="arial,helvetica"><b>2.0 INTRODUCTION</b></font>
<p>

Many of the image pre-processing steps 
are conducted within an image-processing 
software package.  The Center for Coastal 
Geology group uses PCI, Inc.  The following 
chapter includes specific instructions on running 
the procedures.  It should serve as a guide to the 
basic steps required within this program.
<p>

Initial scene selection and ordering is 
conducted outside of the image processing 
package.  A flow chart 
(<a href="#plate4"
onClick="window.open('./plate4.htm','plate4','location=0,resizable=1,scrollbars=1,height=480,width=530');">Plate 4</a>) 
is provided to 
help the novice follow the different kinds of steps 
involved and the order in which they are 
conducted.  The check list in <a name="./appendices.html#appendixA">Appendix A</a> 
should become the basis for your own notes, 
including adjustments and new developments.
<a name="2.1">
<p>

<font face="arial,helvetica"><b>2.1 SCENE PREPARATION</b></font>
<p>

Imagery is downloaded from the CD-ROM 
disk with CDNLAPS or CDEOSAT, 
depending on the format of the disk.  Important 
information is included in the header file.  Take 
time to learn to read the header file with the 
instructions accompanying your order.  Look for 
format (NLAPS or EOSAT), band sequential or 
pixel interleaved (BSQ, BIL), number of pixels 
and lines, date and time of acquisition, 
resampling scheme (NN, CC, BL), and so on.
<p>

Once downloaded to a .pix file, examine each 
band at full resolution for missing lines or blocks 
of missing data, heavy clouds, and the histogram 
of dn values.  Each band should exhibit a normal 
range and distribution for the season and region 
covered.  Now is the time to repair or return an 
image with serious problems.
<p>

<a href="#table3">Table 3</a> shows the parameters set for 
CDNLAPS.  <a href="#table4">Table 4</a> shows parameters set for 
LRP to fix line number 100 in band 2 with the 
mean from the line above and the line below.  
The EASI procedure, LRP, requires the operator 
to specify the missing line(s) +1 to correctly 
identify the lines to be replaced.  If destriping is 
attempted, read about DSTRIPE in EASI help.
<a name="2.2">
<p>

<font face="arial,helvetica"><b>2.2 ORTHORECTIFICATION OF IMAGERY</b></font>
<p>

The orbital segment created in 
CDEOSAT or CDNLAPS contains information 
used in an adjustment between the estimated 
latitude/longitude of the raw imagery and the 
desired coordinate system.  <a href="#2.2.3">SMODEL</a> creates a 
model from the orbital segment and a ground 
control point segment.  The ground control 
segment is created in <a href="#2.2.1">GCPWORKS</a>.
<a name="2.2.1">
<p>

<font face="arial,helvetica"><b>2.2.1 GCPWORKS</b></font>
<p>

Imagery for the Florida Wetlands is 
rectified with ground control collected with GPS 
units and is reprojected to the UTM coordinate 
system.  Ground control selection is described in 
<a href="./chapter1.html#1.3.2">Chapter 1</a>, and can be conducted in any image 
display program, including PCI's 
IMAGEWORKS.  Once the ground control has 
been identified and field collected, run 
GCPWORKS to enter the coordinates at their 
respective locations in the image.  The satellite 
orthorectification option is selected to permit the 
use of the orbital segment in the model.
<p>

Select "Collect/review GCPs only", 
"Satellite Ortho Correction", "User Entered 
Coordinates", and then "Select Uncorrected 
Image".  Enter the path and filename of the 
nlaps.pix file.  Load three bands, usually natural 
color (3,2,1) or false color (4,3,2) are preferred 
for display.  Set the units to meter, and the 
coordinate system to UTM, zone 17, row R and 
ellipsoid WGS84.  Obviously, the zone and row 
will change depending on the region.  Identify 
the location of 8 to 12 ground control points and 
enter the corresponding UTM coordinates 
collected with the GPS unit.
<p>

During the identification of ground 
control within GCPWORKS, watch the RMS 
error for each ground control point and the total 
RMS in both x and y.  Within reason, it is 
possible to adjust the location of the ground 
control in the imagery to achieve optimal 
positioning and distortion-free rectification.  
<p>

In GCPWORKS it is possible to also 
enter accuracy check points at this time.  If not 
working in this program, these check points are 
set aside for a post-rectification accuracy check.  
The 10-12 accuracy check points must be of 
equally high quality and well-distributed about 
the scene.  Care is given to treat these positions 
and the associated error objectively, as they 
eventually provide a measure of the model's 
accuracy.  These positions should be entered at 
the end, when the ground control points have 
been securely identified to avoid adjusting the 
model to fit the check points.  When the operator 
is satisfied with the location of  the ground 
control and the total RMS error, the ground 
control point segment is saved within 
GCPWORKS.  Ideally, this will be segment #3.
<a name="table3">
<p>

<center>
<table border=1 cellpadding=2 cellspacing=0>
<tr><td><font face="arial,helvetica" size=-1><b>Table 3.</b>  CDNLAPS procedure parameters</font></td>
</tr>
<tr><td>
<font size=-1><pre>
CDEOSAT CD EOSAT Fast Format                    V6.0 EASI/PACE  12:31 16-Feb-97
NLAPSHD - NLAPS Header File Name          :/cdrom/cdrom1/filename.hd
FILE    - Database File Name              :path/newfile.pix
CDIC    - CD Input Channel List           }        1        2        3        4        5        6        7   
TEX1    - Database Descriptive Text 1     :path_row_location
REPORT  - Report Mode: TERM/OFF/filename  :path/newfileorb.rep</pre></font></td>
</tr>
</table>
<a name="table4">
<p>

<table border=1 cellpadding=2 cellspacing=0>
<tr><td><font face="arial,helvetica" size=-1><b>Table 4.</b>  LRP, line replacement parameters</font></td>
</tr>
<tr><td>
<font size=-1><pre>
LRP     Image Line Replacement                  V6.0 EASI/PACE  08:29 17-Feb-97 
FILE    - Database File Name              :pathname/filenlaps.pix
DBOC    - Database Output Channel List    }        2
DBOW    - Database Output Window          >      101
RMOD    - Replacement Mode: ABOV/BELO/MEAN:MEAN
LINC    - Line Increment Factor           >        1</pre></font></td>
</tr>
</table>

</center>
<a name="2.2.2">
<p>

<font face="arial,helvetica"><b>2.2.2 GCPREP</b></font>
<p>

A report documenting the ground 
control point segment as collected is obtained by 
running GCPREP.  This produces a text file 
showing the list of ground control points, their 
pixel/line locations, the user-entered coordinates, 
and errors.  The UTM coordinates of the ground 
control is exactly what was entered within 
<a href="#2.2.1">GCPWORKS</a>.  This will change when the 
model is run in <a href="#2.2.3">SMODEL</a>.  Remember, in 
<a href="#2.2.1">GCPWORKS</a>, the satellite orthorectification was 
selected.  This forces the orbital segment to be 
referenced while developing the model.  
GCPREP does not refer to the orbital segment, 
and thus does not reflect it's influence on the 
ground control.  The output from another 
procedure, GCPWRIT, may be useful in creating 
a vector segment.  It requires a little editing and 
then running VREAD.  The vector may be 
displayed in subsequent displays to help relocate 
the ground control points for new imagery.
<a name="2.2.3">
<p>

<font face="arial,helvetica"><b>2.2.3. SMODEL</b></font>
<p>

SMODEL draws on both the orbital 
segment and the ground control point segment to 
create the model, and must always be run on the 
whole scene.  It is ineffective to run on a partial scene.  
If check points were entered 
along with the ground control, SMODEL will 
also produce a table showing the accuracy of the 
check points in meters.  Run SMODEL as 
shown in <a href="#table5">Table 5</a>.  Both the orbital segment, 2, 
and the ground control point segment, 3, must 
be specified in the procedure.  SMODEL 
produces a model segment, normally 4, which 
will be applied in the image rectification, 
<a href="#2.2.6">SORTHO</a>.
<p>

SMODEL also produces a report 
showing the accuracy of the check points in 
meters.  Examine the report for values outside of 
the range of expected and desired accuracy (see 
<a href="./appendices.html#appendixC">Appendix C</a>).  Excessive values below the 
original 10 m accuracy of the GPS positions may 
introduce distortion to the final image 
rectification.  Values greater than 20 m, or 2/3 
pixel, suggest the overall registration may not 
meet inter-scene registration requirements.  Note 
also that the UTM coordinates shift by the RMS 
error.  
<p>

Values for positional accuracy in this 
project are acceptable between 8-20 m.  The 
rectification of a TM scene will technically meet 
1:25,000 map accuracy standards, provided that 
90% or more of the individual accuracy check 
points are within 20 m or less of their desired 
location.  With 12 check points, only one can be 
<img src="./greaterorequal.jpg" width=8 height=12 align=absmiddle> 
20 m from its true location.  Although we 
achieve the reported level of map accuracy, TM 
imagery will always be printed at scales of 
1:50,000 or smaller to avoid the blocky 
appearance of the pixels.
<a name="table5">
<p>

<center>
<table border=1 cellpadding=2 cellspacing=0>
<tr><td><font face="arial,helvetica" size=-1><b>Table 5.</b>  SMODEL procedure parameters</font></td>
</tr>
<tr><td>
<font size=-1><pre>
SMODEL  Satellite Model Calculation             V6.0 EASI/PACE  10:57 19-Feb-97
FILE    - Database File Name              :path/newfile.pix
DBGC    - Database Ground Control Segment >        3
ORBIT   - Orbit Segment Number            >        2
MODEL   - Satellite Model Segment         >
MODINPUT- Modify Input                    :NO
ELLIPS  - Ellipsoid for the Earth         :E012
ERRUNIT - Error Unit: Pixel/Metre         :METRE
REPORT  - Report Mode: TERM/OFF/filename  :path/smodel.rep</pre></font></td>
</tr>
</table>
</center>
<a name="2.2.4">
<p>

<font face="arial,helvetica"><b>2.2.4 CIM2 - New file creation</b></font>
<p>

New imagery files are created in CIM2, 
a file format which creates a separate file for each 
band, all associated by the header or .pix file 
(<a href="#table6">Table 6</a>).  The size of a fully-processed full size 
Landsat TM scene makes this option appealing 
for ease of movement and disk-space issues.  The 
example shows the standard size of the north Big 
Bend image, path 18, row 39.  The size includes 
the removal of ~1100 lines in the state of Georgia 
and the enlargement of the file to reproject the 
region into the UTM coordinate system (see 
<a href="#2.2.4"
onClick="window.open('./figure3.htm','figure3','location=0,resizable=1,scrollbars=1,height=425,width=640');">Figure 3</a>).  All north scenes will be created in the 
same manner. If working in another region, 
establish a standard file size based on the full 
extent of the UTM eastings and northings and 
the pixel size.
<a name="table6">
<p>

<center>
<table border=1 cellpadding=2 cellspacing=0>
<tr><td><font face="arial,helvetica" size=-1><b>Table 6.</b>  Creation of new file for rectification in CIM2</font></td>
</tr>
<tr><td>
<font size=-1><pre>
CIM2    Create Database and Image Channel Files V6.0 EASI/PACE  14:14 16-Feb-97
FILE    - Database File Name              :path/newortfile.pix
TEX1    - Database Descriptive Text 1     :p18r39
TEX2    - Database Descriptive Text 2     :sortho file/northern Big Bend
DBSZ    - Database Size: Pixels, Lines    >     7556     5412
PXSZ    - Pixel Ground-Size in Metres     >       28.5       28.5
DBNC    - No. of Channels: 8U,16S,16U,32R >        7</pre></font></td>
</tr>
</table>
</center>
<a name="2.2.5">
<p>

<font face="arial,helvetica"><b>2.2.5  GEOSET - georeference segment</b></font>
<p>

Every file in PCI has a georeferencing 
segment created automatically as segment 1.  
<p>

The geographic boundaries, the UTM zone, and 
the ellipsoid are set for the georeferencing 
segment of the newly created CIM2 file 
with GEOSET.  An example for the 
north Big Bend is shown in <a href="#table7">Table 7</a>.  The 
coordinates given are applied to each 
corresponding image, making overlays and inter-
scene analysis a simple task.
<a name="table7">
<p>

<center>
<table border=1 cellpadding=2 cellspacing=0>
<tr><td><font face="arial,helvetica" size=-1><b>Table 7.</b>  Georeferencing segment set with GEOSET procedure in PCI</font></td>
</tr>
<tr><td>
<font size=-1><pre>
GEOSET  Set Georeferencing Segment              V6.0 EASI/PACE  14:10 19-Feb-97
FILE    - Database File Name              :path/newortfile.pix
UPLEFT  - Upper Left Position for Database>  3317100   201900
LORIGHT - Lower Right Position for Databas>  3085020   447000
MAPUNITS- Map Units: PIXEL/UTM/others     :UTM 17 R E012</pre></font></td>
</tr>
</table>
</center>
<a name="2.2.6">
<p>

<font face="arial,helvetica"><b>2.2.6 SORTHO - satellite image 
orthorectification</b></font>
<p>

Orthorectification of imagery is 
conducted in PCI with the SORTHO procedure 
which applies the model segment to the nlaps 
image file and reprojects the seven bands of data 
into the empty bands of the newly created and 
georeferenced .pix file.  See <a href="#table8">Table 8</a> for 
SORTHO parameters.
<p>

Due to the minimal topographic 
variation along the Big Bend coast of Florida, 
we do not employ a DEM file.  Instead, we 
estimate an average value for elevation as the 
width of one pixel with no offset (ESCALE).  
Elevations do not exceed ~60 m in the area, and 
this appears to be sufficient for positional 
accuracy and inter-scene registration.  The need 
for elevation must be determined on a region-by-
region basis.  The SORTHO procedure may 
take up to 6 hours on a SUN SPARC 20 and is 
usually run overnight.
<a name="table8">
<p>

<center>
<table border=1 cellpadding=2 cellspacing=0>
<tr><td><font face="arial,helvetica" size=-1><b>Table 8.</b>  Parameters for satellite orthorectification procedure</font></td>
</tr>
<tr><td>
<font size=-1><pre>
SORTHO  Satellite Image Orthorecification       V6.0 EASI/PACE  14:22 16-Feb-97
FILI    - Database Input File Name        :path/nlapsfile.pix
FILO    - Database Output File Name       :path/newortfile.pix
FILEDEM - Database DEM File Name          :
DBIC    - Database Input Channel List     }        1        2        3        4        5        6        7
DBOC    - Database Output Channel List    }        1        2        3        4        5        6        7
DBEC    - Database Elevation Channel List >
BACKELEV- Background Elevation Value      >
ESCALE  - Elevation Scale and Offset      >     28.5        0
DBIW    - Database Input Window           >
MODEL   - Satellite Model Segment         >        4
PXSZOUT - Output Pixel Ground-Size        >     28.5     28.5
RESAMPLE- Resample Mode: NEAR/BILIN/CUBIC :NEAR</pre></font></td>
</tr>
</table>
</center>
<a name="2.2.7">
<p>

<font face="arial,helvetica"><b>2.2.7  Inter-scene accuracy check</b></font>
<p>

The inter-scene registration accuracy 
check is conducted manually within an image 
display program.  Run IMAGEWORKS with a 
full-resolution window ~600 x 800 with 6 image 
planes.  Display 3-5 well-distributed regions in 
the window, each time loading the newly 
registered image (4,3,2) and the base image 
(4,3,2) with the <strong>same</strong> input window.
<p>

For instance, in image planes 1,2,3 load 
the new image (4,3,2) with an input window of 
300, 300 (x,y offsets), 600, 800 (x,y window 
size).  Then load the base image to image planes 
4,5,6 (4,3,2) using the same full-resolution 
window.  Examine the images first with a single 
band from each of the images in a RGB display 
mode.  An example may be viewed in 
<a href="#2.2.7"
onClick="window.open('./plate3.htm','plate3','location=0,resizable=1,scrollbars=1,height=480,width=640');">Plate 3</a>.  
Look for truly horizontal or vertical roads and 
evaluate obvious offsets.  A poorly registered 
image as shown to the left in 
<a href="#2.2.7"
onClick="window.open('./plate3.htm','plate3','location=0,resizable=1,scrollbars=1,height=480,width=640');">Plate 3</a> is not 
worth evaluating further.  Note the direction of 
the offsets, check other regions to confirm the 
offsets, and return to <a href="#2.2.1">GCPWORKS</a> to redo the 
ground control point segment.
<p>

If horizontal and vertical roads align 
well in the first input window, switch to a flicker 
state with each image displayed 4,3,2 as RGB.  
Select 3-5 right-angle road intersections for 
evaluation.  See 
<a href="#2.2.7"
onClick="window.open('./plate2.htm','plate2','location=0,resizable=1,scrollbars=1,height=480,width=640');">Plate 2</a> 
for selection of road 
intersections.  Flicker to the base image and 
zoom in on a selected intersection.  Place the 
cursor at the center of the intersection, drawing 
two imaginary lines N/S and E/W to determine 
the exact location.  Leaving the cursor in 
position, flicker to the newly registered image.  
Again, mentally draw two lines and determine 
the exact center of the new intersection.  Do not 
move the cursor.  Evaluate if the cursor is exactly 
on target, off by 0.5 pixel, 1.0 pixel, or > 1.0 
pixel in both the x and y directions.  See 
<a href="#2.2.7"
onClick="window.open('./plate1.htm','plate1','location=0,resizable=1,scrollbars=1,height=480,width=710');">Plate 1</a> 
for evaluation of cursor location.
<p>

Complete a table as follows, with 12-20 
road intersections across the scene.  The table 
will highlight regional or full-scene offsets.  If all 
regions, and the whole scene meet expectations 
of &#0177; one pixel inter-scene alignment, then the 
new file is acceptable, and image processing 
proceeds.  If, however, a region or the whole 
scene exceeds one pixel offset in either direction, 
then <a href="#2.2.1">GCPWORKS</a>, <a href="#2.2.3">SMODEL</a> and <a href="#2.2.5">SORTHO</a> 
must be repeated.  The table may be used to help 
guide the adjustment of the ground control 
points.
<p>

<center>
<table border=0 cellpadding =0 cellspacing=0><tr>
<td>For example in a TM scene:<table border=1 cellpadding=2 cellspacing=0>
<tr><td>

<pre>
Region   x offset (pixel)   y-offset (pixel)
NW 1		0 		0.5 -
NW 2		0.5 +		0.5 -
NW 3		1.0 +		0.5 -
NE 1		0		0.5 -
NE 2		0.5 +		0
NE 3		0.5 +		0.5 -
SE 1		0.5 +		1.0 -
SE 2		0.5 +		0
SE 3		0		0.5 -
SW 1		0.5 +		0.5 +
SW 2		0.5 +		0.5 +
SW 3		0.5 +		0.5 +</pre></td>
</tr>
</table></td>
</tr></table>
</center>
<a name="2.3">
<p>

<font face="arial,helvetica"><b>2.3 RADIOMETRIC AND 
ATMOSPHERIC CORRECTION</b></font>
<p>

The following sections illustrate the 
EASI procedures used for radiometric calibration 
and atmospheric correction.  Information from the 
header file is employed in the procedures.  A 
bitmap is created first to mask the non-image 
pixels of the *ort.pix file. Typically the mask 
can be obtained by selecting all pixels in band 1 
or band 2 with values greater than zero.  The mask 
is subsequently used for the creation of indices 
and other analysis.  Limiting the processing to 
the image area of the file shortens processing 
time and eliminates the formation of anomalous 
features outside of the image area.  The EASI 
thresholding procedure, THR may be used for 
creating the bitmap (<a href="#table9">Table 9</a>).  If necessary a 
similar mask may be created for the non-image 
area by setting the COMP parameter to "ON".  
The complement is used to fix anomalous data 
sometimes found in band 6.
<a name="table9">
<p>

<center>
<table border=1 cellpadding=2 cellspacing=0>
<tr><td><font face="arial,helvetica" size=-1><b>Table 9.</b>  Bitmap creation with THR</font></td>
</tr>
<tr><td>
<font size=-1><pre>
THR     Thresholding Image to Bitmap            V6.0 EASI/PACE  09:34 17-Feb-97
FILE    - Database File Name              :fltms/fileort.pix
DBIC    - Database Input Channel List     }        1
DBOB    - Database Output Bitmap          }
TVAL    - Threshold Value (Min,Max)       >        1      255
COMP    - Complement: ON/OFF              :OFF
DBSN    - Database Segment Name           :imageon
DBSD    - Database Segment Descriptor     :image bitmap excluding non-image border</pre></font></td>
</tr>
</table>
</center>
<a name="2.3.1">
<p>

<font face="arial,helvetica"><b>2.3.1 TMRAD</b></font>
<p>

Seven additional empty channels are 
added using PCIADD2.  These are the output 
channels for the radiometrically enhanced bands, 
8-14.  TMRAD is an in-house EASI procedure 
which solves equations 1 and 2 in section <a href="./chapter1.html#1.4.1">1.4.1</a>.  
Sample parameters are set in <a href="#table10">Table 10</a>.  
Latitude and longitude are given in decimal degrees, and 
longitude is a negative value in the western hemisphere. 
TMSLOPE and TMBIAS may be obtained from the newer header 
files as Gain/10 and Bias/10, respectively.  The solar constants 
(from Markham and Barker, 1986) and scale factors will 
change for different imagery and satellites.  TEXT may 
be set to "stat" for a check on the output values
<a href="#table11">Table 11</a>, which is also 
saved to a text file for reference.
<a name="table10">
<p>

<center>
<table border=1 cellpadding=2 cellspacing=0>
<tr><td><font face="arial,helvetica" size=-1><b>Table 10.</b>  EASI procedure TMRAD</font></td>
</tr>
<tr><td>
<font size=-1><pre>
TMRAD - radiometric correction of TM imagery    V5.3 EASI/PACE  09:10 15-Aug-95
FILE    - Database File Name              :/imagery/tm95/TM19950402
DBIC    - Database Input Channel List     >      1      2      3      4      5      6      7   
DBOC    - Database Output Channel List    >      8      9     10     11      12     13     14
DATESITE   - J.day,  GMT,  lat, long (W < 0) >       92     1511  28.8686 -82.4237
TMSLOPE - Slope for TM or MSS band        >   0.0632   0.1254   0.0964   0.0907
                                              0.0125   0.0055   0.0067
TMBIAS  - TM or MSS offsets for channels 1>   -0.118  -0.1935  -0.1697  -0.1628
                                             -0.0248   0.1238  -0.0125
TMSOLAR - TM or MSS solar constants 1 - 7 >    195.7    182.9    155.7    104.7
                                               21.93        1    7.452
SCALEF  - Scale factor for units to counts>    500    500    500    500    500    100    
500
TEXT    - Text input                      :seg</pre></font></td>
</tr>
</table>
<a name="table11">
<p>

<table border=1 cellpadding=2 cellspacing=0>
<tr><td><font face="arial,helvetica" size=-1><b>Table 11.</b>  TMRAD output</font></td>
</tr>
<tr><td>
<font size=-1><pre>
Julian Day (year-day)=       92
             Time (GMT)           =     1511
             Lat/long             =  28.8686  -82.4237
***          Solar zenith angle   =   40.5686  degrees  ***
***          Solar azimuth angle  =  119.377   degrees  ***
***          Earth-sun distance   =   0.999353  a.u.    ***
cos(sza) = 0.759628
band #        1         10.00133387
    slope    bias    solar  irradiance  refl/ct
  0.0632   -0.118    195.7     148.852   0.00133387
band #        2         20.00283185
    slope    bias    solar  irradiance  refl/ct
  0.1254  -0.1935    182.9     139.116   0.00283185
band #        3         30.00255726
    slope    bias    solar  irradiance  refl/ct
  0.0964  -0.1697    155.7     118.427   0.00255726
band #        4         40.00357806
    slope    bias    solar  irradiance  refl/ct
  0.0907  -0.1628    104.7      79.636   0.00357806
band #        5         50.00235428
    slope    bias    solar  irradiance  refl/ct
  0.0125  -0.0248    21.93     16.6802   0.00235428
band #        6         6  0.0055
    slope    bias    solar  irradiance  refl/ct
  0.0055   0.1238        1    0.760612     0.0055
band #        7         70.00371355
    slope    bias    solar  irradiance  refl/ct
  0.0067  -0.0125    7.452     5.66808   0.00371355</pre></font></td>
</tr>
</table>
</center>
<a name="2.3.2">
<p>

<font face="arial,helvetica"><b>2.3.2 RAYRAD - Rayleigh radiance</b></font>
<p>

The Rayleigh correction factor is 
calculated with RAYRAD.  Calculations may be 
found in Stumpf (1992).  The procedure requires 
operator input as in <a href="#table12">Table 12</a>, and produces 
output as in <a href="#table13">Table 13</a>.  The scale factor should 
be the same as that used in TMRAD.
<p>

Bands 1 - 4 are corrected by subtracting 
the Rayleigh values from each band respectively. 
The Rayleigh values are the last column in <a href="#table13">Table 13</a>, 
rounded to the nearest whole number.  Values for 
bands 5 and 7 are insignificant, and for band 6, 
irrelevant.
The model used to accomplish the subtraction is 
shown in <a href="#table14">Table 14</a>.  
The bitmap is specified with "%%2" and band 8 
as "%8".
Keep in mind that the 
radiometrically enhanced bands, 8 - 14, are 
equivalent to  TM bands 1 - 7.
<a name="table12">
<p>

<center>
<table border=1 cellpadding=2 cellspacing=0>
<tr><td><font face="arial,helvetica" size=-1><b>Table 12.</b> RAYRAD input</font></td>
</tr>
<tr><td>
<font size=-1><pre>
/pci/usgs/bin: rayrad
 enter latitude (decimal degrees)
30.31
 enter longitude (decimal degrees, where west < 0)
-83.92
 enter time in GMT, (hhmm)
1537
 enter Julian day
119
 enter scalefactor (conversion of reflectance to counts for processed imagery)
500</pre></font></td>
</tr>
</table>
</center>
<a name="table13">
<p>

<center>
<table border=1 cellpadding=2 cellspacing=0>
<tr><td><font face="arial,helvetica" size=-1><b>Table 13.</b>  RAYRAD output</font></td>
</tr>
<tr><td>
<font size=-1><pre>
channel  radiance    reflectance    counts
1      3.5128        0.0571        28.5
2      1.6372        0.0285        14.2
3      0.7739        0.0158         7.9
4      0.1991        0.0060         3.0
5      0.0026        0.0004         0.2

solar constants       tau r          tau g
196.0             0.17110         0.01
183.0             0.08920         0.03
156.0             0.04840         0.02
105.0             0.01850         0.02
21.7             0.00110         0.00
solar declination =    14.686262184445
solar zenith angle =    31.398820329709
solar azimuth =    113.20862349932</pre></font></td>
</tr>
</table>
</center>
<a name="table14">
<p>

<center>
<table border=1 cellpadding=2 cellspacing=0>
<tr><td><font face="arial,helvetica" size=-1><b>Table 14.</b>  Rayleigh subtraction model</font></td>
</tr>
<tr><td>
<font size=-1><pre>
doc     *************************************************************
doc     Correction of the radiance values gathered from using the
doc     rayrad program.  This program will allow corrections of the
doc     digital numbers for bands 1 through 7
doc     *************************************************************
doc_end
monitor = "ON"
report = "TERM"

file = "/path/fileort.pix"
see file
MODEL ON  file
35      if (%%2 = 1) %8 = %8-29
rem 36  print "29 subtracted from dn for band 1"
40      if (%%2 = 1) %9 = %9-14
rem 41  print "14 subtracted from dn for band 2"
45      if (%%2 = 1) %10 = %10-8
rem 46  print " 8 subtracted from dn for band 3"
50      if (%%2 = 1) %11 = %11-3
rem 51  print " 3 subtracted from dn for band 4"
55      if (%%2 = 1) %12 = %12
rem 56  print " 0 subtracted from dn for band 5"
60      if (%%2 = 1) %13 = %13
rem 61  print " 0 subtracted from dn for band 6"
65      if (%%2 = 1) %14 = %14
rem 66  print " 0 subtracted from dn for band 7"
ENDMODEL
100 return</pre></font></td>
</tr>
</table>
</center>
<a name="2.3.3">
<a name="table15">
<p>

<font face="arial,helvetica"><b>2.3.3 Dark object subtraction</b></font>
<p>

<table align=right border=1 cellpadding=2 cellspacing=0 hspace=5>
<tr><td><font face="arial,helvetica" size=-1><b>Table 15.</b><br>Darkwater values:</font></td>
</tr>
<tr><td>
Channel 1: 16<br>
Channel 2: 12<br>
Channel 3:  8<br>
Channel 4:  6
</td>
</tr>
</table>

Final atmospheric correction values are 
selected manually from a full-resolution display 
of bands 1 - 4, focused on areas of dark water.  
The subtraction itself can be conducted with 
EASI procedure, ARI, or with a model similar to 
<a href="#table14">Table 14</a>.  The values shown in <a href="#table15">Table 15</a> are in 
the normal range for the region of the Big Bend 
coast. All channel descriptors (image layer 
histories) are renamed using MCD to more 
accurately describe the contents of the channel 
based on the pre-processing applied.
<a name="2.4">
<br clear=all><br>

<font face="arial,helvetica"><b>2.4 INDICES</b></font>
<p>

Several indices are calculated at the final point 
in processing.  An additional band is added to the 
.pix file for each index desired.  Be sure to specify 
the correct band number when calculating an index.  
The examples below are based on the radiometrically 
enhanced data residing in bands 1-7.  It is possible 
to protect previously processed image channels from 
accidental overwrites with the LOCK procedure.
<p>
<a name="2.4.1">
<font face="arial,helvetica"><b>2.4.1 Bitmap creation</b></font>
<p>

A mask is employed to permit 
processing and modeling of image-only pixels. .  
The mask is created by selecting all pixels with 
a value of > 0 in TM band 1 or 2.  The new 
bitmap segment is on at every image pixel and 
off at all non-image pixels.  It is important that 
the operator check the band at full-resolution to 
ensure there are no zero values in the image area 
itself before running this procedure.  The results 
can be checked afterwards on full-resolution 
display.  Failure to check may result in missing 
data in the index channels.  The mask is created 
by running THR as in <a href="#table9">Table 9</a>. 
The mask allows the operator to run processes on 
image data only, maintaining values of zero in 
non-image areas of the file.
<a name="2.4.2">
<p>

<font face="arial,helvetica"><b>2.4.2  Vegetation Index</b></font>
<p>

The vegetation index, NDVI may be 
calculated in the EASI procedure, RTR (<a href="#table16">Table 
16</a>).  Alternatively, a model can be written to 
take the input channels 3 and 4 and write output 
NDVI to channel 8.  Differences in NDVI 
between two years may range from ~-90 to +90.  
These values are re-scaled to range from 1 - 200.
<a name="equation7">
<p>

<center>
<table border=1 cellpadding=2 cellspacing=0>
<tr><td align=center>
<font face="arial,helvetica" size=-1><b>EQUATION 7.</b>  EASI MODEL FOR NDVI</font></td>
</tr>
<tr><td align=center>
%8 = 100 * (%4 - %3) / (%4 + %3)
</td>
</tr></table>
<p>
</center>
<a name="2.4.3">
<p>

<font face="arial,helvetica"><b>2.4.3  Wetness Index</b></font>
<p>

The wetness index may be calculated 
with EASI procedure, ARI (<a href="#table17">Table 17</a>).  It may 
also be run as an EASI model:
<a name="equation8">
<p>

<center>
<table border=1 cellpadding=3 cellspacing=0>
<tr><td align=center>
<font face="arial,helvetica" size=-1><b>EQUATION 8.</b>  EASI MODEL FOR WETNESS INDEX</font></td>
</tr>
<tr><td align=center>
%9 = %5 - %2
</td>
</tr></table>
<p>
</center>
<a name="2.4.4">
<p>

<font face="arial,helvetica"><b>2.4.4  Thermal band 6 temperature</b></font>
<p>

Temperature is calculated from TM 
thermal band 6 (Markham and Barker, 1986) to 
degrees Celcius plus 5.  We add 5 degrees to adjust for 
close to freezing temperatures which may 
occasionally occur in the Big Bend region.  The 
model is run from a file as follows:
<a name="equation9">
<p>

<center>
<table border=1 cellpadding=3 cellspacing=0>
<tr><td align=center>
<font face="arial,helvetica" size=-1><b>EQUATION 9.</b> EASI MODEL FOR TEMPERATURE 
IN CELSIUS</font><br></td>
</tr>
<tr><td align=center>
<table broder=0 cellpadding=0 cellspacing=0>
<tr><td>
<font size=-1><pre>
MODEL ON "/pathname/filename.pix
if %%2 = 1  %10 = 
(1260.56/ln(60.776/(%6/100)+1)-268);
ENDMODEL</pre></font></td>
</tr>
</table></td>
</tr></table>
<p>
</center>
<p>

where segment 2 is a bitmap, masking image-
only pixels.
<a name="2.4.5">
<p>

<font face="arial,helvetica"><b>2.4.5 Water reflectance</b></font>
<p>

Water reflectance can be calculated with 
EASI procedure, ARI, (<a href="#table18">Table 18</a>) or as follows:
<a name="equation10">
<p>

<center>
<table border=1 cellpadding=3 cellspacing=0>
<tr><td align=center>
<font face="arial,helvetica" size=-1><b>EQUATION 10.</b>  EASI MODEL FOR WATER 
REFLECTANCE</font></td>
</tr>
<tr><td align=center>
%11 = %2 - %4
</td>
</tr></table>
<p>
</center>
<a name="2.4.6">
<p>

<font face="arial,helvetica"><b>2.4.6  Brightness</b></font>
<p>

Brightness is merely TM band 2 with 
the appropriate adjustments for radiometric 
enhancement and atmospheric corrections.  This 
is sufficient for comparison of brightness between 
scenes.
<a name="table16">
<p>

<center>
<table border=1 cellpadding=2 cellspacing=0>
<tr><td><font face="arial,helvetica" size=-1><b>Table 16.</b>  Calculation of NDVI using EASI RTR</font></td>
</tr>
<tr><td>
<font size=-1><pre>
RTR     Real Database Channel Ratioing          V6.0 EASI/PACE  14:54 16-Feb-97
FILE    - Database File Name              :path/fileort.pix
CNUM    - Channels for Ratio Numerator    }       4       3
WNUM    - Weights for Ratio Numerator     >        1       -1
NCON    - Constant for Ratio Numerator    >        0
CDEN    - Channels for Ratio Denominator  }       4       3
WDEN    - Weights for Ratio Denominator   >     0.01     0.01
DCON    - Constant for Ratio Denominator  >        0
DBOC    - Database Output Channel List    >       8
SMOD    - Scaling Mode: NONE/AUTO/LOGS    :NONE
MASK    - Area Mask (Window or Bitmap)    >        2
ZERODIV - Value for Division by Zero      >      255</pre></font></td>
</tr>
</table>
</center>
<a name="table17">
<p>

<center>
<table border=1 cellpadding=2 cellspacing=0>
<tr><td><font face="arial,helvetica" size=-1><b>Table 17.</b>  Calculation of the wetness index with EASI ARI</font></td>
</tr>
<tr><td>
<font size=-1><pre>
ARI     Image Channel Arithmetic                V6.0 EASI/PACE  14:34 16-Feb-97
FILE    - Database File Name              :path/fileort.pix
OPER    - Operator: ADD/SUB/MUL/DIV/AND/OR:SUB
CNST    - Input Scalar                    >        0
MASK    - Area Mask (Window or Bitmap)    >        2
DBIC    - Database Input Channel List     }       5      2
DBOC    - Database Output Channel List    >       9
ZERODIV - Value for Division by Zero      >      255
AUTO    - Autoscaling mode: ON/OFF/USER   :OFF
RVAL    - Function Min,Max, Output Min,Max></pre></font></td>
</tr>
</table>
</center>
<a name="table18">
<p>

<center>
<table border=1 cellpadding=2 cellspacing=0>
<tr><td><font face="arial,helvetica" size=-1><b>Table 18.</b> Calculation of water reflectance with EASI ARI procedure.</font></td>
</tr>
<tr><td>
<font size=-1><pre>
ARI     Image Channel Arithmetic                V6.0 EASI/PACE  14:34 16-Feb-97
FILE    - Database File Name              :path/fileort.pix
OPER    - Operator: ADD/SUB/MUL/DIV/AND/OR:SUB
CNST    - Input Scalar                    >        0
MASK    - Area Mask (Window or Bitmap)    >        2
DBIC    - Database Input Channel List     }        2       4
DBOC    - Database Output Channel List    >       11
ZERODIV - Value for Division by Zero      >      255
AUTO    - Autoscaling mode: ON/OFF/USER   :OFF
RVAL    - Function Min,Max, Output Min,Max></pre></font></td>
</tr>
</table>
</center>
<p>

<br clear=all>
<br> 
<font size=-1 face="arial,helvetica"><b> 
<a href="http://marine.usgs.gov/">Coastal and Marine Program</a> &gt; 
<a href="../../">Center for Coastal Geology</a> &gt; 
<a href="../../projects/">Research by Theme</a> &gt; 
<a href="../">Gulf of Mexico Tidal Wetlands</a> &gt;
<a href="./">Image Processing Methods - OFR 97-287</a> &gt;
Chapter 2
</b>  
<hr> 
<font size=-1 face="arial,helvetica">U.S. Department of the Interior, 
U.S. Geological Survey, Center for Coastal Geology<br> 
<b>http://coastal.er.usgs.gov/wetlands/ofr97-287/chapter2.html</b><br> 
Address questions and comments to <a href="/webmail.html"><b>Trent Faust - Webmaster
</b></a><br> 
Updated June 25, 1999 @ 10:31 AM   

<!--MODIFIER'S INITIALS IN PARENTHESES--> 
(THF)   

</font> 
</body>
</html>
