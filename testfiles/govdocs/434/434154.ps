%!PS-Adobe-2.0
%%Creator: dvipsk 5.58f Copyright 1986, 1994 Radical Eye Software
%%Title: kernels.dvi
%%Pages: 19
%%PageOrder: Ascend
%%BoundingBox: 0 0 612 792
%%EndComments
%DVIPSCommandLine: dvips -o kernels.ps kernels
%DVIPSParameters: dpi=300, compressed, comments removed
%DVIPSSource:  TeX output 2001.05.27:1326
%%BeginProcSet: texc.pro
/TeXDict 250 dict def TeXDict begin /N{def}def /B{bind def}N /S{exch}N
/X{S N}B /TR{translate}N /isls false N /vsize 11 72 mul N /hsize 8.5 72
mul N /landplus90{false}def /@rigin{isls{[0 landplus90{1 -1}{-1 1}
ifelse 0 0 0]concat}if 72 Resolution div 72 VResolution div neg scale
isls{landplus90{VResolution 72 div vsize mul 0 exch}{Resolution -72 div
hsize mul 0}ifelse TR}if Resolution VResolution vsize -72 div 1 add mul
TR[matrix currentmatrix{dup dup round sub abs 0.00001 lt{round}if}
forall round exch round exch]setmatrix}N /@landscape{/isls true N}B
/@manualfeed{statusdict /manualfeed true put}B /@copies{/#copies X}B
/FMat[1 0 0 -1 0 0]N /FBB[0 0 0 0]N /nn 0 N /IE 0 N /ctr 0 N /df-tail{
/nn 8 dict N nn begin /FontType 3 N /FontMatrix fntrx N /FontBBox FBB N
string /base X array /BitMaps X /BuildChar{CharBuilder}N /Encoding IE N
end dup{/foo setfont}2 array copy cvx N load 0 nn put /ctr 0 N[}B /df{
/sf 1 N /fntrx FMat N df-tail}B /dfs{div /sf X /fntrx[sf 0 0 sf neg 0 0]
N df-tail}B /E{pop nn dup definefont setfont}B /ch-width{ch-data dup
length 5 sub get}B /ch-height{ch-data dup length 4 sub get}B /ch-xoff{
128 ch-data dup length 3 sub get sub}B /ch-yoff{ch-data dup length 2 sub
get 127 sub}B /ch-dx{ch-data dup length 1 sub get}B /ch-image{ch-data
dup type /stringtype ne{ctr get /ctr ctr 1 add N}if}B /id 0 N /rw 0 N
/rc 0 N /gp 0 N /cp 0 N /G 0 N /sf 0 N /CharBuilder{save 3 1 roll S dup
/base get 2 index get S /BitMaps get S get /ch-data X pop /ctr 0 N ch-dx
0 ch-xoff ch-yoff ch-height sub ch-xoff ch-width add ch-yoff
setcachedevice ch-width ch-height true[1 0 0 -1 -.1 ch-xoff sub ch-yoff
.1 sub]/id ch-image N /rw ch-width 7 add 8 idiv string N /rc 0 N /gp 0 N
/cp 0 N{rc 0 ne{rc 1 sub /rc X rw}{G}ifelse}imagemask restore}B /G{{id
gp get /gp gp 1 add N dup 18 mod S 18 idiv pl S get exec}loop}B /adv{cp
add /cp X}B /chg{rw cp id gp 4 index getinterval putinterval dup gp add
/gp X adv}B /nd{/cp 0 N rw exit}B /lsh{rw cp 2 copy get dup 0 eq{pop 1}{
dup 255 eq{pop 254}{dup dup add 255 and S 1 and or}ifelse}ifelse put 1
adv}B /rsh{rw cp 2 copy get dup 0 eq{pop 128}{dup 255 eq{pop 127}{dup 2
idiv S 128 and or}ifelse}ifelse put 1 adv}B /clr{rw cp 2 index string
putinterval adv}B /set{rw cp fillstr 0 4 index getinterval putinterval
adv}B /fillstr 18 string 0 1 17{2 copy 255 put pop}for N /pl[{adv 1 chg}
{adv 1 chg nd}{1 add chg}{1 add chg nd}{adv lsh}{adv lsh nd}{adv rsh}{
adv rsh nd}{1 add adv}{/rc X nd}{1 add set}{1 add clr}{adv 2 chg}{adv 2
chg nd}{pop nd}]dup{bind pop}forall N /D{/cc X dup type /stringtype ne{]
}if nn /base get cc ctr put nn /BitMaps get S ctr S sf 1 ne{dup dup
length 1 sub dup 2 index S get sf div put}if put /ctr ctr 1 add N}B /I{
cc 1 add D}B /bop{userdict /bop-hook known{bop-hook}if /SI save N @rigin
0 0 moveto /V matrix currentmatrix dup 1 get dup mul exch 0 get dup mul
add .99 lt{/QV}{/RV}ifelse load def pop pop}N /eop{SI restore userdict
/eop-hook known{eop-hook}if showpage}N /@start{userdict /start-hook
known{start-hook}if pop /VResolution X /Resolution X 1000 div /DVImag X
/IE 256 array N 0 1 255{IE S 1 string dup 0 3 index put cvn put}for
65781.76 div /vsize X 65781.76 div /hsize X}N /p{show}N /RMat[1 0 0 -1 0
0]N /BDot 260 string N /rulex 0 N /ruley 0 N /v{/ruley X /rulex X V}B /V
{}B /RV statusdict begin /product where{pop product dup length 7 ge{0 7
getinterval dup(Display)eq exch 0 4 getinterval(NeXT)eq or}{pop false}
ifelse}{false}ifelse end{{gsave TR -.1 .1 TR 1 1 scale rulex ruley false
RMat{BDot}imagemask grestore}}{{gsave TR -.1 .1 TR rulex ruley scale 1 1
false RMat{BDot}imagemask grestore}}ifelse B /QV{gsave newpath transform
round exch round exch itransform moveto rulex 0 rlineto 0 ruley neg
rlineto rulex neg 0 rlineto fill grestore}B /a{moveto}B /delta 0 N /tail
{dup /delta X 0 rmoveto}B /M{S p delta add tail}B /b{S p tail}B /c{-4 M}
B /d{-3 M}B /e{-2 M}B /f{-1 M}B /g{0 M}B /h{1 M}B /i{2 M}B /j{3 M}B /k{
4 M}B /w{0 rmoveto}B /l{p -4 w}B /m{p -3 w}B /n{p -2 w}B /o{p -1 w}B /q{
p 1 w}B /r{p 2 w}B /s{p 3 w}B /t{p 4 w}B /x{0 S rmoveto}B /y{3 2 roll p
a}B /bos{/SS save N}B /eos{SS restore}B end
%%EndProcSet
TeXDict begin 40258431 52099146 1000 300 300 (kernels.dvi)
@start /Fa 2 20 df<1430146014C0EB0180EB03005B130E130C5B1338133013705B5B
12015B1203A290C7FC5A1206120EA2120C121CA312181238A45AA75AB3A31270A77EA412
18121CA3120C120EA2120612077E7FA212017F12007F13701330133813187F130E7F7FEB
0180EB00C014601430146377811F>18 D<12C012607E7E7E120E7E7E6C7E7F12007F1370
133013381318131CA2130C130E13061307A27F1480A3130114C0A4EB00E0A71470B3A314
E0A7EB01C0A414801303A314005BA21306130E130C131CA213181338133013705B5B1201
5B48C7FC5A120E120C5A5A5A5A14637F811F>I E /Fb 13 122 df<1338137FEB878038
01030090C7FC7FA27F12007FA2137013F8EA03B8EA063CEA0C1C121812381270A212E0A4
13181338EA6030EA70606C5AEA0F80111E7F9D12>14 D<EA3C1F384E6180384681C0EA47
01128F128E120EA2381C0380A438380700A4EA700E12301200A25BA45BA21330121B7E91
15>17 D<007E1360000E13E0A3381C01C0A2EB03801400485A130E130C5B485A5BEA71C0
0073C7FC12FC12F013127E9115>23 D<133E13C3380100C0120200031360EA0780147038
030030C7FCA3EBFC70EA0382EA0601120C381800F0003813E012301270EB01C012E0A214
80130314001306A2EA600C6C5AEA1860EA0F80141F7E9D16>64 D<3A01FFC3FF803A003C
00780001381370A4495BA449485AA390B5FC3901C00380A4484848C7FCA43807000EA448
131E39FFE1FFC0211C7E9B23>72 D<001FB512F0391C0380703930070030002014201260
1240130E1280A2000014005BA45BA45BA45BA41201EA7FFF1C1C7F9B18>84
D<EB01E0EB0630EB0E7814F0EB1C601400A45BA23803FFC038003800A25BA55BA5485AA5
5B1203A20063C7FC12F312F612E4127815257E9C14>102 D<EB38C013C5EA0183EA0303
000713801206120EA2381C0700A4130EA3EA0C1EEA047CEA039CEA001CA25B1260EAF030
1370EAE0C0007FC7FC121A809114>I<13C01201A3EA0380A4EAFFF0EA0700A3120EA45A
A4EA3820A21340A2EA1880EA0F000C1A80990F>116 D<001C13C0EA27011247A2388703
80A2120EA2381C0700A438180E20A3EA1C1E380C26403807C38013127E9118>I<EA1C03
EA270712471303EA8701A2120EA2EA1C02A3130412181308A2EA1C10EA0C20EA07C01012
7E9114>I<380787803808C8403810F0C03820F1E0EBE3C03840E1803800E000A2485AA4
3863808012F3EB810012E5EA84C6EA787813127E9118>120 D<001C13C0EA27011247A2
38870380A2120EA2381C0700A4EA180EA3EA1C1EEA0C3CEA07DCEA001C1318EA6038EAF0
305B485AEA4180003EC7FC121A7E9114>I E /Fc 8 112 df<EA0F80EA3FC0EA70E0EAE0
701338A2124012001330137013E013C0EA0180EA030012065AEA18381230EA7FF8A20D14
7E9312>50 D<EAFFC0EA7FF0EA38781338131CA2131E130EA7131CA213381378EA7FF0EA
FFC00F147F9312>68 D<EA1FC0EA3FF0EA3838EA101C1200EA07FC123FEA781C12E0A3EA
703C383FFF80EA1FCF110E7F8D12>97 D<13F8A21338A4EA07B8EA1FF8EA3878EA703812
6012E0A41260EA70781238EA1FFEEA0FBE0F147F9312>100 D<1206120FA21206C7FCA3
127FA21207AAEAFFF0A20C157D9412>105 D<EAF71CEAFFBEEA79E7A2EA71C7A838F9E7
80EAF8E3110E808D12>109 D<EAF9E0EAFFF0EA3E38123C1238A8EAFE3EA20F0E7F8D12>
I<EA0F80EA3FE01238EA7070EAE038A5EAF078EA7070EA38E0123FEA0F800D0E7E8D12>
I E /Fd 11 122 df<EA01801203EA06005A121C121812385AA35AA91270A37E1218121C
120C7EEA03801201091D799914>40 D<128012C01260123012381218121C120EA31207A9
120EA3121C121812381230126012C01280081D7C9914>I<127012F812FCA2127C120C12
18123012E012C0060A798414>44 D<1203A25A5A123F12F712471207AEEA7FF0A20C177C
9614>49 D<EA07E0EA0FF0EA1C38EA301CEA700CEAE00EA2EAFFFEA2EAE00012601270EA
380EEA1C1EEA0FFCEA03F00F107E8F14>101 D<1206120FA21206C7FCA4B4FCA21207AC
EAFFF8A20D187C9714>105 D<136013F0A213601300A4EA1FF0A2EA0070B2EA40E0EAE0
C0EA7F80EA3F000C207E9714>I<EAFC78EAFDFEEA1F86EA1E07121CAA38FF8FE0A21310
808F14>110 D<EA0FD8EA3FF8EA603812C0A2EAF000EA7F80EA3FF0EA07F8EA001CEA60
0612E012F0EAF81CEAFFF8EACFE00F107E8F14>115 D<EA7E3FA2EA1E3CEA0E78EA0770
5B12036C5A12037FEA0770EA0E781338487E38FE3F80A211107F8F14>120
D<38FE3F80A2381C0E005BA2120E5BA212071330A2EA0370A25B1201A25BA3485A127300
77C7FC127E123C11187F8F14>I E /Fe 59 123 df<126012F0AF12601200A4126012F0
A212600419779816>33 D<13C01201A3EA07F0EA1FFC487EEA7DCF3871C780EAE1C313C7
A238F1C300EA79C0123FEA1FF0EA07FCEA01FE13CF13C73861C38012F1A212E13871C700
EA79DFEA3FFEEA1FF8EA07E0EA01C0A2120011207E9C16>36 D<38380180EA7C03A238EE
0700A2130EA35B127C5B1238C65AA35BA2485AA3485AEB8380380707C0A2380E0EE0A312
1CA2383807C0A23818038013207F9C16>I<13E01201EA0380EA0700120E5AA25AA25AA3
5AA91270A37EA27EA27E7EEA0380EA01E012000B217A9C16>40 D<12C07E12707E7E7EA2
7EA2EA0380A3EA01C0A9EA0380A3EA0700A2120EA25A5A5A5A5A0A217B9C16>I<EA0380
A4EAE38EEAF39EEAFFFEEA3FF8EA0FE0A2EA3FF8EAFFFEEAF39EEAE38EEA0380A40F127D
9516>I<13E0A8B512E0A33800E000A813137F9516>I<1238127C127EA2123E120E121E12
1C127812F01260070B798416>I<B51280A311037E8D16>I<127012F8A312700505788416
>I<EB01801303A2EB0700A2130EA25BA25BA25BA25BA2485AA2485AA248C7FCA2120EA2
5AA25AA25AA25AA25A11207E9C16>I<EA03E0EA0FF8487EEA1E3CEA380EEA780FEA7007
A238E00380A8EAF00700701300A2EA780FEA3C1E6C5AEA1FFC6C5AEA03E011197E9816>
I<12035AA25A5AB4FCA212E71207AEEAFFF8A30D197B9816>I<EA07E0EA1FF8487EEA78
3EEAE00700F01380130312601200A2EB0700A2130E5B5B5B5B485A485A000FC7FC381E03
801238EA7FFFB5FC7E11197E9816>I<127012F8A312701200A8127012F8A31270051278
9116>58 D<1238127CA312381200A812381278127CA2123C121CA21238127012F0124006
18799116>I<387FFFC0B512E0A2C8FCA5B512E0A26C13C0130B7F9116>61
D<12C012F012FC123EEA0F806C7EEA01F06C7E133EEB1F801307131FEB3E0013F8485AEA
07C0485A003EC7FC12FC12F012C011157E9616>I<13E0487EA213B0A2EA03B8A31318EA
071CA5EA0E0EA2EA0FFEA2487EEA1C07A3387E0FC038FF1FE0387E0FC013197F9816>65
D<EA7FF8EAFFFE6C7EEA1C0FEB0780EB03C01301A214E01300A8EB01C0A21303EB078013
0F387FFF00485AEA7FF81319809816>68 D<387FFFC0B5FC7EEA1C01A490C7FCA2131CA2
EA1FFCA3EA1C1CA290C7FC14E0A5EA7FFFB5FC7E13197F9816>I<387F07F038FF8FF838
7F07F0381C01C0A7EA1FFFA3EA1C01A9387F07F038FF8FF8387F07F01519809816>72
D<EA7FFCEAFFFEEA7FFCEA0380B3EA7FFCEAFFFEEA7FFC0F197D9816>I<B47E7F5B001C
C7FCAE144014E0A4B5FCA313197F9816>76 D<38FC07E0EAFE0FA2383A0B80EA3B1BA513
BBEA39B3A413F3EA38E3A21303A538FE0FE0A313197F9816>I<387E07F038FF0FF8387F
07F0381D81C0A313C1121C13E1A213611371A313311339A21319131D130DA3EA7F07EAFF
87EA7F031519809816>I<EA1FFC487E487EEA780F38F00780EAE003AEEAF007A238780F
00EA7FFF6C5A6C5A11197E9816>I<EA7FF8EAFFFE6C7E381C0F80130314C01301A31303
1480130F381FFF005B13F8001CC7FCA7127F487E6CC7FC12197F9816>I<EA7FF0EAFFFC
6C7EEA1C0FEB07801303A41307EB0F00EA1FFE5B7FEA1C0E7FA414101438A2387F03F0EA
FF83387F01E01519809816>82 D<EA07E3EA1FFF5AEA781FEAF00712E0A290C7FC7E1278
EA3F80EA1FF0EA07FCC67E130F7FEB0380A2126012E0EB0700EAF80FEAFFFE5BEAC7F011
197E9816>I<387FFFE0B5FCA2EAE0E0A400001300AFEA07FC487E6C5A13197F9816>I<38
FE0FE0A338380380EA3C07001C1300A3EA1E0FEA0E0EA46C5AA4EA031813B8A3EA01B013
F0A26C5A13197F9816>86 D<387E03F038FF07F8387E03F0383800E0A4381C01C0A31371
13F9A213D9A2000C1380A3EA0DDD138DA338078F00A213071519809816>I<B51280A311
037E7E16>95 D<EA1FE0487E487EEA783CEA300E1200A2EA03FE121FEA3E0E127012E0A3
EA783E387FFFE0EA3FE7EA0F8313127E9116>97 D<12FCA3121CA4137CEA1DFEEA1FFFEB
0780381E03C0EA1C01EB00E0A6EB01C0EA1E03381F0780EBFF00EA1DFEEA0C7813197F98
16>I<EA03F8EA0FFCEA1FFEEA3C1EEA780CEA70005AA57EEA70071278EA3E0EEA1FFCEA
0FF8EA03F010127D9116>I<133FA31307A4EA03C7EA0FF748B4FCEA3C1F487EEA700712
E0A6EA700F12786C5A381FFFE0EA0FF7EA07C713197F9816>I<EA03F0EA0FFC487EEA3C
0F487E3870038012E0B5FCA300E0C7FCA2387003801278EA3E07381FFF00EA07FEEA01F8
11127E9116>I<131E137F3801FF8013C7380383001380A2EA7FFFB5FCA2EA0380ACEA7F
FC487E6C5A11197F9816>I<3803E3C03807F7E0EA0FFF381C1CC038380E00A56C5AEA0F
F8485AEA1BE00038C7FC1218EA1FFC13FF481380387003C038E000E0A4387001C0EA7C07
383FFF80380FFE00EA03F8131C7F9116>I<12FCA3121CA41378EA1DFCEA1FFE130FEA1E
07121CAA38FF8FE0139F138F13197F9816>I<1203EA0780A2EA0300C7FCA4EAFF80A312
03ACEAFFFC13FE13FC0F1A7C9916>I<13301378A213301300A4EA0FF8121F120FEA0038
B3EA6070EAF0F0EAFFE0EA7FC0EA3F800D237E9916>I<127E12FE127E120EA4EB7FE0A3
EB0F00131E5B5B5B120F7F13BC131EEA0E0E7F1480387F87F0EAFFCFEA7F871419809816
>I<EA7FC012FF127F1201B3EA7FFFB512806C130011197E9816>I<38F9C38038FFEFC0EB
FFE0EA3C78A2EA3870AA38FE7CF8A31512809116>I<EAFC78EAFDFCB47EEA1F0FEA1E07
121CAA38FF8FE0139F138F13127F9116>I<EA03E0EA0FF8487EEA3C1E487EEA700738E0
0380A5EAF00700701300EA780FEA3C1EEA1FFC6C5AEA03E011127E9116>I<EAFC7CEAFD
FEB5FC381F0780381E03C0EA1C01EB00E0A6EB01C0EA1E03381F0780EBFF00EA1DFEEA1C
7890C7FCA6B47EA3131B7F9116>I<387F0FC038FF3FE0EA7F7F3807F040EBC0005BA290
C7FCA8EA7FFC12FF127F13127F9116>114 D<EA0FECEA3FFC127FEAF03CEAE01CA2EA70
00EA7F80EA1FF0EA07F8EA003CEA600E12E012F0EAF81EEAFFFC13F8EAC7E00F127D9116
>I<12035AA4EA7FFFB5FCA20007C7FCA75BEB0380A3EB8700EA03FE6C5A6C5A11177F96
16>I<EAFC3FA3EA1C07AB131F381FFFE0EA0FF7EA07C713127F9116>I<387F1FC038FF9F
E0387F1FC0381C0700A2EA0E0EA36C5AA4EA03B8A3EA01F0A26C5A13127F9116>I<38FF
1FE0A338380380A4EA39F3A20019130013B3A3EA1DB71317EA1F1FEA0F1EEA0E0E13127F
9116>I<387F1FC0133F131F380F1E006C5AEA03B813F012016C5A12017FEA03B8EA073C
131CEA0E0E387F1FC038FF3FE0387F1FC013127F9116>I<387F1FC038FF9FE0387F1FC0
381C0700120E130EA212075BA2EA039CA21398EA01B8A2EA00F0A35BA3485A1279127BEA
7F8090C7FC123C131B7F9116>I<383FFFC05AA238700780EB0F00131EC65A5B485A485A
EA078048C7FC381E01C0123C1278B5FCA312127F9116>I E /Ff
8 122 df<EA0390EA0C701218EA303013601260A3EAC0C013C812401241EA62D0EA1C70
0D0E7C8D12>97 D<127C1218A45AA4EA6780EA68C0EA7040EA606012C0A4EA80C0A2EA81
80EAC1001246123C0B177C9610>I<EA07C0EA0C60EA30E01220EA60005AA35AA2EAC020
1340EA6180EA3E000B0E7C8D10>I<1203120712061200A61218122C124CA2128C1218A3
12301232126212641224123808177D960B>105 D<123E120CA41218A41230A41260A412
C012C8A312D0126007177D9609>108 D<EA30F0EA4B18EA4E38EA4C30EA98001218A35A
A45AA20D0E7D8D0F>114 D<EA0780EA0C40EA18E0A2EA3800121EEA1F80EA07C0120012
6012E0EAC180EAC300123E0B0E7D8D0F>I<EA3804EA2C0C124CA2EA8C181218A3EA3030
A31370EA18E0EA0F60120013C012E0EAE180EA4300123C0E147D8D11>121
D E /Fg 9 106 df<EA0720EA18E0EA30601260A2EAC0C0A213C81241EA62D0EA3C600D
0B7E8A11>97 D<12781218A25AA31237EA78C0EA60401360A2EAC0C0A3EA4180EA630012
3C0B117E900E>I<EA0780EA1840EA30C0EA6000A25AA3EA4020EA60C0EA1F000B0B7E8A
0E>I<13781318A21330A31207EA18E0EA30601260A2EAC0C0A213C81241EA62D0EA3C60
0D117E9010>I<EA0780EA184012301260EA7F80EAC000A3EA4020EA20C0EA1F000B0B7E
8A0F>I<13E0EA01B013A0EA0300A3EA1FE0EA03001206A65AA41208125812D012600C16
7D900F>I<EA0390EA0C70EA18301230A2EA6060A3EA20E0EA31C0121E1200A2EA4180EA
C300127E0C107E8A0F>I<123C120CA25AA3EA1BE0EA343012381230A2EA6060A2136413
C4EAC0C813700E117E9012>I<1204120C1200A5123012581298A21230A212601264A212
68123006127E910B>I E /Fh 13 122 df<EA07B0EA0C701210EA30601260A3EAC0C013
C8A21241EA62D0EA3C700D0D7E8C12>97 D<123C120C5AA45AEA3380EA3C60EA3020EA60
30A4EAC060A2EA40C0EA6080EA2300121E0C147F930F>I<EA03C0EA0C20EA1870EA30E0
EA6000A35AA2EA4010EA6020EA30C0EA1F000C0D7F8C0F>I<133C130C1318A41330EA07
B0EA0C701210EA30601260A3EAC0C013C8A21241EA62D0EA3C700E147E9311>I<EA0780
EA1840EA3020EA604012C0EAFF80EAC0005AA2EAC0201340EA6180EA3E000B0D7E8C10>
I<1318136C137C136C13C0A3EA07F8EA00C0EA0180A5EA0300A512021206A2126612E45A
12700E1A7F9310>I<EA01CCEA062CEA0C1CEA18181230A3EA6030A21220EA3070EA10E0
EA0F601200A2EA60C012E0EAC380EA7E000E137F8C10>I<121E12065AA45AEA19E0EA1E
30121812381230A3EA6060136413C413C812C013700E147E9313>I<1206120712061200
A41238124CA2128C12981218A212301232A21264A2123808147F930C>I<133013381330
1300A4EA01C0EA0260EA0430136012081200A213C0A4EA0180A4EA630012E312C612780D
1A81930E>I<EA30F8EA590C124E129C12981218A2EA301813191331A2EA6032131C100D
7F8C15>110 D<EA0E3CEA13CEEA238EEA430C13001203A21206130812C6EAE610EACA20
EA71C00F0D7F8C13>120 D<EA380C124CA2EA8C1812981218A2EA3030A31370EA18E0EA
0F60120013C012E0EAE180EA4300123C0E137F8C11>I E /Fi 8
56 df<1360AAB512F0A238006000AA14167E9119>43 D<120C121C12EC120CAFEAFFC00A
137D9211>49 D<121FEA60C01360EAF07013301260EA0070A2136013C012011380EA0200
5AEA08101210EA2020EA7FE012FF0C137E9211>I<EA0FC0EA3070EA7038A31200133013
E0EA0FC0EA007013381318131C126012F01318EAE038EA6070EA1FC00E137F9211>I<13
6013E0A2EA016012021206120C120812101220126012C0EAFFFCEA0060A5EA03FC0E137F
9211>I<EA6060EA7FC01380EA44001240A3124FEA70C0EA40E0EA00601370A212E0A213
60EA40E0EA21C0EA1F000C137E9211>I<EA07C0EA0C20EA10701220EA6000A25A12CFEA
D0C0EAE060EAC0201330A31240EA6020EA2060EA10C0EA0F000C137E9211>I<1240EA7F
FC13F8EA4010EA80301320EA00401380EA0100A25A12021206A2120EA512040E147E9311
>I E /Fj 53 122 df<903801F03C9038071C47010C13C7EC19C690381C018014031318
1338A2EC0700A20003B512F03900700700A3140EA213E0A35CA2EA01C0A35CA2EA0380A2
1430EB0070A248136038C630E038E638C038CC3180D8781EC7FC2025819C19>11
D<14FE90380301801306EB0C03EB1C0191C7FC13181338A43803FFFE3800700EA35CA213
E0A25CA3EA01C01472A438038034141891C7FC90C8FCA25A12C612E65A12781925819C17
>I<903801FEE0EB0707130E010C13C0EB1C01A213189038380380A40003B51200380070
07A3140EA213E0A25CA3EA01C01439A43803801A140C91C7FC90C8FCA25A12C612E65A12
781B25819C18>I<12181238127812381208A21210A212201240A21280050C7D830D>44
D<EAFFC0A30A037D890F>I<1230127812F0126005047C830D>I<14021406A2140CA21418
1430A21460A214C0A2EB0180A2EB03001306A25BA25BA25BA25B5BA2485AA248C7FCA212
065AA25AA25AA25AA25A5A17297F9E15>I<133EEBE180380181C0EA03005A1206000E13
E0120C001C13C0A2EA18011238A338700380A43860070012E01306130EA2130C5BEA6038
5BEA30C0001FC7FC131D7C9B15>I<1304130C131813381378EA07B8EA0070A413E0A4EA
01C0A4EA0380A4EA0700A45AEAFFF00E1C7B9B15>I<133EEB4180EB80C0EA0100000213
E0EA0440A21208A3381081C0A238110380000E1300EA00065B5B136013800003C7FC1204
4813404813805AEB0100EA7F07EA43FEEA81FCEA8078131D7D9B15>I<EB018014C0EB03
80A314005BA21306130E130C131C1318A25BA25B134013C6EA018E130E1202EA061C120C
1218123FEA40F838803F8038003800A25BA45B136012247E9B15>52
D<EB80603801FFC01480EBFE0090C7FC1202A45A13F8EA050CEA0606120C120812001307
1306130EA21270130CEAE01CEA80181338EA40305BEA21C0001FC7FC131D7C9B15>I<38
09C040380FE080EA1FE1381C6100EA3026EA201AEA6004EA400CEA80081318485AA25BA2
5BA212015B120390C7FC5AA3120EA35AA21218121D799B15>55 D<133E13E13801818038
0300C01206120E120C121CA213011238A31303001813801307EA080B380C3300EA03C7EA
0007130E130C131C1318EAE0305BEA80C0EAC180003EC7FC121D7C9B15>57
D<1206120FA212061200AA1230127812F0126008127C910D>I<1418A21438A21478A214
B8EB0138A2EB023C141C1304130C13081310A21320A2EB7FFCEBC01C1380EA0100141E00
02130EA25A120C001C131EB4EBFFC01A1D7E9C1F>65 D<903803F02090381E0C60903830
02E09038E003C03801C001EA038048C7FC000E1480121E121C123C15005AA35AA41404A3
5C12705C6C5B00185B6C485AD80706C7FCEA01F81B1E7A9C1E>67
D<48B5FC39003C03C090383800E0A21570A24913781538A215785BA4484813F0A315E038
03800115C0140315803907000700140E5C5C000E13E0B512801D1C7E9B1F>I<48B512F0
38003C00013813301520A35BA214081500495AA21430EBFFF03801C020A4390380408014
00A2EC0100EA07005C14021406000E133CB512FC1C1C7E9B1C>I<48B512F038003C0001
3813301520A35BA214081500495AA21430EBFFF03801C020A448485A91C7FCA348C8FCA4
5AEAFFF01C1C7E9B1B>I<3A01FFC3FF803A003C00780001381370A4495BA449485AA390
B5FC3901C00380A4484848C7FCA43807000EA448131E39FFE1FFC0211C7E9B1F>72
D<EA03FFEA00781370A413E0A4EA01C0A4EA0380A4EA0700A4120EA4121EEAFFC0101C7D
9B10>I<EB3FF8EB03C01480A4EB0700A4130EA45BA45BA4EA607012E0EAC060EA80E0EA
81C0EA4380003EC7FC151D7C9B16>I<D801FEEB01FED8003E14E0012EEB03C01505A215
09014EEB0B801513152313470187EB4700A21587EC0107D80107130E14021404A2000249
5AEB0388149014A000045C14C0A2000C1380001CEB007839FF8307FF271C7E9B25>77
D<D801FCEBFF80D8001CEB1C00012E13181510A2132701475B13431480A2903881C040A3
EB80E0D801005B1470A300020139C7FCA3141D48131E140EA2120C001C1304EAFF80211C
7E9B1F>I<3801FFFE39003C038090383801C0EC00E0A3EB7001A315C0EBE0031580EC07
00141C3801FFF001C0C7FCA3485AA448C8FCA45AEAFFE01B1C7E9B1C>80
D<EB07F0EB1C1CEB700E497ED801C0138038038003EA0700000E14C0121E121C123CA25A
A348EB0780A3EC0F00A2140E141E141C38707838EB8070387104E0383905C0381D078038
0F0E04EA03FC3800040CEB0608EB0E18EB0FF013075CEB03801A257A9C20>I<3801FFFE
39003C078090383801C015E01400A2EB7001A3EC03C001E01380EC0700141CEBFFE03801
C03080141CA2EA0380A43807003C1520A348144039FFE01E80C7EA0F001B1D7E9B1E>I<
EB0F84EB304CEB403CEB8018EA01005AA200061310A214001207A2EA03E013FC6CB4FC38
007F80EB07C01301A21300A21220A238600180A2EB03001302EAF004EACC18EA83E0161E
7D9C17>I<3AFF83FF07F03A3C007001C00038158002F01300A290380170025D13025D13
045D13085D131001305B1320D81C405BA2D98071C7FCA2381D0072A2001E1374A2001C13
38A20018133014201210241D779B29>87 D<EA01E3EA0717EA0C0F1218EA380E12301270
A2EAE01CA41339A3EA6079EA319AEA1E0C10127C9115>97 D<123F1207A2120EA45AA4EA
39E0EA3A18EA3C0C12381270130EA3EAE01CA31318133813301360EA60C0EA3180EA1E00
0F1D7C9C13>I<13F8EA0304120EEA1C0EEA181CEA30001270A25AA51304EA60081310EA
3060EA0F800F127C9113>I<EB07E01300A2EB01C0A4EB0380A43801E700EA0717EA0C0F
1218EA380E12301270A2485AA41339A3EA6079EA319AEA1E0C131D7C9C15>I<13F8EA07
04120CEA1802EA38041230EA7008EA7FF0EAE000A5EA60041308EA30101360EA0F800F12
7C9113>I<EB03C0EB0670130CEB1C601400A25BA53803FF8038007000A55BA5485AA548
5AA390C7FCA25A12C612E65A12781425819C0D>I<EB78C0EA01C5EA03031206000E1380
120C121CA238380700A4130EA3EA181EEA0C7CEA079CEA001CA25BA2EAC030EAE070EAC1
C0007FC7FC121A7E9113>I<EA0FC01201A2485AA448C7FCA4EA0E3E13C3380F0380120E
121E121CA338380700A3130E00701340A2131C1480EAE00C38600700121D7E9C15>I<EA
01801203EA0100C7FCA7121C12261247A2128EA2120E5AA35AA21271A31272A2123C091C
7C9B0D>I<EA0FC01201A2485AA448C7FCA4380E07801308EB11C01321381C4180EB8000
001DC7FC121EEA3FC0EA38E01370A2EA7071A31372EAE032EA601C121D7E9C13>107
D<EA1F801203A2EA0700A4120EA45AA45AA45AA412E2A312E412641238091D7D9C0B>I<
391C1E078039266318C0394683A0E0384703C0008E1380A2120EA2391C0701C0A3EC0380
D8380E1388A2EC0708151039701C032039300C01C01D127C9122>I<EA383EEA4CC3384D
0380124E129E129C121CA238380700A3130E00701340A2131C1480EAE00C386007001212
7C9117>I<13F8EA030CEA0E06487E1218123000701380A238E00700A3130EA25BEA6018
5BEA30E0EA0F8011127C9115>I<380387803804C860EBD03013E0EA09C014381201A238
038070A31460380700E014C0EB0180EB8300EA0E86137890C7FCA25AA45AB4FC151A8091
15>I<EA1C3CEA2642EA4687EA4707EA8E061300120EA25AA45AA45A123010127C9112>
114 D<EA01F0EA0608120C131CEA1818EA1C00121F13C0EA0FF01207EA00781338EA6030
12E012C0EA8060EA60C0EA1F000E127D9111>I<12035AA3120EA4EAFFE0EA1C00A35AA4
5AA4EAE080A2EAE100A2126612380B1A7C990E>I<381C0180EA2E03124EA2388E0700A2
121CA2EA380EA438301C80A3EA383C38184D00EA0F8611127C9116>I<EA1C06EA2E0EEA
4E06A2EA8E02A2121CA2EA3804A313081230A21310EA3820EA1840EA0F800F127C9113>
I<381E0183382703871247148338870701A2120EA2381C0E02A31404EA180C131C1408EA
1C1E380C26303807C3C018127C911C>I<38038780380CC840380870E012103820E0C014
001200A2485AA4EA03811263EAE38212C5EA8584EA787813127E9113>I<381C0180EA2E
03124EA2388E0700A2121CA2EA380EA4EA301CA3EA383CEA1878EA0FB8EA003813301370
EAE0605BEA81800043C7FC123C111A7C9114>I E /Fk 7 115 df<B61280A219027D8A20
>0 D<126012F0A2126004047C8B0C>I<0040132000C01360006013C03830018038180300
EA0C066C5A6C5AEA01B0EA00E0A2EA01B0EA0318EA060C487E487E38300180386000C048
13600040132013147A9320>I<EA03C0EA0FF0EA1FF8EA3FFCEA7FFEA2B5FCA4EA7FFEA2
EA3FFCEA1FF8EA0FF0EA03C010107E9115>15 D<02031318020F1378021C13E091387003
80903901E00F00903803801C90380E007090383C01E090387003802601C00EC7FC380780
3C380E0070383801C038F00780A2383801C0380E00703807803C3801C00E390070038090
383C01E090380E0070903803801C903801E00F90390070038091381C00E0020F13780203
1318251C7E972A>28 D<90380C1F809038107FE090382087F0EBC38138018700D8030613
F8EA060ED80E1C1378121C5BEA382090C7FC127800701470A200F014F015E0A2140115C0
15806C1303EC070000781306007C5B007E13106C5B381FC1C06CB4C7FCEA03F81D1E7E9C
21>79 D<B612FCA26C14F80078C7121800381410003C1430001C14206C1440A26C1480A2
3903800100A23801C002A26C6C5AA2EB7008A26D5AA26D5A131EEB0E40130F6D5AA26DC7
FCA21E1D7E9B23>114 D E /Fl 79 124 df<1303A2497EA2497E130BEB13E01311EB21
F01320497E1478EB807C143C3801003E141E0002131F8048148014074814C0140348EB01
E0003014F000201300006014F8007FB5FCB612FCA21E1D7E9C23>1
D<EB7E1F3901C1B180390303E3C0000713C3000EEBC180903801C000A6B512FC380E01C0
B0387F87FC1A1D809C18>11 D<137E3801C180EA0301380703C0120EEB018090C7FCA5B5
12C0EA0E01B0387F87F8151D809C17>I<EB7FC0EA01C1EA03031207EA0E01A7B5FCEA0E
01B0387FCFF8151D809C17>I<90383F07E03901C09C18380380F0D80701133C000E13E0
0100131892C7FCA5B612FC390E00E01CB03A7FC7FCFF80211D809C23>I<EA6060EAF0F0
EAF8F8EA6868EA0808A3EA1010A2EA2020EA4040EA80800D0C7F9C15>34
D<000F14C0EA188039306003803970380700386027FB38E010065CA25CA25C5CEA602000
705B38304180EA1881390F0303C03900060620EC0C1090380C1C08EB1818EC3804133013
60A213C0A2EA01803903001808141C0006EB0C1048EB06200004EB03C01E217E9E23>37
D<126012F012F812681208A31210A2122012401280050C7C9C0C>39
D<1380EA0100120212065AA25AA25AA35AA412E0AC1260A47EA37EA27EA27E12027EEA00
80092A7C9E10>I<7E12407E12307EA27EA27EA37EA41380AC1300A41206A35AA25AA25A
12205A5A092A7E9E10>I<1306ADB612E0A2D80006C7FCAD1B1C7E9720>43
D<126012F0A212701210A41220A212401280040C7C830C>I<EAFFE0A20B0280890E>I<12
6012F0A2126004047C830C>I<130113031306A3130CA31318A31330A31360A213C0A3EA
0180A3EA0300A31206A25AA35AA35AA35AA35AA210297E9E15>I<EA03C0EA0C30EA1818
EA300CA2EA700EEA6006A2EAE007ADEA6006A2EA700EEA300CA2EA1818EA0C30EA07E010
1D7E9B15>I<5A1207123F12C71207B3A5EAFFF80D1C7C9B15>I<EA07C0EA1830EA201CEA
400C130EEAF00F12F81307A21270EA000F130EA2131CA213381370136013C0EA0180EA03
00EA0601120C1218EA1002EA3FFE127F12FF101C7E9B15>I<EA07E0EA1830EA201CA2EA
781E130E131E1238EA001CA2131813301360EA07C0EA0030131CA2130E130FA2127012F8
A3EAF00EEA401C1220EA1830EA07C0101D7E9B15>I<130CA2131C133CA2135C13DC139C
EA011C120312021204120C1208121012301220124012C0B512C038001C00A73801FFC012
1C7F9B15>I<EA300CEA3FF813F013C0EA2000A6EA23E0EA2C30EA3018131CEA200E1200
130FA3126012F0A3EA800EEA401E131CEA2038EA1870EA07C0101D7E9B15>I<13F0EA03
0CEA0404EA0C0EEA181E1230130CEA7000A21260EAE3E0EAE430EAE818EAF00C130EEAE0
061307A51260A2EA7006EA300E130CEA1818EA0C30EA03E0101D7E9B15>I<1240387FFF
801400A2EA4002485AA25B485AA25B1360134013C0A212015BA21203A41207A66CC7FC11
1D7E9B15>I<EA03E0EA0C30EA1008EA200C13061260A21270A2EA7C0CEA3E18EA3FB0EA
1FE0EA07F013F8EA18FCEA307EEA601E130FEAC0071303A4EA60021304EA300CEA1C10EA
07E0101D7E9B15>I<EA03C0EA0C30EA1818EA300C1270EA600EEAE006A21307A51260EA
700F1230EA1817EA0C27EA07C7EA0006A2130EEA300C127813181270EA2030EA10C0EA0F
80101D7E9B15>I<126012F0A212601200AA126012F0A2126004127C910C>I<126012F0A2
12601200AA126012F0A212701210A41220A212401280041A7C910C>I<007FB512C0B612
E0C9FCA8B612E06C14C01B0C7E8F20>61 D<1306A3130FA3EB1780A2EB37C01323A2EB43
E01341A2EB80F0A338010078A2EBFFF83802003CA3487FA2000C131F80001E5BB4EBFFF0
1C1D7F9C1F>65 D<B512C0380F00788080140E140FA4140E141E5C14F8EBFFF0EB003C80
80801580A5EC0F00A2141E1478B512E0191C7F9B1D>I<90381F8080EBE0613801801938
070007000E13035A14015A00781300A2127000F01400A8007014801278A212386CEB0100
A26C13026C5B380180083800E030EB1FC0191E7E9C1E>I<B512C0380F00F0143C140E80
A2EC038015C01401A215E0A815C0A21403158014071500140E5C1470B512C01B1C7E9B20
>I<B512FC380F003C140C1404A214061402A213011400A35B13FF13037FA31401130014
02A31406A2140C143CB512FC181C7E9B1C>I<B512F8380F007814181408A2140C1404A2
13011400A35B13FF13037FA490C7FCA8EAFFF8161C7E9B1B>I<90381F8080EBE0613801
801938070007000E13035A14015A00781300A2127000F01400A6ECFFF0EC0F8000701307
1278A212387EA27E6C130B380180113800E06090381F80001C1E7E9C21>I<39FFF0FFF0
390F000F00AC90B5FCEB000FAD39FFF0FFF01C1C7F9B1F>I<EAFFF0EA0F00B3A8EAFFF0
0C1C7F9B0F>I<3807FF8038007C00133CB3127012F8A21338EA7078EA4070EA30E0EA0F
80111D7F9B15>I<EAFFF8EA0F8090C7FCB01408A31418A2141014301470EB01F0B5FC15
1C7E9B1A>76 D<B46CEBFF80000FECF800A2390BC00178A33809E002A23808F004A3EB78
08A3EB3C10A3EB1E20A3EB0F40A2EB0780A3EB0300121C3AFF8307FF80211C7E9B26>I<
B4EB1FF0390F8003809038C00100120BEA09E0EA08F0A21378133C133E131E130F148113
07EB03C1EB01E114F113001479147D143D141FA2808080121CB46C7E1C1C7F9B1F>I<EB
3F80EBE0E03803803848487E000E7F487F003C148000381303007814C0A20070130100F0
14E0A8007014C000781303A200381480003C1307001C14006C130E6C5B6C6C5A3800E0E0
EB3F801B1E7E9C20>I<B51280380F00E01478143C141C141EA5141C143C147814E0EBFF
8090C7FCACEAFFF0171C7E9B1C>I<B5FC380F01E0EB007880141C141EA4141C143C5CEB
01E001FFC7FCEB01E0EB0070147880A61510A2141CA239FFF00E20C7EA03C01C1D7E9B1F
>82 D<3807E080EA1C19EA30051303EA600112E01300A36C13007E127CEA7FC0EA3FF8EA
1FFEEA07FFC61380130FEB07C0130313011280A300C01380A238E00300EAD002EACC0CEA
83F8121E7E9C17>I<007FB512C038700F010060130000401440A200C014201280A30000
1400B1497E3803FFFC1B1C7F9B1E>I<39FFF01FF0390F000380EC0100B3A26C13021380
00035BEA01C03800E018EB7060EB0F801C1D7F9B1F>I<39FFE00FF0391F0003C0EC0180
6C1400A238078002A213C000035BA2EBE00C00011308A26C6C5AA213F8EB7820A26D5AA3
6D5AA2131F6DC7FCA21306A31C1D7F9B1F>I<3AFFE1FFC0FF3A1F003E003C001E013C13
186C6D1310A32607801F1320A33A03C0278040A33A01E043C080A33A00F081E100A39038
F900F3017913F2A2017E137E013E137CA2013C133C011C1338A20118131801081310281D
7F9B2B>I<39FFF003FC390F8001E00007EB00C06D13800003EB01006D5A000113026C6C
5A13F8EB7808EB7C18EB3C10EB3E20131F6D5A14C06D5AABEB7FF81E1C809B1F>89
D<387FFFF0EA7C01007013E0386003C0A238400780130F1400131E12005B137C13785BA2
485A1203EBC010EA0780A2EA0F00481330001E13205A14604813E0EAF803B5FC141C7E9B
19>I<EA0808EA1010EA2020EA4040A2EA8080A3EAB0B0EAF8F8EA7878EA30300D0C7A9C
15>92 D<EA1FC0EA3070EA78387F12301200A2EA01FCEA0F1C12381270126000E01340A3
EA603C38304E80381F870012127E9115>97 D<12FC121CAA137CEA1D87381E0180381C00
C014E014601470A6146014E014C0381E018038190700EA10FC141D7F9C17>I<EA03F8EA
0C0CEA181E1230EA700CEA600012E0A61260EA70021230EA1804EA0C18EA03E00F127F91
12>I<EB1F801303AAEA03F3EA0E0BEA1807EA30031270126012E0A6126012701230EA18
07EA0E1B3803E3F0141D7F9C17>I<EA07E0EA0C30EA1818EA300CEA700EEA600612E0EA
FFFEEAE000A41260EA70021230EA1804EA0C18EA03E00F127F9112>I<13F8EA018CEA07
1E1206EA0E0C1300A6EAFFE0EA0E00B0EA7FE00F1D809C0D>I<EB03803807C4C0EA1C78
3838388038301800EA701CA4EA3018EA38386C5AEA27C00020C7FCA21230EA3FF86CB4FC
1480EA2003386001C0EAC000A33860018038300300EA1C0EEA07F8121C7F9215>I<12FC
121CAA137C1387EA1D03001E1380121CAD38FF9FF0141D7F9C17>I<1218123CA21218C7
FCA712FC121CB0EAFF80091D7F9C0C>I<13C0EA01E0A2EA00C01300A7EA07E01200B3A2
1260EAF0C012F1EA6180EA3E000B25839C0D>I<12FC121CAAEB0FE0EB0780EB06005B13
105B5B13E0121DEA1E70EA1C781338133C131C7F130F148038FF9FE0131D7F9C16>I<12
FC121CB3A9EAFF80091D7F9C0C>I<39FC7E07E0391C838838391D019018001EEBE01C00
1C13C0AD3AFF8FF8FF8021127F9124>I<EAFC7CEA1C87EA1D03001E1380121CAD38FF9F
F014127F9117>I<EA03F0EA0E1CEA1806487E00701380EA600100E013C0A600601380EA
700300301300EA1806EA0E1CEA03F012127F9115>I<EAFC7CEA1D87381E0180001C13C0
EB00E0A21470A614E0A2EB01C0001E1380381D0700EA1CFC90C7FCA7B47E141A7F9117>
I<3803E080EA0E19EA1805EA3807EA7003A212E0A61270A2EA38071218EA0E1BEA03E3EA
0003A7EB1FF0141A7F9116>I<EAFCE0EA1D38EA1E78A2EA1C301300ACEAFFC00D127F91
10>I<EA1F90EA2070EA4030EAC010A212E0EAF800EA7F80EA3FE0EA0FF0EA00F8EA8038
131812C0A2EAE010EAD060EA8FC00D127F9110>I<1204A4120CA2121C123CEAFFE0EA1C
00A91310A5120CEA0E20EA03C00C1A7F9910>I<38FC1F80EA1C03AD1307120CEA0E1B38
03E3F014127F9117>I<38FF07E0383C0380381C0100A2EA0E02A2EA0F06EA0704A2EA03
88A213C8EA01D0A2EA00E0A3134013127F9116>I<39FF3FC7E0393C0703C0001CEB0180
1500130B000E1382A21311000713C4A213203803A0E8A2EBC06800011370A2EB80300000
13201B127F911E>I<38FF0FE0381E0700EA1C06EA0E046C5AEA039013B0EA01E012007F
12011338EA021C1204EA0C0E487E003C138038FE1FF014127F9116>I<38FF07E0383C03
80381C0100A2EA0E02A2EA0F06EA0704A2EA0388A213C8EA01D0A2EA00E0A31340A25BA2
12F000F1C7FC12F312661238131A7F9116>I<EA7FFCEA70381260EA407013F013E0EA41
C012031380EA0700EA0F04120E121CEA3C0CEA380812701338EAFFF80E127F9112>I<B5
12F01401808B15>I E /Fm 58 127 df<EBFCF83807839CEA0E07001C13081400A5B512
E0381C0700AC387F1FE01617809615>11 D<13FFEA0707120E121CA6B5FCEA1C07AC387F
1FC01217809614>13 D<EBFC7E380703C1390E078380001C1303EC010091C7FCA4B61280
381C0703AC397F1FCFE01B1780961D>I<120112021204120C1218A21230A212701260A3
12E0AA1260A312701230A21218A2120C12041202120108227D980E>40
D<12801240122012301218A2120CA2120E1206A31207AA1206A3120E120CA21218A21230
12201240128008227E980E>I<1330ABB512FCA238003000AB16187E931B>43
D<126012F0A212701210A21220A21240A2040A7D830A>I<EAFF80A2090280870C>I<1260
12F0A2126004047D830A>I<130813181330A31360A313C0A3EA0180A3EA0300A21206A3
5AA35AA35AA35AA35AA20D217E9812>I<EA07C0EA1830EA3018EA701CEA600CA2EAE00E
A9EA600CA2EA701CEA3018EA1C70EA07C00F157F9412>I<1206120E12FE120EB1EAFFE0
0B157D9412>I<EA0F80EA30E0EA4070EA8030EAC03812E0124012001370A2136013C0EA
0180EA03001206EA0C081208EA1018EA3FF0127F12FF0D157E9412>I<EA0FE0EA3030EA
6018EA701CA21200131813381360EA07E0EA00301318130C130EA212E0A2EAC00CEA4018
EA3030EA0FE00F157F9412>I<EA07C0EA1830EA30181260EAE00CA2130EA3EA601E1230
EA186EEA0F8EEA000E130C131CEA7018A2EA6030EA20E0EA1F800F157F9412>57
D<126012F0A212601200A6126012F0A21260040E7D8D0A>I<13101338A3135CA3138EA3
EA0107A238020380A33807FFC0EA0401A2380800E0A2001813F0123838FE03FE17177F96
1A>65 D<EAFFFE381C0380EB00E014601470A414E0EB01C0381FFF8014C0381C00E01470
14301438A4147014E0EB01C0B5120015177F9619>I<EBFC1038038330380E00B0481370
481330123000701310126012E01400A51410126012700030132012386C13406C13803803
8300EA00FC14177E9619>I<B512E0EA1C00146014201410A3EB0400A3130CEA1FFCEA1C
0C13041408A2130014181410A2143014F0B5FC15177F9618>69 D<B512E0EA1C00146014
201410A3EB0400A3130CEA1FFCEA1C0C1304A390C7FCA6EAFFC014177F9617>I<EAFFE0
EA0E00B3A3EAFFE00B177F960D>73 D<EA0FF8EA00E0B112E0A2EAC1C0EA6180EA1F000D
177E9612>I<00FEEB03F8001E14C000171305A338138009A23811C011A33810E021A2EB
7041A3EB3881A2EB1D01A2130EA2123839FE040FF81D177F9620>77
D<00FC13FE001E1338001F13101217EA1380EA11C0A2EA10E013701338A2131C130E130F
1307EB0390EB01D0A2EB00F014701430123800FE131017177F961A>I<13FCEA0303380E
01C0381C00E048137000301330007013380060131800E0131CA700701338A20030133000
3813706C13E0380E01C038030300EA00FC16177E961B>I<EAFFFE381C0380EB00C01460
1470A4146014C0EB0380381FFE00001CC7FCAAB47E14177F9618>I<EA0FC4EA302CEA60
1CEA400CEAC004A3EAE0001270127FEA3FE0EA0FF8EA01FCEA001C130E13061280A3EAC0
04EAE008EAD810EA87E00F177E9614>83 D<387FFFF83860381800401308A200801304A3
00001300AF3803FF8016177F9619>I<38FF80FE381C00381410B06C132012066C134038
01818038007E0017177F961A>I<3AFF07FC3F803A3C00E00E00001C1404A2EB0170000E
5CA2EB023800075CA2EB041CD803845BA2EB880ED801C85BA2EBD007D800F05BA3EBE003
016090C7FCA221177F9624>87 D<EA3FC0EA70601330EA20381200EA03F8EA1E38123012
70EAE039A21379EA70FFEA1F1E100E7F8D12>97 D<12F81238A8EA39F0EA3E0CEA380613
077F1480A414005B1306EA361CEA21F011177F9614>I<EA07F0EA18381230EA7010EA60
0012E0A41260EA70081230EA1830EA07C00D0E7F8D10>I<133E130EA8EA07CEEA1C3EEA
300E1270126012E0A412601270EA301EEA182E3807CF8011177F9614>I<EA0FC0EA1860
EA3030EA7038EAE018EAFFF8EAE000A31260EA7008EA3010EA1830EA07C00D0E7F8D10>
I<EA03E0EA0670120EEA1C201300A5EAFF80EA1C00ACEA7F800C1780960B>I<EA0F9EEA
18E3EA3060EA7070A3EA3060EA18C0EA2F80EA20001260EA3FE013F813FCEA600EEAC006
A3EA600CEA3838EA0FE010157F8D12>I<12F81238A813F8EA3B1CEA3C0E1238AA38FE3F
8011177F9614>I<12301278A212301200A512F81238AC12FE07177F960A>I<1203EA0780
A2EA0300C7FCA5EA1F801203AF1243EAE30012E7127C091D82960B>I<12F81238A8133E
13381330134013801239EA3FC0EA39E0123813F01378133CA2EAFE7F10177F9613>I<12
F81238B3A312FE07177F960A>I<38F8F83E383B1CC7393C0F0380EA380EAA39FE3F8FE0
1B0E7F8D1E>I<EAF8F8EA3B1CEA3C0E1238AA38FE3F80110E7F8D14>I<EA07C0EA1830EA
3018EA600CA2EAE00EA5EA701CEA3018EA1830EA07C00F0E7F8D12>I<EAF9F0EA3E1CEA
380613077F1480A414005B130EEA3E1CEA39F00038C7FCA512FE11147F8D14>I<EA07C2
EA1C26EA381EEA700E126012E0A412601270EA301EEA1C2EEA07CEEA000EA5EB3F801114
7F8D13>I<EAF9E0EA3A70123CEA38201300A9B4FC0C0E7F8D0E>I<EA1F40EA60C0EAC040
A2EAE000B4FCEA7F80EA1FC0EA01E0EA8060A212C0EAE0C0EA9F000B0E7F8D0E>I<1208
A31218A21238EAFFC0EA3800A71340A4EA1C80EA0F000A147F930E>I<EAF83EEA380EAA
131EEA1C2E3807CF80110E7F8D14>I<EAFE1FEA380EEA3C0CEA1C08A2EA0E10A2EA0720
A213E0EA03C0A2EA0180A2100E7F8D13>I<38FEFE7C383838381410133C001C1320134C
381E4E60380ECE401387000713801303A200031300EA0201160E7F8D19>I<EAFE3FEA3C
1CEA1C10EA0E20EA074013C0EA0380EA01C0EA02E0EA04F0EA0870EA1838EA383CEAFC7F
100E7F8D13>I<EAFE1FEA380EEA3C0CEA1C08A2EA0E10A2EA0720A213E0EA03C0A2EA01
80A21300A212E2A212A4127810147F8D13>I<EAFFF0EAC0E01280EA81C0EA83801287EA
0700120EEA1E08121CEA3818EA70101330EAFFF00D0E7F8D10>I<EA3C20EA7FC0EA8780
0B037D9512>126 D E /Fn 32 122 df<121812381278123812081210A21220A2124012
80050B7D830C>44 D<14081418A21430A21460A214C0A2EB0180EB0300A21306A25BA25B
5BA25BA25BA2485A48C7FCA21206A25AA25AA25A5AA25A5A15257F9B14>47
D<137CEA0186EA03031206000C1380121CA21238A338700700A4EAE00EA35BA213185BEA
60606C5A001FC7FC11187C9714>I<137CEA0186EA020300041380138312081210A33811
07001212EA0C0EC65A13305BEA01800002C7FC120CEA10011220EA3C06EA67FEEAC1FCEA
80F011187D9714>50 D<133E13C3380101801202380481C0134138088380120438070300
EA00065BEA01F0EA00187FA2130EA21260EAE01CA2EA8038EA4030EA20E0EA1F8012187D
9714>I<13031480EB0700A3130EA35BA213185BA25B5B13C6EA018EEA030EEA021C1204
12081210EA7FB838807F8038003800A25BA41360111F7F9714>I<38030180EBFF0013FC
EA022048C7FCA45AEA0BE0EA0C181208EA001CA412201270485AEA8030EA40705BEA2180
001EC7FC11187C9714>I<133EEBC180EA0100000213C01206A2380E0180380703001386
EA03CCEA01F07FEA067C487EEA181EEA30071260A2EAC006A2EA400CEA6018EA3070EA0F
C012187D9714>56 D<1420146014E0A2130114F0EB0270A213041308A21310A213201340
A2EB8038EBFFF8380100381202A25AA25A121838FE01FF181A7E991D>65
D<3803FFF83800700E1406140713E0A43801C00E141C143814703803FFE0EB8078143814
1CEA0700A4000E1338A2147014E0381C03C0B51200181A7D991B>I<3803FFF83800700E
80809038E00180A315C0EA01C0A43903800380A3150048485AA2140E140C000E131C5C5C
5C381C0380D8FFFEC7FC1A1A7D991D>68 D<0003B5FC380070071403140113E0A43801C0
80A313C13803FF001381A3EA070290C7FCA3120EA4121EEAFFC0181A7D9919>70
D<EB0FC1EB3021EBC0133801800F38070006120E120C5A00381304123000701300A25AA3
EB07FEEB0070A4006013E0A27EEA1801380C0640EA03F8181A7A991E>I<EA03FFEA0070
A313E0A4EA01C0A4EA0380A4EA0700A4120EA45AEAFF80101A7D990F>73
D<EBFFC0EB0E00A35BA45BA45BA45BA4EA61C012E15B12830047C7FC123C121A7C9914>
I<EA03FFEA0070A35BA4485AA4485AA448C7FC1410A21420120E1460144014C0381C0380
B5FC141A7D9918>76 D<3903F007F839007800C01580A290389C0100A3138E38010E0213
061307A238020384A3EB01C4000413C8A2EB00E8A24813F01470A21218142012FE1D1A7D
991D>78 D<EB1F80EB70603801C030380300180006131C000E130C5A0018130E12381230
1270A248131CA31438A21430147014E014C03860018038700300EA3806EA1C1CEA07E017
1A7A991D>I<3803FFF83800701C1406140713E0A43801C00EA2141C143838038060EBFF
80EB8000A248C7FCA4120EA45AB47E181A7D991A>I<EB3F10EB60903801807013004813
201206A31400120713C0EA03F8EA01FEEA007FEB0F8013031301A21220A238600300A213
06EA700CEAC818EA87E0141A7D9916>83 D<387FE0FF380E00181410A2481320A4481340
A4481380A438E00100A31302A25BEA60085BEA3860EA0F80181A78991D>85
D<EA01E0EA0618120CEA1838EA3010EA7000126012E0A413081310EA6020EA30C0EA1F00
0D107C8F12>99 D<EA01E0EA0E18EA1C08123812701310EAFFE0EAE000A41308EA601013
20EA30C0EA1F000D107C8F12>101 D<1203120712061200A61238124C124E128E129CA2
121C1238A212701272A212E212E41264123808197C980C>105 D<EA307CEA5986EA9E07
A2129CA2EA380EA35B00701380A21338EB3900EAE019EA600E11107C8F16>110
D<EA01F0EA0618EA0C0CEA180E12301270126012E0A2130C131C13181330EA6060EA30C0
EA1F000F107C8F14>I<EA30F0EA5D18EA9E38EA9C181300A25AA45AA45A12600D107C8F
10>114 D<EA03E0EA04301208EA18701360EA1C00EA1F8013C0EA0FE01200136012E0A2
EA80C0EA4180EA3E000C107D8F10>I<1206120EA45AA2EAFFC0EA1C005AA45AA412E1A3
12E212E412380A177C960D>I<EA3818EA4C1C124EEA8E0C129CA2EA1C081238A2131012
70A21320EA3040EA18C0EA0F000E107C8F12>118 D<EA078F3808D180EA10F3EA20E1EB
E000A2EA01C0A4EA0382A212C3EAE784EAC588EA78F011107E8F12>120
D<EA3806EA4C07EA4E0E128E129CA2EA1C1C1238A3EA7038A3EA3078EA38F0EA0F701200
1360EA60E0EAE1C0EAC180EA4700123C10177C8F13>I E /Fo 7
87 df<126012F0A2126004047D830B>46 D<130CA3131EA2132F1327A2EB4380A3EB81C0
A200017F1300A248B47E38020070A2487FA3487FA2003C131EB4EBFFC01A1A7F991D>65
D<B51280380E00E014701438143CA514781470EB01E0380FFFC0380E00F01478143C141C
141EA4141C143C147814F0B512C0171A7F991B>I<EAFF80EA1C00B3A6EAFF80091A7E99
0E>73 D<EA0FFEEA0070B3124012E0A2EA40E0EA61C0EA1F000F1A7E9914>I<EAFFE000
0EC7FCB01408A3141814101430147014F0B5FC151A7F9918>76 D<39FF801FC0391C0007
0014066C1304A36C5BA26C6C5AA36C6C5AA26C6C5AA3EB7080A213790139C7FCA2131EA3
130CA21A1A7F991D>86 D E /Fp 56 124 df<EB3FC03801F0303803C0380007137CEA0F
80A2143891C7FCA4B512FCA2380F807CAE397FE1FF80A2191D809C1B>12
D<EAFFF8A40D04808A10>45 D<127812FCA4127806067D850D>I<EB01801303A2EB0700
A3130EA25BA35BA35BA25BA3485AA3485AA348C7FCA2120EA35AA35AA25AA35AA25A1129
7D9E18>I<EA03F8EA0F1EEA1C07003C1380EA3803007813C0A300F813E0AC007813C0A2
00381380EA3C07001C1300EA0F1EEA03F8131B7E9A18>I<1360EA01E0120F12FF12F312
03B3A2387FFF80A2111B7D9A18>I<EA07F8EA1FFE38383F8038780FC0EAFC0714E01303
A21278EA000714C0A2EB0F80EB1F00131E13385B5B38018060EA03001206000813E0381F
FFC05A5AB5FCA2131B7E9A18>I<EA07F8EA1FFEEA3C1FEB0F80387C07C0127E127C1238
38000F80A2EB1E005BEA03F8EA001EEB0F80EB07C0A214E01230127812FCA214C038780F
80EB1F00EA1FFEEA07F8131B7E9A18>I<EB018013031307130F131F133F136F13CF138F
1201EA030F1206120C12181230126012C0B512F8A238000F80A6EBFFF8A2151B7F9A18>
I<38380180383FFF005B5B5B13C00030C7FCA4EA31F8EA361E38380F80EA3007000013C0
14E0A3127812F8A214C012F038600F8038381F00EA1FFEEA07F0131B7E9A18>I<137EEA
03FF38078180380F03C0EA1E07123C387C03800078C7FCA212F813F8EAFB0E38FA0780EA
FC0314C000F813E0A41278A214C0123CEB0780381E0F00EA07FEEA03F8131B7E9A18>I<
1260387FFFE0A214C01480A238E00300EAC0065B5BC65AA25B13E0A212015B1203A41207
A66C5A131C7D9B18>I<EA03F8EA0FFE381E0F80EA3807EB03C01278127C127E387F8380
383FC70013FE6C5A6C7E6C7E001D138038387FC038781FE0EA700FEAF0031301A3007813
C0EB0380EA3E07381FFE00EA03F8131B7E9A18>I<EA03F8EA0FFEEA1E0F383C07801278
EB03C012F8A214E0A4EA78071238EA3C0BEA0E1BEA03E3EA000314C0A2EA3807007C1380
1400EA780FEA383CEA1FF8EA0FE0131B7E9A18>I<127812FCA412781200A6127812FCA4
127806127D910D>I<EB0380A2497EA3497EA2497E131BEB3BF81331A2EB60FCA2EBE0FE
EBC07EA248487E90B5FC481480EB001F4814C00006130FA248EB07E0A239FF803FFEA21F
1C7E9B24>65 D<90381FE0209038FFF8E03803F80F3807C003380F800148C7FC123E1560
127E127C00FC1400A8007C1460127E123E15C07E390F8001803907C003003803F80E3800
FFFCEB1FE01B1C7D9B22>67 D<B512F814FF390FC01FC0EC07E0EC01F015F8140015FC15
7CA2157EA8157CA315F8A2EC01F0EC07E0EC1FC0B6120014F81F1C7E9B25>I<B6FCA238
0FC01F1407801580A214C1A39038C1C00013C313FFA213C313C113C01560A2EC00E015C0
A21401A21403EC0F80B6FCA21B1C7E9B1F>I<B6FCA2380FC01F1407801580A2140114C1
A2ECC00013C113C313FFA213C313C113C0A391C7FCA6EAFFFEA2191C7E9B1E>I<90380F
F00890387FFE383901FC07F83807E001390F80007848C7FC481438123E007E1418127C00
FC1400A6EC7FFFA2007CEB01F8127E123E123F7EEA0F80EA07E03801FC0739007FFE7890
380FF818201C7D9B26>I<EAFFFCA2EA0FC0B3A6EAFFFCA20E1C7E9B12>73
D<39FFFC07FFA2390FC000E04A5A4A5A0206C7FC5C14385C5CEBC1C013C3EBC7E0EBCFF0
13FBEBF1F8EBE0FC497E147E806E7E81140F6E7E816E7E3AFFFC1FFF80A2211C7E9B25>
75 D<EAFFFEA2EA0FC0AF1403A31407A21406140E141E147EB512FEA2181C7E9B1D>I<D8
FFC0EB03FF6D5B000F15F0D80DF0130DA3D80CF81319A2017C1331A26D1361A26D13C1A3
90380F8181A2903807C301A2EB03E6A2EB01FCA3EB00F8A23AFFC0701FFFA2281C7E9B2D
>I<39FFE003FFA2390FF000307FEA0DFCEA0CFE137E7FEB1F8014C0EB0FE0EB07F01303
EB01F814FCEB00FE147F143FEC1FB015F0140F1407140314011400A2D8FFC01370153020
1C7E9B25>I<EB3FE03801F07C3803C01E390F800F80391F0007C0001E1303003E14E000
7E14F0007C1301A200FC14F8A8007C14F0007E1303A2003E14E0003F13076C14C0390F80
0F803903C01E003801F07C38003FE01D1C7D9B24>I<B512F814FE390FC03F80140FEC07
C015E0A515C0A2EC0F80EC3F00EBFFFC01C0C7FCABEAFFFCA21B1C7E9B21>I<B512F014
FE380FC03FEC0F806E7E81A55D4A5A023EC7FCEBFFF0EBC07C80143F6E7EA6ED8180A2EC
0FC13AFFFC07C300EC01FE211C7E9B24>82 D<3807F820381FFEE0EA3C07EA7801EA7000
12F01460A26C130012FEEAFFE0EA7FFE6C7E1480000F13C06C13E0EA007FEB03F0130113
0012C0A214E07E38F001C0EAFC0338EFFF00EA83FC141C7D9B1B>I<007FB512E0A23878
1F81007013800060146000E0147000C01430A400001400B03807FFFEA21C1C7E9B21>I<
39FFFC03FFA2390FC00030B3120715606C6C13E03901F001C03900FC078090387FFE00EB
0FF8201C7E9B25>I<3BFFF87FFE0FFCA23B0FC007E000C081D9E003130100071680EC07
F801F014030003D90FFC1300140CD801F81406EC1CFE9039FC187E0E0000150CEC303F01
FE141CD97E701398EC601F013F14B002E013F0ECC00F011F5CEC8007A2010F5CEC00036D
5CA22E1C7F9B31>87 D<EA0FF8EA1C1E383E0F80130714C0121C1200137FEA07E7EA1F07
123C127C12F8A3EA780B383E13F8EA0FE115127F9117>97 D<B4FCA2121FA9EB3F80EBE1
E0EB8070EB0078143CA2143EA6143CA21478EB8070381EC1E0381C3F00171D7F9C1B>I<
EA03FCEA0E0EEA1C1F123C1278130E00F8C7FCA61278EB0180123C381C0300EA0E0EEA03
F811127E9115>I<EB0FF0A21301A9EA01F9EA0F07EA1C03EA3C011278A212F8A61278A2
123CEA1C03380F0FFEEA03F9171D7E9C1B>I<EA03FCEA0F07381C0380383C01C0127814
E012F8A2B5FC00F8C7FCA3127814607E6C13C0380F03803801FC0013127F9116>I<137F
3801E3803803C7C0EA0787120FEB8380EB8000A5EAFFF8A2EA0F80AEEA7FF0A2121D809C
0F>I<3803F0F0380E1F38EA3C0F3838073000781380A400381300EA3C0FEA1E1CEA33F0
0030C7FCA3EA3FFF14C06C13E014F0387801F838F00078A300701370007813F0381E03C0
3807FF00151B7F9118>I<B4FCA2121FA9EB0FC0EB31E0EB40F0EB80F8A21300AB38FFE7
FFA2181D7F9C1B>I<121E123FA4121EC7FCA6127FA2121FAEEAFFC0A20A1E7F9D0E>I<B4
FCA2121FA9EB03FCA2EB01C0EB0300130E5B5B137813FC13BE131F7F1480EB07C0EB03E0
130138FFE7FEA2171D7F9C19>107 D<B4FCA2121FB3A7EAFFE0A20B1D7F9C0E>I<39FF0F
C07E903831E18F3A1F40F20780D980FC13C0A2EB00F8AB3AFFE7FF3FF8A225127F9128>
I<38FF0FC0EB31E0381F40F0EB80F8A21300AB38FFE7FFA218127F911B>I<EA01FC380F
0780381C01C0003C13E0387800F0A200F813F8A6007813F0A2383C01E0381E03C0380F07
803801FC0015127F9118>I<EAFE3E1347381E8F80A3381F070090C7FCAAEAFFE0A21112
7F9114>114 D<EA1FD8EA3078EA601812E0A2EAF000EAFF80EA7FE013F0EA1FF8EA07FC
EA007CEAC01CA212E01318EAF830EACFC00E127E9113>I<1203A45AA25AA2EA3FFC12FF
EA1F00A9130CA4EA0F08EA0798EA03F00E1A7F9913>I<38FF07F8A2EA1F00AC1301120F
380786FFEA01F818127F911B>I<38FFC1FCA2381F00601380000F13C0A23807C180A238
03E300A213F7EA01F613FE6C5AA21378A2133016127F9119>I<39FF8FF8FEA2391F03E0
30A3390F87F06013869038C6F8E03907CC78C0A23903FC7D80EBF83D143F3901F01F00A2
0000131EEBE00EA21F127F9122>I<38FFC7FCA2381F81C0380F83803807C700EA03EEEA
01FC5B1200137C13FEEA01DF38039F80EA070F380607C0380C03E038FF07FCA216127F91
19>I<38FFC1FCA2381F00601380000F13C0A23807C180A23803E300A213F7EA01F613FE
6C5AA21378A21330A25B1270EAF8E05BEAF9800073C7FC123E161A7F9119>I<B512FE17
01808B18>123 D E end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 300dpi
TeXDict begin

%%EndSetup
%%Page: 1 1
1 0 bop 225 267 a Fp(P)l(ARALLEL)15 b(NUMERICAL)i(KERNELS)g(F)o(OR)e
(CLIMA)l(TE)i(MODELS)825 396 y Fo(V.)12 b(BALAJI)645
450 y Fn(SGI/GFDL)g(Princ)n(eton)f(University)586 495
y(PO)j(Box)f(308,)g(Princ)n(eton)e(NJ)i(08542,)f(USA)292
580 y Fm(Climate)g(mo)q(dels)e(solv)o(e)i(the)f(initial)g(v)n(alue)g
(problem)f(of)i(in)o(tegrating)e(forw)o(ard)h(in)h(time)f(the)292
620 y(state)g(of)g(the)g(comp)q(onen)o(ts)d(of)j(the)g(planetary)e
(climate)h(system.)k(The)d(underlying)e(dynam-)292 659
y(ics)15 b(is)g(the)g(solution)e(of)i(the)f(non-linear)f(Na)o
(vier-Stok)o(es)f(equation)h(on)h(a)i(sphere.)24 b(While)292
698 y(the)15 b(dynamics)f(itself)g(is)i(the)f(same)g(for)g(a)g(wide)h
(v)n(ariet)o(y)e(of)h(problems,)f(resolutions)g(and)292
738 y(lengths)h(of)h(in)o(tegration)d(v)n(ary)i(o)o(v)o(er)g(sev)o
(eral)g(orders)g(of)g(magnitude)f(of)h(time)h(and)f(space)292
777 y(scales.)f(E\016cien)o(t)c(in)o(tegration)e(for)i(di\013eren)o(t)f
(problems)f(require)h(di\013eren)o(t)g(represen)o(tat)o(ion)o(s)292
817 y(of)16 b(the)e(basic)h(n)o(umerical)d(k)o(ernels,)j(whic)o(h)g(ma)
o(y)f(also)h(b)q(e)g(a)h(function)d(of)i(the)g(underlying)292
856 y(computer)9 b(arc)o(hitectur)o(e)f(on)j(whic)o(h)f(the)g(sim)o
(ulations)e(are)j(done.)i(Mo)q(dern)d(languages)f(suc)o(h)292
896 y(as)j(F)m(ortran)e(90)h(and)g(C++)i(o\013er)d(the)h(p)q(ossibilit)
o(y)e(of)i(abstract)f(represen)o(tati)o(ons)e(of)k(the)e(the)292
935 y(basic)e(dynamical)e(op)q(erators.)12 b(These)d(abstractions)d
(o\013er)i(a)g(large)g(measure)f(of)i(\015exibilit)o(y)d(in)292
975 y(the)12 b(dynamical)e(op)q(erator)h(co)q(de,)g(without)h
(requiring)e(large-scale)g(rewriting)i(for)g(di\013eren)o(t)292
1014 y(problem)f(sizes)h(and)g(arc)o(hitecture)o(s.)17
b(The)12 b(cost)g(of)h(this)f(abstraction)e(is)j(a)f(function)f(of)h
(the)292 1053 y(maturit)o(y)d(of)j(the)e(compiler)g(as)h(w)o(ell)g(as)h
(the)e(language)f(design.)225 1185 y Fp(1)48 b(In)o(tro)q(ducti)o(on)
225 1276 y Fl(Numerical)16 b(climate)g(and)i(w)o(eather)g(mo)q(dels)f
(to)q(da)o(y)g(op)q(erate)i(o)o(v)o(er)e(a)h(wide)f(range)h(of)225
1326 y(time)13 b(and)h(space)h(scales.)20 b(Curren)o(t)15
b(resolutions)f(of)g(w)o(eather)h(forecasting)f(mo)q(dels)f(ap-)225
1376 y(proac)o(h)19 b(50)f(km)f(for)i(global)e(mo)q(dels,)h(and)g(10)h
(km)e(for)h(mesoscale)g(mo)q(dels.)32 b(Ocean)225 1425
y(mo)q(dels)11 b(range)h(from)f Fk(O)q Fl(\(100\))h(km)e(for)i
(climatic)e(studies)j(to)g(the)f(eddy-resolving)g(mo)q(d-)225
1475 y(els)j(in)f(coastal)h(basins.)20 b(Non-h)o(ydrostatic)15
b(atmospheric)f(mo)q(dels)f(at)i(kilometre-scale)225
1525 y(resolutions)c(are)h(used)g(in)f(small)e(domains)g(to)i(study)h
(cloud)e(and)h(sev)o(ere)i(storm)e(dynam-)225 1575 y(ics,)i(and)g(in)f
(m)o(uc)o(h)g(larger)h(domains)e(spanning)i Fk(O)q Fl(\(1000\))g(km)e
(to)i(study)g(the)h(pro)q(cesses)225 1625 y(underlying)19
b(large-scale)g(con)o(v)o(ectiv)o(ely-driv)o(en)g(systems)h(suc)o(h)f
(as)h(mid-latitude)d(cy-)225 1675 y(clones)12 b(and)g(the)g(ITCZ.)f
(Dep)q(ending)h(on)f(the)h(problem)f(under)h(consideration,)g(w)o(e)g
(ma)o(y)225 1724 y(c)o(ho)q(ose)k(to)e(use)i(sp)q(ectral)g(or)f(grid-p)
q(oin)o(t)f(metho)q(ds;)g(h)o(ydrostatic)h(or)g(non-h)o(ydrostatic)225
1774 y(primitiv)o(e)g(equations;)k(a)e(v)n(ariet)o(y)g(of)g(ph)o
(ysical)f(pro)q(cesses)21 b(ma)o(y)15 b(b)q(e)j(resolv)o(ed)g(b)o(y)f
(the)225 1824 y(n)o(umerics,)12 b(or)g(remain)f(unresolv)o(ed)i
(\(parameterized\);)g(the)g(researc)o(h)h(ma)o(y)d(b)q(e)i(fo)q(cused)
225 1874 y(on)h(understanding)g(c)o(haotic)g(lo)o(w-order)f(dynamics)g
(of)g(a)g(simpli\014ed)f(coupled)i(system,)225 1924 y(or)h(on)f(a)h
(comprehensiv)o(e)g(accoun)o(ting)f(of)g(all)g(con)o(tributing)g
(climate)g(system)g(comp)q(o-)225 1973 y(nen)o(ts;)19
b(and)e(in)g(all)f(of)h(these,)i(the)f(underlying)f(dynamics)f(remains)
g(the)i(solution)e(of)225 2023 y(the)c(same)e(non-linear)h(Na)o
(vier-Stok)o(es)g(equation)g(applied)g(to)g(the)h(complex)e(\015uids)i
(that)225 2073 y(constitute)j(the)f(planetary)g(climate)e(system.)300
2123 y(In)j(climate)f(researc)o(h,)j(with)d(the)i(increased)h(emphasis)
d(on)h(detailed)g(represen)o(ta-)225 2173 y(tion)10 b(of)g(individual)f
(ph)o(ysical)h(pro)q(cesses)k(go)o(v)o(erning)c(the)h(climate,)e(the)j
(construction)f(of)225 2223 y(a)j(mo)q(del)f(has)i(come)e(to)i(require)
g(large)f(teams)g(w)o(orking)f(in)h(concert,)i(with)e(individual)p
225 2371 1423 2 v 225 2433 2 62 v 239 2412 a Fj(kernels:)19
b(submitte)n(d)14 b(to)h Fp(W)l(orld)g(Scien)o(ti\014)o(c)d
Fj(on)k(27)f(May)g(2001)337 b Fp(1)p 1646 2433 V 225
2435 1423 2 v eop
%%Page: 2 2
2 1 bop 225 267 a Fl(sub-groups)16 b(eac)o(h)f(sp)q(ecializing)g(in)g
(a)f(di\013eren)o(t)i(comp)q(onen)o(t)f(of)f(the)i(climate)d(system,)
225 316 y(suc)o(h)f(as)f(the)g(o)q(cean)g(circulation,)g(the)g
(biosphere,)h(land)e(h)o(ydrology)m(,)g(radiativ)o(e)g(transfer)225
366 y(and)h(c)o(hemistry)m(,)f(and)h(so)g(on.)17 b(The)12
b(dev)o(elopmen)o(t)e(of)h(mo)q(del)e(co)q(de)j(no)o(w)f(requires)h
(teams)225 416 y(to)17 b(b)q(e)h(able)f(to)g(con)o(tribute)h(comp)q
(onen)o(ts)e(to)h(an)g(o)o(v)o(erall)f(coupled)i(system,)f(with)g(no)
225 466 y(single)d(k)o(ernel)h(of)e(researc)o(hers)k(mastering)c(the)i
(whole.)k(This)14 b(ma)o(y)e(b)q(e)j(called)f(the)h Fj(dis-)225
516 y(tribute)n(d)c(development)i(mo)n(del)p Fl(,)e(in)g(con)o(trast)g
(with)g(the)h(monolithi)o(c)d(small-team)e(mo)q(del)225
565 y(of)13 b(earlier)h(decades.)300 615 y(These)j(dev)o(elopmen)o(ts)e
(en)o(tail)g(a)g(c)o(hange)h(in)f(the)h(programmi)o(ng)d(paradigm)g
(used)225 665 y(in)18 b(the)i(construction)g(of)e(complex)g(earth)i
(systems)f(mo)q(dels.)32 b(The)19 b(approac)o(h)g(is)g(to)225
715 y(build)13 b(co)q(de)i(out)e(of)g(indep)q(enden)o(t)i(mo)q(dular)d
(comp)q(onen)o(ts,)h(whic)o(h)h(can)g(b)q(e)g(assem)o(bled)225
765 y(b)o(y)d(either)g(c)o(ho)q(osing)g(a)g(con\014guration)f(of)g
(comp)q(onen)o(ts)h(suitable)g(to)f(the)i(scien)o(ti\014c)g(task)225
814 y(at)i(hand,)f(or)h(else)h(easily)e(extended)j(to)d(suc)o(h)i(a)f
(con\014guration.)j(The)e(co)q(de)f(m)o(ust)f(th)o(us)225
864 y(em)o(b)q(o)q(dy)g(the)h(principles)g(of)g Fj(mo)n(dularity,)g
(\015exibility)g(and)i(extensibility)p Fl(.)300 914 y(The)11
b(curren)o(t)i(trend)f(in)f(mo)q(del)e(dev)o(elopmen)o(t)h(is)h(along)f
(these)i(lines,)f(with)g(system-)225 964 y(atic)h(e\013orts)h(under)h
(w)o(a)o(y)d(in)h(Europ)q(e)h(and)f(the)h(U.S)f(to)g(dev)o(elop)g
(shared)h(infrastructure)225 1014 y(for)i(earth)h(systems)f(mo)q(dels.)
22 b(It)15 b(is)g(en)o(visaged)h(that)f(the)h(mo)q(dels)f(dev)o(elop)q
(ed)h(on)f(this)225 1064 y(shared)e(infrastructure)g(will)e(go)g(to)h
(meet)g(a)f(v)n(ariet)o(y)h(of)f(needs:)18 b(they)13
b(will)d(w)o(ork)i(on)g(dif-)225 1113 y(feren)o(t)j(a)o(v)n(ailable)d
(computer)i(arc)o(hitectures)i(at)e(di\013eren)o(t)i(lev)o(els)e(of)g
(complexit)o(y)m(,)d(with)225 1163 y(the)i(same)e(mo)q(del)g(co)q(de)i
(using)f(one)h(set)g(of)f(comp)q(onen)o(ts)g(on)g(a)g(univ)o(ersit)o(y)
g(researc)o(her's)225 1213 y(desktop,)19 b(and)f(with)g(a)g(di\013eren)
o(t)h(c)o(hoice)f(of)f(subsystems,)j(running)e(comprehensiv)o(e)225
1263 y(assessmen)o(ts)c(of)f(climate)e(ev)o(olution)h(at)h(large)g(sup)
q(ercomputing)g(sites)h(using)f(the)h(b)q(est)225 1313
y(assem)o(bly)f(of)g(climate)f(comp)q(onen)o(t)h(mo)q(dels)g(a)o(v)n
(ailable)f(at)i(the)g(momen)o(t.)300 1362 y(The)j(shared)g
(infrastructure)g(curren)o(tly)h(in)d(dev)o(elopmen)o(t)h(concen)o
(trates)i(on)e(the)225 1412 y(underlying)d(\\plum)o(bing")e(for)i
(coupled)h(earth)g(systems)g(mo)q(dels,)e(building)h(the)h(la)o(y)o
(ers)225 1462 y(necessary)i(for)f(e\016cien)o(t)g(parallel)e
(computation)g(and)h(data)g(transfer)h(b)q(et)o(w)o(een)h(mo)q(del)225
1512 y(comp)q(onen)o(ts)11 b(on)f(indep)q(enden)o(t)j(grids.)k(The)11
b(next)h(stage)f(will)e(in)o(v)o(olv)o(e)h(building)g(a)g(la)o(y)o(er)
225 1562 y(of)i(con\014gurable)h(n)o(umerical)e(k)o(ernels)j(on)f(top)f
(of)h(this)f(la)o(y)o(er,)g(and)h(this)g(pap)q(er)g(suggests)225
1611 y(a)h(p)q(ossible)g(mec)o(hanism)d(for)j(the)g(n)o(umerical)f(k)o
(ernel)h(la)o(y)o(er.)300 1661 y(The)20 b(F)m(ortran-90)e(language)762
1646 y Fi(1)799 1661 y Fl(o\013ers)i(a)f(reasonable)h(compromise)d(b)q
(et)o(w)o(een)j(the)225 1711 y(need)13 b(to)e(dev)o(elop)h(high-p)q
(erformance)f(k)o(ernels)h(for)f(the)i(n)o(umerical)d(algorithms)f
(under-)225 1761 y(lying)i(non-linear)h(\015o)o(w)g(in)g(complex)f
(\015uids,)h(and)g(the)h(high-lev)o(el)e(structure)k(needed)f(to)225
1811 y(harness)j(comp)q(onen)o(t)e(mo)q(dels)f(of)h(climate)f
(subsystems)j(dev)o(elop)q(ed)f(b)o(y)f(indep)q(enden)o(t)225
1861 y(groups)h(of)f(researc)o(hers.)28 b(In)16 b(this)g(pap)q(er,)g(I)
g(demonstrate)g(the)h(construction)g(of)e(par-)225 1910
y(allel)e(n)o(umerical)g(k)o(ernels)i(in)e(F90)h(in)g(the)h(con)o(text)
g(of)e(the)i(GFDL)f(Flexible)f(Mo)q(deling)225 1960 y(System)18
b(\(FMS\))494 1945 y Fh(a)515 1960 y Fl(.)h(The)g(structure)i(of)e(the)
g(pap)q(er)h(is)f(as)g(follo)o(ws.)32 b(Sec.)18 b(2is)h(a)g(brief)225
2010 y(description)f(of)e(FMS.)h(Sec.)i(3)d(describ)q(es)k(the)d(MPP)h
(mo)q(dules,)e(a)h(mo)q(dular)e(parallel)225 2060 y(computing)i
(infrastructure)j(underlying)e(FMS,)g(and)h(extensiv)o(ely)g(used)g(in)
f(the)h(ap-)225 2110 y(proac)o(h)f(outlined)f(in)g(this)g(pap)q(er.)30
b(In)17 b(Sec.)i(4,)f(cen)o(tral)g(to)f(this)h(pap)q(er,)g(this)g
(shared)p 225 2184 558 2 v 225 2211 a Fg(a)244 2223 y
Fm(h)o(ttp://www.gfdl.go)o(v)o(/~fm)o(s)p 225 2371 1423
2 v 225 2433 2 62 v 239 2412 a Fj(kernels:)h(submitte)n(d)14
b(to)h Fp(W)l(orld)g(Scien)o(ti\014)o(c)d Fj(on)k(27)f(May)g(2001)337
b Fp(2)p 1646 2433 V 225 2435 1423 2 v eop
%%Page: 3 3
3 2 bop 225 267 a Fl(soft)o(w)o(are)19 b(infrastructure)h(is)e(tak)o
(en)h(to)f(the)h(next)h(stage:)27 b(it)19 b(is)f(sho)o(wn)h(ho)o(w)f
(con\014g-)225 316 y(urable)e(n)o(umerics)f(can)h(b)q(e)g(built,)e(and)
i(extended)h(to)e(include)h(n)o(umerical)e(algorithms)225
366 y(suitable)d(to)h(the)g(problem)e(at)h(hand.)17 b(A)12
b(shallo)o(w)e(w)o(ater)i(mo)q(del)d(is)j(used)g(here)h(as)e(a)g(p)q
(ed-)225 416 y(agogical)j(example.)23 b(The)17 b(co)q(de)g(used)g(in)e
(this)h(section)h(is)f(released)h(under)g(the)g(GNU)225
466 y(public)f(license)i(\(GPL\))e(and)h(is)f(a)o(v)n(ailable)f(for)h
(do)o(wnload)1163 451 y Fh(b)1179 466 y Fl(.)26 b(The)17
b(section)h(concludes)225 516 y(with)f(a)h(discussion)g(of)f(the)h
(strengths)i(and)d(limitations)e(of)i(this)h(approac)o(h.)29
b(Sec.)19 b(5)225 565 y(summarizes)12 b(the)j(\014ndings)f(of)f(the)h
(pap)q(er,)g(and)g(suggests)h(w)o(a)o(ys)f(forw)o(ard.)225
697 y Fp(2)48 b(FMS:)16 b(the)f(GFDL)f(Flexible)g(Mo)q(deling)f(System)
225 791 y Fl(The)19 b(Geoph)o(ysical)e(Fluid)h(Dynamics)e(Lab)q
(oratory)i(\(NO)o(AA/GFDL\))g(underto)q(ok)h(a)225 841
y(tec)o(hnology)11 b(mo)q(dernization)g(program)f(b)q(eginning)h(in)h
(the)g(late)g(1990s.)k(The)d(principal)225 891 y(aim)h(w)o(as)h(to)h
(prepare)h(an)e(orderly)h(transition)f(from)f(v)o(ector)j(to)e
(parallel)g(computing.)225 941 y(Sim)o(ultaneously)m(,)10
b(the)j(opp)q(ortunit)o(y)f(presen)o(ted)j(itself)d(for)g(a)h(soft)o(w)
o(are)f(mo)q(dernization)225 991 y(e\013ort,)21 b(the)f(result)g(of)e
(whic)o(h)h(is)g(the)h(GFDL)f(Flexible)g(Mo)q(deling)f(System)h
(\(FMS\).)225 1041 y(The)g(FMS)h(constitutes)g(a)f(shared)h(soft)o(w)o
(are)f(infrastructure)h(for)f(the)h(construction)225
1090 y(of)15 b(climate)e(mo)q(dels)i(and)g(mo)q(del)f(comp)q(onen)o(ts)
h(for)g(v)o(ector)h(and)f(parallel)f(computers.)225 1140
y(It)j(forms)e(the)i(basis)g(of)f(curren)o(t)i(and)f(future)g(coupled)g
(mo)q(deling)e(at)h(GFDL.)g(It)h(has)225 1190 y(b)q(een)c(recen)o(tly)h
(b)q(enc)o(hmark)o(ed)e(on)g(a)g(wide)h(v)n(ariet)o(y)e(of)h(high-end)g
(computing)f(systems,)225 1240 y(and)16 b(runs)g(in)g(pro)q(duction)g
(on)g(three)h(v)o(ery)f(di\013eren)o(t)h(arc)o(hitectures:)24
b(parallel)15 b(v)o(ector)225 1290 y(\(PVP\),)e(distributed)g(massiv)o
(ely-parallel)c(\(MPP\))k(and)f(distributed)h(shared-memory)225
1339 y(\(DSM\))350 1324 y Fh(c)367 1339 y Fl(,)j(as)h(w)o(ell)e(as)i
(on)f(scalar)h(micropro)q(cessors.)27 b(Mo)q(dels)17
b(in)f(pro)q(duction)g(within)225 1389 y(FMS)f(include)h(a)f(h)o
(ydrostatic)g(sp)q(ectral)h(atmosphere,)f(a)g(h)o(ydrostatic)h(grid-p)q
(oin)o(t)e(at-)225 1439 y(mosphere,)f(an)g(o)q(cean)g(mo)q(del)f
(\(MOM\),)h(and)g(land)g(and)g(sea)h(ice)f(mo)q(dels.)k(In)c(dev)o
(elop-)225 1489 y(men)o(t)d(are)h(a)f(non-h)o(ydrostatic)h(atmospheric)
f(mo)q(del,)g(an)g(Arak)n(a)o(w)o(a)g(C-grid)1420 1474
y Fi(2)1448 1489 y Fl(v)o(ersion)h(of)225 1539 y(the)j(h)o(ydrostatic)g
(grid-p)q(oin)o(t)f(atmospheric)g(mo)q(del,)f(an)i(isop)o(ycnal)f(co)q
(ordinate)h(o)q(cean)225 1588 y(mo)q(del,)e(and)i(an)f(o)q(cean)i(data)
e(assimilation)e(system.)300 1638 y(The)h(shared)h(soft)o(w)o(are)f
(for)f(FMS)h(includes)g(at)g(the)g(lo)o(w)o(est)g(lev)o(el)f(a)h
(parallel)e(frame-)225 1688 y(w)o(ork)k(for)h(handling)e(distribution)i
(of)f(w)o(ork)g(among)f(m)o(ultiple)f(pro)q(cessors,)17
b(describ)q(ed)225 1738 y(in)10 b(Sec.)19 b(3.)d(Up)q(on)11
b(this)f(are)h(built)e(the)i Fj(exchange)i(grid)h Fl(soft)o(w)o(are)c
(la)o(y)o(er)g(for)g(conserv)n(ativ)o(e)225 1788 y(data)i(exc)o(hange)h
(b)q(et)o(w)o(een)h(indep)q(enden)o(t)g(mo)q(del)d(grids,)h(and)g(a)g
(la)o(y)o(er)g(for)g(parallel)f(I/O.)225 1838 y(F)m(urther)i(la)o(y)o
(ers)g(of)f(soft)o(w)o(are)h(include)g(a)f Fj(diagnostics)i(manager)k
Fl(for)12 b(creating)h(run)o(time)225 1887 y(diagnostic)g(datasets)i
(in)e(a)h(v)n(ariet)o(y)f(of)g(\014le)h(formats,)e(a)h
Fj(time)h(manager)p Fl(,)g(general)g(utili-)225 1937
y(ties)h(for)f(\014le-handling)f(and)i(error-handling,)e(and)i(a)f
(uniform)e(in)o(terface)k(to)e(scien)o(ti\014c)225 1987
y(soft)o(w)o(are)h(libraries)g(pro)o(viding)f(metho)q(ds)h(suc)o(h)h
(as)f(FFTs.)23 b(In)o(terc)o(hangeable)16 b(comp)q(o-)225
2037 y(nen)o(ts)d(are)g(designed)g(to)f(presen)o(t)h(a)f(uniform)e(in)o
(terface,)j(so)f(that)h(for)f(instance,)g(b)q(ehind)225
2087 y(an)h(o)q(cean)i(\\mo)q(del")c(in)o(terface)j(in)g(FMS)f(ma)o(y)f
(lie)h(a)g(full-\015edged)g(o)q(cean)i(mo)q(del,)c(a)j(few)p
225 2143 558 2 v 225 2171 a Fg(b)241 2183 y Fm(h)o(ttp://www.gfdl.noa)o
(a.g)o(o)o(v/)o(~vb)o(/k)n(ern)o(els.h)n(tm)o(l)225 2211
y Fg(c)241 2223 y Fm(Also)e(kno)o(wn)e(as)i(cac)o(he-cohe)o(ren)n(t)d
(non-uniform)f(memory)h(access)h(\(ccNUMA\))j(arc)o(hitectu)o(re.)p
225 2371 1423 2 v 225 2433 2 62 v 239 2412 a Fj(kernels:)19
b(submitte)n(d)14 b(to)h Fp(W)l(orld)g(Scien)o(ti\014)o(c)d
Fj(on)k(27)f(May)g(2001)337 b Fp(3)p 1646 2433 V 225
2435 1423 2 v eop
%%Page: 4 4
4 3 bop 225 267 a Fl(lines)14 b(of)f(co)q(de)h(represen)o(ting)i(a)d
(mixed)f(la)o(y)o(er,)h(or)h(merely)f(a)g(routine)h(that)g(reads)h(in)e
(an)225 316 y(appropriate)i(dataset,)h(without)e(requiring)h(other)h
(comp)q(onen)o(t)e(mo)q(dels)g(to)h(b)q(e)h(a)o(w)o(are)225
366 y(whic)o(h)f(of)g(these)h(has)g(b)q(een)g(c)o(hosen)g(in)f(a)g
(particular)g(mo)q(del)e(con\014guration.)22 b(Ph)o(ysics)225
416 y(routines)14 b(constructed)h(for)e(FMS)g(adhere)h(to)f(the)h(1D)e
(column)g(ph)o(ysics)i(sp)q(eci\014cation)1600 401 y
Fh(d)225 466 y Fl(pro)o(viding)i(a)g(uniform)f(ph)o(ysics)j(in)o
(terface.)28 b(Coupled)16 b(climate)g(mo)q(dels)g(in)g(FMS)h(are)225
516 y(built)d(as)g(a)g Fj(single)i(exe)n(cutable)i Fl(calling)12
b(subroutines)k(for)e(comp)q(onen)o(t)g(mo)q(dels)f(for)h(the)225
565 y(atmosphere,)k(o)q(cean)h(and)f(so)g(on.)30 b(Comp)q(onen)o(t)17
b(mo)q(dels)g(ma)o(y)f(b)q(e)j(on)e(indep)q(enden)o(t)225
615 y(logically)12 b(rectangular)i(\(though)g(p)q(ossibly)g(ph)o
(ysically)f(curvilinear\))h(grids,)g(link)o(ed)f(b)o(y)225
665 y(the)h(exc)o(hange)h(grid,)e(and)h(making)d(maxima)o(l)g(use)j(of)
g(the)g(shared)h(soft)o(w)o(are)f(la)o(y)o(ers.)225 784
y Fp(3)48 b(The)15 b(MPP)h(mo)q(dules)225 877 y Fl(The)11
b(parallel)f(framew)o(ork)g(for)h(mo)q(deling)d(in)j(FMS)g(is)g(pro)o
(vided)g(b)o(y)g(a)g(la)o(y)o(er)f(of)h(soft)o(w)o(are)225
927 y(called)j(the)g(MPP)g(mo)q(dules)672 911 y Fh(e)689
927 y Fl(.)225 1023 y Fp(Lo)o(w-lev)o(el)g(comm)o(unicatio)o(n.)k
Fl(This)11 b(la)o(y)o(er)g(is)h(in)o(tended)g(to)f(protect)i(the)f(co)q
(de)g(from)308 1073 y(the)f(comm)o(unication)c(APIs)k(\(MPI,)f(SHMEM,)h
(shared-memory)d(maps\),)i(o\013ering)308 1122 y(lo)o(w-o)o(v)o(erhead)
j(proto)q(cols)g(to)h(a)f(few)g(comm)o(unication)d(op)q(erations,)j
(su\016cien)o(t)h(for)308 1172 y(most)g(purp)q(oses.)22
b(It)15 b(is)f(designed)i(to)e(b)q(e)i(extensible)g(to)e(mac)o(hines)g
(whic)o(h)h(oblige)308 1222 y(the)g(user)f(to)g(use)h(h)o(ybrid)f
(parallelism)d(seman)o(tics.)225 1311 y Fp(The)16 b(domain)e(class)h
(library)l(.)k Fl(This)11 b(mo)q(dule)f(pro)o(vides)i(a)f(class)1287
1296 y Fh(f)1320 1311 y Fl(to)h(de\014ne)g(domain)308
1361 y(decomp)q(ositions)17 b(and)h(up)q(dates.)31 b(It)18
b(pro)o(vides)g(metho)q(ds)g(for)f(p)q(erforming)g(halo)308
1411 y(up)q(dates)j(on)e(gridp)q(oin)o(t)g(mo)q(dels,)g(and)g(data)h
(transp)q(oses)h(for)e(sp)q(ectral)i(mo)q(dels)308 1461
y(or)e(an)o(y)f(other)h(purp)q(ose)g(\(e.g)g(FFTs\).)29
b(It)18 b(is)f(curren)o(tly)i(restricted)g(to)f Fj(lo)n(gic)n(al)r(ly)
308 1511 y(r)n(e)n(ctiline)n(ar)12 b(grids)k Fl(\(whic)o(h)d(category)h
(includes)f(non-standard)g(grids)g(suc)o(h)h(as)f(the)308
1561 y(bip)q(olar)h(grid)523 1545 y Fi(3)555 1561 y Fl(and)h(cub)q(ed)h
(sphere)873 1545 y Fi(4)893 1561 y Fl(\).)k(This)15 b(la)o(y)o(er)f(is)
g(describ)q(ed)i(in)f(some)e(detail)308 1610 y(b)q(elo)o(w.)225
1700 y Fp(P)o(arallel)g(I/O.)21 b Fl(The)13 b(parallel)g(I/O)g(mo)q
(dule)f(pro)o(vides)h(a)g(simple)f(in)o(terface)i(for)e(read-)308
1750 y(ing)f(and)g(writing)g(distributed)h(data.)17 b(It)11
b(is)h(designed)g(for)f(p)q(erformance)g(on)h(paral-)308
1800 y(lel)f Fj(writes)p Fl(,)g(whic)o(h)g(are)h(far)g(more)e(frequen)o
(t)j(in)e(these)i(mo)q(dels.)j(Merely)d(b)o(y)e(setting)308
1849 y(the)k(appropriate)g(\015ags)g(when)h(op)q(ening)e(a)h(\014le,)f
(users)j(can)e(c)o(ho)q(ose)g(b)q(et)o(w)o(een)i(dif-)308
1899 y(feren)o(t)h(I/O)f(mo)q(des,)g(including)f(sequen)o(tial)h(or)g
(direct)h(access,)h(m)o(ulti-threaded)p 225 1945 558
2 v 225 1973 a Fg(d)243 1984 y Fm(h)o(ttp://www.gfdl.go)o(v/)o(~fm)o
(s/g)o(fdl)o(/f90)p 794 1984 11 2 v 9 w(ph)o(ysics)p
916 1984 V 11 w(sp)q(ec.ps)225 2012 y Fg(e)242 2024 y
Fm(h)o(ttp://www.gfdl.noa)o(a.g)o(o)o(v/)o(~vb)o(/m)o(pp)o(.h)o(tm)o(l)
225 2053 y Fg(f)245 2065 y Fm(The)11 b Ff(class)h(libr)n(ary)j
Fm(terminology)8 b(is)j(usually)e(asso)q(ciated)f(with)j(ob)r
(ject-orien)n(ted)d(languages)g(\(C++,)225 2104 y(Ja)o(v)n(a\).)19
b(It)13 b(is)g(a)h(w)o(ell-k)o(ept)d(secret)h(that)g(F90)h(mo)q(dules)e
(allo)o(w)i(one)f(to)h(build)f(class)g(libraries,)g(ha)o(ving)225
2144 y(man)o(y)f(of)h(the)f(useful)g(features,)g(but)g(few)h(of)g(the)g
(curren)o(t)e(p)q(erformance)f(disadv)n(an)o(tag)o(es)h(of)i(OO)h(lan-)
225 2183 y(guages.)22 b(See)14 b(POOMA)j(\(h)o(ttp://www.mcs.la)o(nl.g)
o(o)o(v/)o(p)q(ooma)o(\))12 b(for)h(a)i(C++)h(approac)o(h)c(to)i
(builing)225 2223 y(n)o(umerical)9 b(k)o(ernels.)p 225
2371 1423 2 v 225 2433 2 62 v 239 2412 a Fj(kernels:)19
b(submitte)n(d)14 b(to)h Fp(W)l(orld)g(Scien)o(ti\014)o(c)d
Fj(on)k(27)f(May)g(2001)337 b Fp(4)p 1646 2433 V 225
2435 1423 2 v eop
%%Page: 5 5
5 4 bop 308 267 a Fl(or)19 b(single-threaded)h(I/O)726
251 y Fh(g)745 267 y Fl(,)f(writing)f(a)g(single)h(\014le)g(or)g(m)o
(ultiple)e(\014les)i(for)g(later)308 316 y(assem)o(bly)m(.)e(It)d
(curren)o(tly)h(supp)q(orts)h(netCDF)e(and)g(ra)o(w)g(unformatted)f
(data,)h(but)308 366 y(is)g(designed)g(to)g(b)q(e)h(extensible)f(to)g
(other)h(formats.)300 461 y(The)h(domain)d(class)j(is)f(brie\015y)g
(describ)q(ed)i(here,)g(as)e(it)g(is)g(used)i(in)e(what)g(follo)o(ws.)
225 510 y(The)f(basic)g(elemen)o(t)g(in)f(the)i(hierarc)o(h)o(y)f(is)g
(an)f(axis)h(sp)q(eci\014cation:)225 570 y Fe(type,)21
b(public)f(::)i(domain_axis_spec)290 619 y(integer)f(::)g(begin,)g
(end,)g(size,)f(max_size)290 669 y(logical)h(::)g(is_global)225
719 y(end)g(type)g(domain_axis_spec)300 778 y Fl(The)11
b(axis)e(sp)q(eci\014cation)i(merely)f(marks)f(the)h(b)q(eginning)g
(and)g(end)h(of)e(a)h(con)o(tiguous)225 828 y(range)h(in)f(index)g
(space,)i(plus)f(for)f(con)o(v)o(enience)i(some)d(additional)g
(redundan)o(t)i(informa-)225 878 y(tion)g(that)i(can)f(b)q(e)g
(computed)g(from)e(the)j(range.)18 b(Using)11 b(this,)h(w)o(e)h
(construct)g(a)f(deriv)o(ed)225 928 y(t)o(yp)q(e)g(called)f
Fe(domain1D)f Fl(that)h(can)h(b)q(e)g(used)g(to)g(sp)q(ecify)f(a)h(1D)e
(domain)g(decomp)q(osition:)225 987 y Fe(type,)21 b(public)f(::)i
(domain1D)290 1037 y(type\(domain_axis_sp)o(ec\))d(::)i(compute,)f
(data,)h(global)290 1086 y(integer)g(::)g(pe)290 1136
y(type\(domain1D\),)e(pointer)h(::)i(prev,)f(next)225
1186 y(end)g(type)g(domain1D)300 1245 y Fl(The)15 b(domain)d(decomp)q
(osition)h(consists)i(of)f(three)h(axis)f(sp)q(eci\014cations)h(that)g
(con-)225 1295 y(tain)d(all)f(the)i(information)d(ab)q(out)i(the)h
(grid)f(top)q(ology)g(necessary)i(for)e(comm)o(unication)225
1345 y(op)q(erations)19 b(on)f(distributed)h(arra)o(ys.)32
b(The)19 b Fj(c)n(ompute)h(domain)i Fl(sp)q(eci\014es)e(the)f(range)225
1395 y(of)f(indices)i(that)f(will)f(b)q(e)h(computed)g(on)g(a)g
(particular)g(pro)q(cessing)h(elemen)o(t)e(\(PE\).)225
1445 y(The)g Fj(data)g(domain)j Fl(sp)q(eci\014es)e(the)e(range)h(of)e
(indices)i(that)f(are)g(necessary)j(for)c(these)225 1494
y(computations,)e(i.e)h(b)o(y)g(including)f(a)h(halo)f(region)h
(su\016cien)o(tly)h(wide)f(to)g(supp)q(ort)h(the)225
1544 y(n)o(umerics.)h(The)d Fj(glob)n(al)g(domain)k Fl(sp)q(eci\014es)d
(the)f(global)e(exten)o(t)i(of)f(the)h(arra)o(y)f(that)h(has)225
1594 y(b)q(een)h(distributed)g(across)g(pro)q(cessors.)20
b(In)14 b(addition)f(the)i Fe(domain1D)d Fl(t)o(yp)q(e)j(asso)q(ciates)
225 1644 y(a)d(pro)q(cessor)i(ID)e(with)h(eac)o(h)g(domain,)c(and)k
(main)o(tains)d(a)i(link)o(ed)g(list)g(of)f(neigh)o(b)q(ours)i(in)225
1694 y(eac)o(h)h(direction.)300 1743 y(It)21 b(is)g(no)o(w)g(simple)e
(to)i(construct)i(higher-order)e(domain)e(decomp)q(ositions,)i(of)225
1793 y(whic)o(h)15 b(the)g(2D)g(decomp)q(osition)e(is)i(the)h(most)d
(common.)19 b(This)c(is)g(sp)q(eci\014ed)h(b)o(y)f(a)f(de-)225
1843 y(riv)o(ed)g(t)o(yp)q(e)h(called)g Fe(domain2D)p
Fl(,)d(whic)o(h)i(is)g(constructed)j(using)d(orthogonal)f
Fe(domain1D)225 1893 y Fl(ob)r(jects:)225 1952 y Fe(type,)21
b(public)f(::)i(domain2D)290 2002 y(type\(domain1D\))d(::)j(x,)f(y)290
2052 y(integer)g(::)g(pe)290 2101 y(type\(domain2D\),)e(pointer)h(::)i
(west,)f(east,)f(south,)h(north)p 225 2145 558 2 v 225
2171 a Fg(g)243 2183 y Fm(Single-threa)o(ded)6 b(I/O)j(on)f(m)o
(ultiple)f(pro)q(cessors)g(in)o(v)o(olv)o(es)g(ha)o(ving)g(one)h(pro)q
(cessor)f(gather)g(the)i(global)225 2223 y(data)h(for)h(writing,)g(or)g
(scatter)f(the)g(data)h(after)f(reading.)p 225 2371 1423
2 v 225 2433 2 62 v 239 2412 a Fj(kernels:)19 b(submitte)n(d)14
b(to)h Fp(W)l(orld)g(Scien)o(ti\014)o(c)d Fj(on)k(27)f(May)g(2001)337
b Fp(5)p 1646 2433 V 225 2435 1423 2 v eop
%%Page: 6 6
6 5 bop 447 934 243 4 v 447 1170 4 237 v 686 1170 V 447
1173 243 4 v 683 934 V 683 1170 4 237 v 922 1170 V 683
1173 243 4 v 919 934 V 919 1170 4 237 v 1159 1170 V 919
1173 243 4 v 1155 934 V 1155 1170 4 237 v 1395 1170 V
1155 1173 243 4 v 447 697 V 447 934 4 237 v 686 934 V
447 937 243 4 v 683 697 V 683 934 4 237 v 922 934 V 683
937 243 4 v 919 697 V 919 934 4 237 v 1159 934 V 919
937 243 4 v 1155 697 V 1155 934 4 237 v 1395 934 V 1155
937 243 4 v 447 461 V 447 697 4 237 v 686 697 V 447 700
243 4 v 683 461 V 683 697 4 237 v 922 697 V 683 700 243
4 v 919 461 V 919 697 4 237 v 1159 697 V 919 700 243
4 v 1155 461 V 1155 697 4 237 v 1395 697 V 1155 700 243
4 v 447 225 V 447 461 4 237 v 686 461 V 447 464 243 4
v 683 225 V 683 461 4 237 v 922 461 V 683 464 243 4 v
919 225 V 919 461 4 237 v 1159 461 V 919 464 243 4 v
1155 225 V 1155 461 4 237 v 1395 461 V 1155 464 243 4
v 446 1165 a Fd(\(1,1\))1376 217 y(\(nx,ny\))667 689
y(\(is,js\))903 453 y(\(ie,je\))p 636 414 338 4 v 636
745 4 331 v 970 745 V 636 748 338 4 v 348 1259 a Fm(Figure)10
b(1.)17 b(The)12 b Fc(domain2D)d Fm(t)o(yp)q(e,)h(sho)o(wing)h(global,)
e(data)i(and)f(compute)f(domains.)225 1411 y Fe(end)21
b(type)g(domain2D)300 1468 y Fl(Man)o(y)13 b(of)f(the)h(metho)q(ds)g
(asso)q(ciated)h(with)e(a)h Fe(domain2D)e Fl(can)i(b)q(e)h(assem)o
(bled)e(from)225 1518 y(op)q(erations)k(on)g(its)h Fe(domain1D)d
Fl(elemen)o(ts.)25 b(The)17 b(additional)d(information)f(here)18
b(is)e(to)225 1568 y(main)o(tain)c(a)i(list)g(of)g(neigh)o(b)q(ours)h
(along)f(t)o(w)o(o)g(axes,)h(and)f(to)h(assign)f(a)h(PE)g(to)f(eac)o(h)
h(2D)225 1617 y(domain.)23 b(The)17 b Fe(domain2D)e Fl(ob)r(ject)i(is)f
(sho)o(wn)h(here)g(in)f(Fig.)i(1,)e(for)g(a)g(global)f(domain)225
1667 y Fe(\(1:nx,1:ny\))h Fl(distributed)j(across)g(pro)q(cessors)h
(and)e(yielding)f(a)h(compute)g(domain)225 1717 y Fe(\(is:ie,js:je\))p
Fl(.)300 1767 y(There)f(are)f(t)o(w)o(o)f(basic)h(op)q(erations)g(on)g
(the)g(domain)e(class.)24 b(One)16 b(is)g(to)f(set)i(up)f(a)225
1817 y(domain)g(decomp)q(osition)h(based)h(on)g(the)h(mo)q(del)e(grid)g
(top)q(ology)m(.)29 b(The)19 b(second)g(is)f(a)225 1867
y(high-lev)o(el)c(comm)o(unication)e(op)q(eration)k(to)f(\014ll)f(in)h
(non-lo)q(cal)g(data)g(p)q(oin)o(ts)g(whic)o(h)g(lie)225
1916 y(in)j(compute)g(domains)e(on)i(other)h(PEs,)h(and)e(m)o(ust)f
(therefore)j(b)q(e)f(up)q(dated)g(after)f(a)225 1966
y(compute)13 b(cycle)i(\(e.g)f(halo)f(up)q(date\).)300
2016 y(The)e(simplest)f(v)o(ersion)h(of)f(the)i(\014rst)f(call)f(is)h
(giv)o(en)g(a)f(global)f(grid)i(and)f(the)i(required)225
2066 y(halo)18 b(sizes)i(in)f Fb(x)f Fl(and)h Fb(y)q
Fl(,)i(and)d(returns)j(an)e(arra)o(y)f(of)k Fe(domain2D)17
b Fl(ob)r(jects)j(with)f(the)225 2116 y(required)c(decomp)q(osition:)
225 2173 y Fe(type\(domain2D\))k(::)i(domain\(0:npes-1\))225
2223 y(call)g(mpp_define_domain)o(s\()e(\(/1,nx,1,ny/\),)g(domain,)h
(xhalo=2,)g(yhalo=2)h(\))p 225 2371 1423 2 v 225 2433
2 62 v 239 2412 a Fj(kernels:)e(submitte)n(d)14 b(to)h
Fp(W)l(orld)g(Scien)o(ti\014)o(c)d Fj(on)k(27)f(May)g(2001)337
b Fp(6)p 1646 2433 V 225 2435 1423 2 v eop
%%Page: 7 7
7 6 bop 300 267 a Fl(This)13 b(requests)j(a)d(decomp)q(osition)f(of)h
(the)h(global)e(domain)f(on)i Fe(npes)g Fl(PEs,)h(with)f(a)225
316 y(halo)g(size)i(of)f(2.)k(The)d(la)o(y)o(out)e(across)i(PEs)g(and)f
(domain)d(exten)o(ts)16 b(here)f(are)g(in)o(ternally)225
366 y(c)o(hosen,)i(though)e(optional)f(argumen)o(ts)h(allo)o(w)f(the)i
(user)h(to)e(tak)o(e)h(con)o(trol)f(of)g(these)j(if)225
416 y(desired.)g(In)10 b(addition,)f(there)j(are)f(optional)d(\015ags)i
(for)g(the)h(user)g(to)f(pass)h(in)f(information)225
466 y(ab)q(out)19 b(the)g(grid)f(top)q(ology)m(,)g(e.g)g(p)q(erio)q
(dic)i(b)q(oundaries)f(in)f Fb(x)g Fl(or)h Fb(y)q Fl(,)h(or)f(folds)f
(\(as)h(in)225 516 y(cylindrical)13 b(or)h(bip)q(olar)f(grids\).)300
565 y(After)g(setting)f(up)g(a)g(domain)e(decomp)q(osition,)g(w)o(e)j
(ma)o(y)d(pro)q(ceed)k(with)d(a)h(compu-)225 615 y(tation.)19
b(All)14 b(data)g(is)h(allo)q(cated)f(on)g(the)h Fj(data)j
Fl(domain,)12 b(of)i(whic)o(h)g(only)g(the)h(compute)225
665 y(domain)d(subset)j(is)f(lo)q(cally)f(up)q(dated.)19
b(A)o(t)c(the)f(end)h(of)e(a)h(compute)g(cycle,)g(t)o(ypically)f(a)225
715 y(timestep,)g(w)o(e)h(mak)o(e)f(a)g(call)g(to)h(up)q(date)h(the)f
(non-lo)q(cal)f(data)g(\(halo)g(region\):)225 770 y Fe(real,)21
b(allocatable)e(::)j(f\(:,:\))225 820 y(call)f(mpp_define_domain)o(s\()
e(\(/1,nx,1,ny/\),)g(domain,)h(xhalo=2,)g(yhalo=2)h(\))225
870 y(call)g(mpp_get_compute_d)o(omain)o(\()e(domain,)h(is,)i(ie,)f
(js,)g(je)g(\))225 920 y(call)g(mpp_get_data_doma)o(in\()e(domain,)h
(isd,)h(ied,)g(jsd,)g(jed)g(\))225 970 y(allocate\()f
(f\(isd:ied,jsd:jed)o(\))f(\))225 1019 y(do)i(t)h(=)g(start,end)303
b(!time)21 b(loop)290 1069 y(do)h(j)f(=)h(js,je)356 1119
y(do)f(i)h(=)f(is,ie)421 1169 y(f\(i,j\))g(=)g(...)196
b(!computational)19 b(kernel)356 1219 y(end)i(do)290
1269 y(end)h(do)290 1318 y(call)f(mpp_update_domains\()d(f,)k(domain)e
(\))225 1368 y(end)h(do)300 1424 y Fl(All)d(the)i(top)q(ology)e(and)g
(connectivit)o(y)i(information)c(is)j(stored)h(in)e Fe(domain)p
Fl(,)h(al-)225 1473 y(lo)o(wing)c(the)i(halo)f(up)q(date)h(to)f(pro)q
(ceed.)28 b(This)16 b(data)g(encapsulation)h(pro)o(v)o(es)g(to)f(b)q(e)
h(a)225 1523 y(p)q(o)o(w)o(erful)11 b(mec)o(hanism)e(to)j(simplify)c
(high-lev)o(el)j(co)q(de.)18 b(The)12 b(syn)o(tax)f(remains)f(iden)o
(tical)225 1573 y(for)h(arra)o(ys)g(of)g(an)o(y)g(t)o(yp)q(e,)g(kind)g
(or)g(rank;)h(for)f(op)q(en)g(or)h(p)q(erio)q(dic)f(b)q(oundary)h
(conditions;)225 1623 y(for)17 b(simple)f(or)h(exotic)h(logically)d
(rectangular)i(grids;)i(and)e(on)g(a)g(v)n(ariet)o(y)g(of)g(parallel)
225 1673 y(computing)d(arc)o(hitectures.)25 b(It)15 b(is)h(a)f
(testamen)o(t)g(to)g(the)i(success)g(of)e(the)h(la)o(y)o(ered)g(and)225
1723 y(encapsulated)21 b(in)o(terface)f(design)g(that)f(there)i(are)f
(v)o(ery)g(few)f(circumstances)i(under)225 1772 y(whic)o(h)16
b(dev)o(elop)q(ers)h(of)f(parallel)f(algorithms)f(in)i(FMS)g(ha)o(v)o
(e)g(needed)i(direct)f(recourse)225 1822 y(to)d(the)g(underlying)g
(comm)o(unicatio)o(n)d(proto)q(cols.)300 1872 y(In)f(the)g(next)g
(section)h(w)o(e)f(demonstrate)f(the)i(construction)f(of)f(a)h(la)o(y)o
(er)f(of)g(n)o(umerical)225 1922 y(k)o(ernels)15 b(on)e(top)h(of)f(the)
i Fe(domain)e Fl(class)h(library)m(.)225 2032 y Fp(4)48
b(P)o(arallel)13 b(n)o(umerical)f(k)o(ernels)i(in)h(F90)225
2123 y Fl(The)h(shallo)o(w)f(w)o(ater)h(mo)q(del)f(represen)o(ts)k(the)
d(dynamics)f(of)g(small)f(displacemen)o(ts)h(of)225 2173
y(the)g(surface)h(of)d(a)i(\015uid)f(la)o(y)o(er)g(of)g(constan)o(t)h
(densit)o(y)f(in)g(a)g(gra)o(vitational)f(\014eld.)19
b(Giv)o(en)225 2223 y(a)12 b(rotating)h(\015uid)f(of)g(heigh)o(t)h
Fb(H)s Fl(,)f(the)h(2D)g(dynamics)e(of)h(a)h(small)d(displacemen)o(t)i
Fb(\021)h Fk(\034)e Fb(H)p 225 2371 1423 2 v 225 2433
2 62 v 239 2412 a Fj(kernels:)19 b(submitte)n(d)14 b(to)h
Fp(W)l(orld)g(Scien)o(ti\014)o(c)d Fj(on)k(27)f(May)g(2001)337
b Fp(7)p 1646 2433 V 225 2435 1423 2 v eop
%%Page: 8 8
8 7 bop 225 267 a Fl(ma)o(y)12 b(b)q(e)i(written)h(as:)611
371 y Fb(@)r(\021)p 611 390 47 2 v 615 428 a(@)r(t)675
399 y Fl(=)e Fk(\000)p Fb(H)s Fk(r)c(\001)g Fp(u)g Fl(+)g
Fb(\027)s Fk(r)991 382 y Fi(2)1008 399 y Fb(\021)517
b Fl(\(1a\))607 473 y Fb(@)r Fp(u)p 607 492 51 2 v 613
530 a Fb(@)r(t)675 501 y Fl(=)13 b Fk(\000)p Fb(g)q Fk(r)p
Fb(\021)e Fl(+)e Fb(f)t Fp(k)h Fk(\002)g Fp(u)f Fl(+)g
Fb(\027)s Fk(r)1118 484 y Fi(2)1135 501 y Fp(u)g Fl(+)h
Fp(F)301 b Fl(\(1b\))300 623 y(where)13 b Fp(u)f Fl(is)g(the)h(horizon)
o(tal)f(v)o(elo)q(cit)o(y)m(,)f Fb(g)j Fl(the)f(acceleration)f(due)h
(to)f(gra)o(vit)o(y)m(,)f Fb(f)17 b Fl(the)225 673 y(Coriolis)12
b(parameter,)h Fb(\027)j Fl(the)e(co)q(e\016cien)o(t)g(of)f(viscosit)o
(y)m(,)f(and)i Fp(F)f Fl(an)g(external)h(forcing.)k(I)225
722 y(ha)o(v)o(e)13 b(c)o(hosen)g(to)g(discretize)h(it)f(b)q(elo)o(w)f
(using)h(a)f(forw)o(ard-bac)o(kw)o(ard)g(timestep,)g(and)h(an)225
772 y(explicit)g(treatmen)o(t)h(of)f(rotation,)g(as)h(follo)o(ws:)463
884 y Fb(\021)485 867 y Fh(n)p Fi(+1)559 884 y Fk(\000)c
Fb(\021)623 867 y Fh(n)p 463 903 183 2 v 530 941 a Fl(\001)p
Fb(t)663 912 y Fl(=)j Fk(\000)p Fb(H)s Fl(\()p Fk(r)c(\001)g
Fp(u)p Fl(\))902 895 y Fh(n)933 912 y Fl(+)h Fb(\027)s
Fk(r)1034 895 y Fi(2)1051 912 y Fb(\021)1073 895 y Fh(n)1546
912 y Fl(\(2a\))455 993 y Fp(u)482 976 y Fh(n)p Fi(+1)555
993 y Fk(\000)g Fp(u)624 976 y Fh(n)p 455 1012 191 2
v 525 1050 a Fl(\001)p Fb(t)663 1021 y Fl(=)j Fk(\000)p
Fb(g)q Fl(\()p Fk(r)p Fb(\021)q Fl(\))850 1004 y Fh(n)p
Fi(+1)924 1021 y Fl(+)d Fb(f)t Fp(k)g Fk(\002)f Fp(u)1093
1004 y Fh(n)1125 1021 y Fl(+)g Fb(\027)s Fk(r)1225 1004
y Fi(2)1243 1021 y Fp(u)1270 1004 y Fh(n)1301 1021 y
Fl(+)g Fp(F)1372 1004 y Fh(n)1544 1021 y Fl(\(2b\))300
1143 y(The)18 b(sup)q(erscript)i(refers)f(to)e(the)i(time)d(lev)o(el.)
29 b(The)18 b(spatial)f(discretization)h(has)225 1192
y(b)q(een)f(left)f(unsp)q(eci\014ed)i(b)q(ecause)g(the)f(n)o(umerical)e
(k)o(ernels)i(constructed)h(will)d(b)q(e)i(able)225 1242
y(to)d(supp)q(ort)h(m)o(ultiple)d(grid)i(stencils.)20
b(Observ)n(an)o(t)15 b(readers)h(will)c(note)j(that)f(the)h(treat-)225
1292 y(men)o(t)k(of)g(the)i(Coriolis)e(term)g(is)h(formally)d
(unstable;)23 b(the)d(unconditionally)e(stable)225 1342
y(represen)o(tation)h(in)o(tro)q(duces)g(some)e(additional)e
(considerations)j(that)g(are)g(discussed)225 1392 y(b)q(elo)o(w)c(in)f
(Sec.)19 b(4g)o(.)300 1442 y(The)d(shallo)o(w)e(w)o(ater)i(mo)q(del)d
(is)j(a)f(standard)g(p)q(edagogical)g(to)q(ol)f(used)j(in)e(NWP)1590
1426 y Fi(5)1608 1442 y Fl(.)225 1491 y(It)i(is)g(also)g(of)f
(signi\014cance)i(in)f(real)g(mo)q(dels:)23 b(eac)o(h)18
b(la)o(y)o(er)f(of)f(a)h(mass-based)g(v)o(ertical)225
1541 y(co)q(ordinate)k(system)f(ma)o(y)e(b)q(e)j(though)o(t)f(of)g(as)g
(b)q(eing)h(a)f(shallo)o(w)f(w)o(ater)i(la)o(y)o(er.)37
b(In)225 1591 y(addition,)14 b(it)h(is)g(customary)f(in)h(o)q(cean)h
(mo)q(dels)e(to)h(separate)h(out)f(the)h(2D)f(barotropic)225
1641 y(dynamics)d(of)g(the)h(o)q(cean,)h(whic)o(h)e(is)h(formally)d(a)j
(shallo)o(w)e(w)o(ater)j(mo)q(del,)d(from)g(the)i(3D)225
1691 y(baro)q(clinic)c(dynamics)g(of)h(the)g(in)o(terior,)g(whose)h(in)
o(trinsic)f(timescales)f(are)i(m)o(uc)o(h)d(longer.)225
1740 y(P)o(arallel)13 b(barotropic)h(solv)o(ers)g(tend)h(to)e(b)q(e)i
(latency-b)q(ound)f(and)g(limit)d(the)j(scalabilit)o(y)225
1790 y(of)f(o)q(cean)h(co)q(des)485 1775 y Fi(6)505 1790
y Fl(,)e(and)i(are)f(th)o(us)h(a)f(p)q(oten)o(tial)g(clien)o(t)g(for)g
(e\016cien)o(t)h(n)o(umerical)e(k)o(ernels)225 1840 y(dev)o(elop)q(ed)j
(for)e(a)h(shallo)o(w)e(w)o(ater)j(mo)q(del.)225 1947
y Fj(4a)43 b(A)15 b(class)f(hier)n(ar)n(chy)h(for)f(the)h(shal)r(low)f
(water)g(mo)n(del)225 2023 y Fl(The)g(k)o(ey)f(to)g(constructing)i
(class)e(libraries)g(that)h(are)f(in)o(tuitiv)o(e)g(and)g(easy)g(to)h
(use)g(is)f(to)225 2073 y(de\014ne)18 b(ob)r(jects)g(as)f(close)h(as)f
(is)g(reasonable)g(to)g(the)g(elemen)o(ts)g(of)f(the)i(system)f(b)q
(eing)225 2123 y(mo)q(deled.)28 b(Here)19 b(the)f(ob)r(jects)g(b)q
(eing)g(mo)q(deled)e(are)i(v)o(ector)h(and)e(scalar)h(\014elds,)g(and)
225 2173 y(the)c(op)q(erations)g(are)g(arithmetic,)d(rotational)h(and)i
(di\013eren)o(tial)f(op)q(erations)h(on)f(\014elds.)225
2223 y(These)20 b(will)c(th)o(us)j(b)q(ecome)f(the)h(ob)r(jects)h(and)e
(metho)q(ds)g(of)f(our)i(class.)31 b(Di\013eren)o(tial)p
225 2371 1423 2 v 225 2433 2 62 v 239 2412 a Fj(kernels:)19
b(submitte)n(d)14 b(to)h Fp(W)l(orld)g(Scien)o(ti\014)o(c)d
Fj(on)k(27)f(May)g(2001)337 b Fp(8)p 1646 2433 V 225
2435 1423 2 v eop
%%Page: 9 9
9 8 bop 225 267 a Fl(op)q(erations)16 b(on)f(scalar)g(and)g(v)o(ector)h
(\014elds)g(will)e(require)i(a)f(represen)o(tation)i(of)e(a)g
Fj(grid)p Fl(,)225 316 y(with)k(an)f(asso)q(ciated)i(metric)f(tensor.)
34 b(Finally)m(,)18 b(for)g(parallel)g(co)q(des,)j(the)f(grid)e(will)
225 366 y(need)h(to)e(built)g(on)g(a)h(la)o(y)o(er)f(supp)q(orting)h
(domain)d(decomp)q(osition.)28 b(Th)o(us)18 b(the)g(class)225
416 y(hierarc)o(h)o(y)c(b)q(eing)g(dev)o(elop)q(ed)h(is:)225
511 y Fp(The)h(domain)e(class)20 b Fl(describ)q(ed)e(ab)q(o)o(v)o(e,)e
(represen)o(ting)i(index-space)g(top)q(ologies)d(of)308
561 y(domains)d(distributed)j(across)f(parallel)f(pro)q(cessing)i
(elemen)o(ts;)225 650 y Fp(A)h(grid)e(class)20 b Fl(sup)q(erp)q(osing)e
(a)e(ph)o(ysical)g(grid)g(on)h(the)g(domain)d(class,)j(supplying)f(a)
308 699 y(grid)d(metric)h(tensor)h(and)e(di\013eren)o(tiation)h(co)q
(e\016cien)o(ts;)225 788 y Fp(A)i(\014eld)e(class)20
b Fl(of)9 b(2D)h(scalar)g(and)f(v)o(ector)i(\014elds)f(supp)q(orting)g
(arithmetic,)g(rotational,)308 838 y(and)k(di\013eren)o(tial)f(op)q
(erations)i(on)e(the)i(grid.)300 933 y(The)e(shallo)o(w-w)o(ater)f(mo)q
(del)f(is)h(2D,)g(and)g(therefore)j(tends)e(to)g(b)q(e)g(latency-b)q
(ound,)225 983 y(since)i(a)e(2D)g(halo)g(region)g(pro)q(duces)j(a)d
(short)i(comm)o(uni)o(cation)c(b)o(yte-stream.)18 b(W)m(e)13
b(use)225 1033 y(the)h Fj(active)h(domain)j Fl(axis)13
b(sp)q(eci\014cation)i(for)f(latency-hiding.)225 1146
y Fj(4b)43 b(A)n(ctive)14 b(domains.)225 1224 y Fl(A)h(new)f(axis)g(sp)
q(eci\014cation)i(that)e(has)h(recen)o(tly)g(b)q(een)h(added)e(to)h
(the)g(domain)d(class)j(is)225 1274 y(the)g Fj(active)h(domain)i
Fl(axis)c(sp)q(eci\014cation.)21 b(This)14 b(can)h(b)q(e)g(used)h(to)e
(main)o(tain)e(the)j(state)225 1324 y(of)j(the)h(data)f(domain,)f(and)i
(can)g(pro)o(vide)f(a)g(simple)f(and)i(p)q(o)o(w)o(erful)f(mec)o
(hanism)e(of)225 1374 y(trading)11 b(comm)o(unication)d(for)j
(computation)f(on)h(parallel)g(clusters)i(with)e(high-latency)225
1424 y(in)o(terconnect)16 b(fabrics,)f(or,)f(more)g(generally)m(,)f(on)
h(high-latency)h(co)q(de)g(segmen)o(ts.)20 b(The)225
1473 y(idea)f(is)g(to)g(use)h Fj(wide)f(halos)k Fl(and)c(compute)f(as)i
(m)o(uc)o(h)e(lo)q(cally)f(in)i(the)h(halo)e(as)h(the)225
1523 y(n)o(umerics)12 b(p)q(ermit.)k(These)e(p)q(oin)o(ts)e(are)h
(shared)g(b)o(y)f(more)f(than)h(one)g(PE,)h(and)f(th)o(us)g(are)225
1573 y(redundan)o(tly)j(computed.)k(The)c(redundan)o(t)g(computations)e
(p)q(ermit)h(one)g(to)h(p)q(erform)225 1623 y(halo)h(up)q(dates)i(less)
f(often.)27 b(In)17 b(eac)o(h)h(computational)c(cycle,)k(the)f(size)h
(of)e(the)i(activ)o(e)225 1673 y(domain)12 b(is)i(reduced)j(un)o(til)c
(no)h(further)i(computations)d(are)i(p)q(ossible)f(without)h(a)f(halo)
225 1722 y(up)q(date.)k(Only)12 b(then)h(is)f(the)h(halo)e(up)q(date)i
(p)q(erformed.)k(An)c(example)e(is)h(sho)o(wn)g(b)q(elo)o(w)225
1772 y(in)j(Sec.)j(4f.)j(Fig.)d(2)c(sho)o(ws)i(successiv)o(e)h(stages)f
(of)e(a)h(computational)d(cycle)k(requiring)225 1822
y(halo)d(up)q(dates)i(on)e(ev)o(ery)i(fourth)f(timestep.)225
1936 y Fj(4c)43 b(Sc)n(alar)14 b(and)i(ve)n(ctor)f(\014elds)225
2014 y Fl(The)f(scalar)g(\014eld)g(is)g(constructed)i(as)e(follo)o(ws:)
225 2073 y Fe(type,)21 b(public)f(::)i(scalar2D)290 2123
y(real,)f(pointer)f(::)i(data\(:,:\))290 2173 y(integer)f(::)g(is,)g
(ie,)g(js,)h(je)225 2223 y(end)f(type)g(scalar2D)p 225
2371 1423 2 v 225 2433 2 62 v 239 2412 a Fj(kernels:)e(submitte)n(d)14
b(to)h Fp(W)l(orld)g(Scien)o(ti\014)o(c)d Fj(on)k(27)f(May)g(2001)337
b Fp(9)p 1646 2433 V 225 2435 1423 2 v eop
%%Page: 10 10
10 9 bop 447 934 243 4 v 447 1170 4 237 v 686 1170 V
447 1173 243 4 v 683 934 V 683 1170 4 237 v 922 1170
V 683 1173 243 4 v 919 934 V 919 1170 4 237 v 1159 1170
V 919 1173 243 4 v 1155 934 V 1155 1170 4 237 v 1395
1170 V 1155 1173 243 4 v 447 697 V 447 934 4 237 v 686
934 V 447 937 243 4 v 683 697 V 683 934 4 237 v 922 934
V 683 937 243 4 v 919 697 V 919 934 4 237 v 1159 934
V 919 937 243 4 v 1155 697 V 1155 934 4 237 v 1395 934
V 1155 937 243 4 v 447 461 V 447 697 4 237 v 686 697
V 447 700 243 4 v 683 461 V 683 697 4 237 v 922 697 V
683 700 243 4 v 919 461 V 919 697 4 237 v 1159 697 V
919 700 243 4 v 1155 461 V 1155 697 4 237 v 1395 697
V 1155 700 243 4 v 447 225 V 447 461 4 237 v 686 461
V 447 464 243 4 v 683 225 V 683 461 4 237 v 922 461 V
683 464 243 4 v 919 225 V 919 461 4 237 v 1159 461 V
919 464 243 4 v 1155 225 V 1155 461 4 237 v 1395 461
V 1155 464 243 4 v 446 1165 a Fd(\(1,1\))1376 217 y(\(nx,ny\))667
689 y(\(is,js\))903 453 y(\(ie,je\))p 636 414 338 4 v
636 745 4 331 v 970 745 V 636 748 338 4 v 649 426 311
2 v 649 733 2 308 v 958 733 V 649 735 311 2 v 661 438
287 2 v 661 721 2 284 v 946 721 V 661 723 287 2 v 673
449 264 2 v 673 709 2 260 v 934 709 V 673 711 264 2 v
225 1259 a Fm(Figure)13 b(2.)k(The)d Fc(domain2D)e Fm(t)o(yp)q(e,)i
(sho)o(wing)f(global,)g(data)g(and)g(compute)f(domains)g(as)i(thic)o(k)
f(lines.)225 1299 y(Successiv)o(e)c(stages)h(of)h(a)h(diminishing)c
(activ)o(e)i(domain)g(are)g(sho)o(wn)h(as)h(thin)e(lines.)300
1460 y Fl(The)18 b Fe(data)e Fl(elemen)o(t)h(of)g(the)g
Fe(scalar2D)f Fl(t)o(yp)q(e)i(con)o(tains)f(the)h(\014eld)f(v)n(alues.)
28 b(The)225 1510 y(F)m(ortran)17 b(standard)h(requires)h(arra)o(ys)e
(within)g(deriv)o(ed)h(t)o(yp)q(es)g(to)f(ha)o(v)o(e)g(the)h
Fe(pointer)225 1559 y Fl(attribute.)29 b(\(This)17 b(will)f(b)q(e)i
(revised)h(in)e(F)m(ortran-2000,)f(whic)o(h)h(will)f(p)q(ermit)h(allo)q
(cat-)225 1609 y(able)d(arra)o(ys)g(within)f(t)o(yp)q(es\).)20
b(The)14 b(activ)o(e)g(domain)e(describ)q(ed)k(in)d(Sec.)19
b(4b)14 b(main)o(tains)225 1659 y(the)19 b(state)h(of)e(the)h(data)f
(domain,)f(and)i(sets)h(the)f(limits)d(of)i(the)i(domain)c(that)j(con-)
225 1709 y(tain)c(v)n(alid)e(data.)22 b(W)m(e)15 b(use)h(this)f
(information)d(to)j(limit)e(the)j(arra)o(y)f(sections)h(used)g(for)225
1759 y(computations,)c(and)i(to)g(determine)f(when)i(a)e(halo)g(up)q
(date)i(is)f(required.)300 1808 y(There)h(are)f(pros)h(and)e(cons)i(to)
f(the)g(use)h(of)e(arra)o(ys)h(with)g(a)f Fe(pointer)g
Fl(attribute:)267 1908 y Fk(\017)20 b Fl(P)o(oin)o(ter)d(arra)o(ys)g
(can)g(b)q(e)g(p)q(oin)o(ted)g(to)g(a)f(p)q(ersisten)o(t)j(priv)n(ate)d
(w)o(orkspace,)i(called)308 1958 y(the)d Fj(user)f(stack)p
Fl(.)k(This)c(has)g(t)o(w)o(o)g(adv)n(an)o(tages:)355
2051 y Fp({)20 b Fl(It)15 b(sa)o(v)o(es)g(the)g(o)o(v)o(erhead)g(of)f
(a)h(system)f(call)g(to)g(allo)q(cate)g(memory)e(from)h(the)399
2101 y(heap;)355 2173 y Fp({)20 b Fl(It)h(a)o(v)o(oids)e(the)i(p)q
(ossibilit)o(y)e(of)g(memory)f(leaks)i(that)g(can)h(b)q(e)g(caused)g(b)
o(y)399 2223 y(incautious)14 b(use)h(of)e(the)h Fe(allocate)f
Fl(statemen)o(t)g(on)h Fe(pointer)e Fl(arra)o(ys:)p 225
2371 1423 2 v 225 2433 2 62 v 239 2412 a Fj(kernels:)19
b(submitte)n(d)14 b(to)h Fp(W)l(orld)g(Scien)o(ti\014)o(c)d
Fj(on)k(27)f(May)g(2001)313 b Fp(10)p 1646 2433 V 225
2435 1423 2 v eop
%%Page: 11 11
11 10 bop 399 267 a Fe(real,)21 b(pointer)f(::)i(a\(:\))399
316 y(real,)f(target)42 b(::)22 b(b\(100\))399 366 y(allocate\()e
(a\(100\))h(\))399 416 y(a)h(=>)f(b)399 493 y Fl(A)o(t)11
b(this)g(p)q(oin)o(t,)f(the)h(original)e(allo)q(cation)g(of)h(100)f(w)o
(ords)i(has)g(no)f(handle,)h(and)399 543 y(cannot)16
b(b)q(e)f(deallo)q(cated)g(b)o(y)g(the)h(user,)f(nor)g(can)h(the)f
(compiler)f(determine)399 593 y(whether)20 b(or)d(not)h(some)f(arra)o
(y)h(is)f(p)q(oin)o(ting)g(to)h(this)g(lo)q(cation.)29
b(This)17 b(is)h(a)399 643 y(memory)c(leak)h(that)g(can)h(gro)o(w)g
(without)f(limit,)e(if)i(it)g(o)q(ccurs)i(in)e(a)h(routine)399
693 y(that)e(is)g(rep)q(eatedly)h(called.)267 779 y Fk(\017)20
b Fl(It)e(ma)o(y)e(not)i(b)q(e)g(p)q(ossible)g(for)g(an)g(optimizing)d
(compiler)h(to)i(determine)g(if)f(t)o(w)o(o)308 829 y(p)q(oin)o(ter)d
(arra)o(ys)h(are)f(or)h(are)f(not)g(aliased)964 814 y
Fh(h)999 829 y Fl(to)g(eac)o(h)h(other.)20 b(Non-standard)14
b(com-)308 879 y(piler)e(directiv)o(es)i(\(e.g)f Fe(!dir$)21
b(IVDEP)11 b Fl(on)i(compilers)e(supp)q(orting)i(Cra)o(y)f(directiv)o
(e)308 929 y(syn)o(tax\))i(generally)g(p)q(ermit)f(the)h(user)h(to)f
(assist)g(the)h(compiler)d(in)i(this)f(regard.)267 1015
y Fk(\017)20 b Fl(The)10 b(F90)f(standard)i(requires)f(the)h(assignmen)
o(t)d(op)q(erator)j(\(=\))f(applied)f(to)h(p)q(oin)o(ter)308
1065 y(comp)q(onen)o(ts)19 b(to)g(redirect)h(them,)g(rather)g(than)f
(cop)o(y)g(them.)33 b(This)19 b(can)g(yield)308 1115
y(coun)o(ter-in)o(tuitiv)o(e)14 b(b)q(eha)o(viour:)308
1227 y Fe(type\(scalar2D\))19 b(::)i(a,)h(b)308 1277
y(a)g(=)f(b)308 1327 y(b\045data)g(=)g(...)308 1439 y
Fl(This)16 b(will)e(c)o(hange)i(the)g(v)n(alues)f(of)j
Fe(a\045data)p Fl(,)d(whic)o(h)g(ma)o(y)f(run)i(against)f(exp)q(ecta-)
308 1489 y(tions.)27 b(\(Changes)18 b(to)e(the)i(RHS)f(of)f(an)h
(assignmen)o(t)f Fj(after)k Fl(the)e(assignmen)o(t)e(do)308
1539 y(not)j(a\013ect)i(the)f(LHS)g(for)f(ordinary)g(v)n(ariables\).)35
b(A)19 b(further)i(complication)c(is)308 1589 y(that)d(the)g(future)g
(revision)f(of)g(the)h(standard,)f(whic)o(h)h(p)q(ermits)f(allo)q
(catable)f(arra)o(y)308 1638 y(comp)q(onen)o(ts,)h(will)g(restore)i
(the)g(exp)q(ected)g(b)q(eha)o(viour.)300 1732 y(In)j(consideration)g
(of)f(the)h(last)f(issue,)i(w)o(e)f(o)o(v)o(erload)f(the)i(assignmen)o
(t)d(in)o(terface)225 1782 y(to)f(restore)h(the)g(exp)q(ected)h(b)q
(eha)o(viour)e(when)g(the)h(RHS)e(is)h(of)j Fe(type\(scalar2D\))p
Fl(.)11 b(W)m(e)225 1832 y(also)k(use)h(the)f(assignmen)o(t)f(in)o
(terface)i(to)f(mak)o(e)f(it)h(p)q(ossible)g(to)g(assign)g(simple)f
(arra)o(ys)225 1882 y(or)g(scalars)g(to)g(a)g(scalar)f(\014eld)h(\(e.g)
h Fe(a=0)p Fl(\):)225 1941 y Fe(interface)20 b(assignment\(=\))290
1991 y(module)h(procedure)f(copy_scalar2D_to_)o(scala)o(r2D)290
2040 y(module)h(procedure)f(assign_0D_to_scal)o(ar2D)290
2090 y(module)h(procedure)f(assign_2D_to_scal)o(ar2D)225
2140 y(end)h(interface)p 225 2183 558 2 v 225 2211 a
Fg(h)245 2223 y Fm(i.e,)11 b(ha)o(v)o(e)f(o)o(v)o(erlapping)f(memory)g
(lo)q(cations.)p 225 2371 1423 2 v 225 2433 2 62 v 239
2412 a Fj(kernels:)19 b(submitte)n(d)14 b(to)h Fp(W)l(orld)g(Scien)o
(ti\014)o(c)d Fj(on)k(27)f(May)g(2001)313 b Fp(11)p 1646
2433 V 225 2435 1423 2 v eop
%%Page: 12 12
12 11 bop 300 267 a Fl(In)11 b(all)e(v)o(ersions)i(of)f(these)i(pro)q
(cedures,)h(w)o(e)e(\014rst)g(allo)q(cate)f(space)i(for)e(the)h(LHS)g
(data)225 316 y(from)k(the)i(user)g(stac)o(k.)26 b(In)17
b(the)g(\014rst)g(instance)g(of)f(the)h(o)o(v)o(erloaded)f(assignmen)o
(t,)f(the)225 366 y(RHS)f(is)h(also)f(a)g(scalar)h(\014eld,)f(and)h
(the)g(v)n(alues)g(in)f(its)h Fe(data)e Fl(elemen)o(t)h(are)i(copied)e
(in)o(to)225 416 y(the)f(LHS)g Fe(data)p Fl(,)f(and)g(the)i(activ)o(e)e
(domain)f(on)h(the)h(RHS)g(is)f(applied)h(on)f(the)h(result.)19
b(In)225 466 y(the)13 b(other)g(t)o(w)o(o)f(instances,)i(the)f(RHS)f
(is)g(a)h(real)f(arra)o(y)g(or)h(scalar,)f(whic)o(h)h(is)f(used)h(to)g
(\014ll)225 516 y(the)h Fe(data)g Fl(elemen)o(t)f(of)g(the)i(LHS:)225
575 y Fe(type\(scalar2D\))k(::)i(a,)h(b)225 624 y(real)f(::)g(c)225
674 y(real)g(::)g(d\(:,:\))225 724 y(a)h(=)f(b)225 774
y(a)h(=)f(c)225 824 y(a)h(=)f(d)300 883 y Fl(The)c(di\013eren)o(t)h(p)q
(ossibilities)e(are)i(illustrated)e(ab)q(o)o(v)o(e.)27
b(In)17 b(the)h(assignmen)o(t)d(of)20 b Fe(b)225 932
y Fl(and)14 b Fe(d)p Fl(,)f(an)h(error)g(results)h(if)e(the)i(arra)o
(ys)f(on)g(the)g(RHS)g(do)f(not)h(conform)e(to)i Fe(a\045data)p
Fl(.)300 982 y(The)g(horizon)o(tal)f(v)o(ector)i(\014eld)f(is)g
(constructed)i(as)e(a)f(pair)h(of)f(scalar)h(\014elds:)225
1041 y Fe(type,)21 b(public)f(::)i(hvector2D)290 1091
y(type\(scalar2D\))d(::)j(x,)f(y)290 1141 y(integer)g(::)g(is,)g(ie,)g
(js,)h(je)225 1191 y(end)f(type)g(hvector2D)300 1250
y Fl(and)14 b(its)g(assignmen)o(t)e(op)q(erations)j(are)f(inherited)g
(from)e(its)i(scalar)g(comp)q(onen)o(ts:)225 1309 y Fe(subroutine)20
b(copy_hvector2D_t)o(o_hve)o(ctor2)o(D\()f(a,)i(b)h(\))269
1358 y(type\(hvector2D\))o(,)d(intent\(inout\))g(::)j(a)269
1408 y(type\(hvector2D\))o(,)d(intent\(in\))85 b(::)22
b(b)269 1458 y(a\045x)f(=)g(b\045x)269 1508 y(a\045y)g(=)g(b\045y)269
1558 y(return)225 1607 y(end)g(subroutine)f(copy_hvector2D_to)o(_hvec)o
(tor2D)225 1719 y Fj(4d)43 b(A)o(rithmetic)13 b(op)n(er)n(ators)225
1796 y Fl(Consider)h(the)h(addition)e(op)q(eration)g(applied)h(to)f
(scalar)h(\014elds:)225 1855 y Fe(type\(scalar2D\))19
b(::)i(a,)h(b,)f(c)225 1905 y(a)h(=)f(b)h(+)f(c)300 1964
y Fl(This)i(op)q(eration)g(requires)h(the)g(arithmetic)d(op)q(eration)i
Fe(a\045data)e(=)g(b\045data)g(+)225 2014 y(c\045data)p
Fl(,)f(sub)r(ject)i(to)e(limits)e(on)j(the)g(activ)o(e)f(domain.)35
b(The)21 b(activ)o(e)g(domain)d(that)225 2064 y(results)d(is)f(the)g
(in)o(tersection)h(of)e(the)i(t)o(w)o(o)e(activ)o(e)h(domains)e(on)i
(the)g(LHS:)225 2123 y Fe(interface)20 b(operator\(+\))290
2173 y(module)h(procedure)f(add_scalar2D)290 2223 y(module)h(procedure)
f(add_hvector2D)p 225 2371 1423 2 v 225 2433 2 62 v 239
2412 a Fj(kernels:)f(submitte)n(d)14 b(to)h Fp(W)l(orld)g(Scien)o
(ti\014)o(c)d Fj(on)k(27)f(May)g(2001)313 b Fp(12)p 1646
2433 V 225 2435 1423 2 v eop
%%Page: 13 13
13 12 bop 225 267 a Fe(end)21 b(interface)225 366 y(function)f
(add_scalar2D\()f(a,)j(b)f(\))269 416 y(type\(scalar2D\))d(::)k
(add_scalar2D)269 466 y(type\(scalar2D\),)c(intent\(in\))i(::)h(a,)h(b)
269 516 y(add_scalar2D\045da)o(ta)d(=>)i(work2D\(:,:,nbuf2\))e(!assign)
h(from)h(user)g(stack)269 565 y(add_scalar2D\045is)d(=)k
(max\(a\045is,b\045is\))269 615 y(add_scalar2D\045ie)c(=)k
(min\(a\045ie,b\045ie\))269 665 y(add_scalar2D\045js)c(=)k
(max\(a\045js,b\045js\))269 715 y(add_scalar2D\045je)c(=)k
(min\(a\045je,b\045je\))269 765 y(do)f(j)h(=)f(add_scalar2D\045js,ad)o
(d_sca)o(lar2D)o(\045je)334 814 y(do)g(i)h(=)g(add_scalar2D\045is)o
(,add_)o(scala)o(r2D\045i)o(e)399 864 y(add_scalar2D\045data\(i)o(,j\))
d(=)i(a\045data\(i,j\))f(+)h(b\045data\(i,j\))334 914
y(end)g(do)269 964 y(end)g(do)269 1014 y(return)225 1064
y(end)g(function)f(add_scalar2D)300 1125 y Fl(F)m(or)13
b(m)o(ultiplication,)d(one)k(of)g(the)g(m)o(ultiplicands)e(is)h(a)h
(scalar)g(or)g(2D)f(arra)o(y)m(.)300 1174 y(The)18 b(v)o(ector)f
(\014eld)h(is)e(able)h(to)g(inherit)g(its)g(arithmetic)f(op)q(erations)
i(as)f(a)g(com)o(bi-)225 1224 y(nation)d(of)h(op)q(erations)g(on)g(its)
g(comp)q(onen)o(ts,)f(just)h(as)g(w)o(as)g(done)h(for)e(the)i
(assignmen)o(t)225 1274 y(in)o(terface)e(in)g(Sec.)19
b(4c.)225 1395 y Fj(4e)43 b(R)n(otational)15 b(op)n(er)n(ators)225
1474 y Fl(The)i(computation)d(of)i(the)g(Coriolis)f(term)h(requires)h
(the)g(rotation)e(of)h(a)g(v)o(ector)h(\014eld)225 1524
y(ab)q(out)g(the)g(v)o(ertical.)27 b(W)m(e)17 b(can)g(de\014ne)h(an)e
(op)q(erator)i Fe(kcross)d Fl(whic)o(h)i(tak)o(es)g(a)g(single)225
1574 y(v)o(ector)c(\014eld)f(argumen)o(t)f(and)g(returns)j(a)e(rotated)
g(v)o(ector)h(\014eld.)k(This)12 b(is)g(v)o(ery)g(striagh)o(t-)225
1624 y(forw)o(ard)g(on)g(grid)h(stencils)g(where)h(the)f(v)o(ector)g
(comp)q(onen)o(ts)f(are)h(de\014ned)h(at)e(the)i(same)225
1674 y(p)q(oin)o(t,)c(as)h(in)f(the)g(Arak)n(a)o(w)o(a)g(A)g(and)g(B)h
(grids)916 1659 y Fi(2)935 1674 y Fl(,)f(but)h(requires)h(a)o(v)o
(eraging)d(for)h(the)h(C-grid,)225 1723 y(where)k(v)o(ector)g(comp)q
(onen)o(ts)e(are)i(not)e(collo)q(cated.)300 1773 y(The)e(function)f
Fe(kdotcurl)p Fl(,)f(taking)h(a)g(v)o(ector)i(\014eld)e(op)q(erand)h
(and)g(returning)g(the)g Fe(k)p Fl(-)225 1823 y(comp)q(onen)o(t)g(of)g
(v)o(orticit)o(y)f(as)i(a)f(scalar)g(\014eld,)h(ma)o(y)d(additionally)g
(b)q(e)k(de\014ned)f(if)f(needed.)225 1944 y Fj(4f)42
b(Di\013er)n(ential)15 b(op)n(er)n(ators)225 2023 y Fl(The)e
(di\013eren)o(tial)g(op)q(erators)h(include)f Fj(gr)n(adient)p
Fl(,)f(whic)o(h)h(tak)o(es)g(a)f(scalar)h(\014eld)g(op)q(erand)225
2073 y(and)j(returns)i(a)e(v)o(ector)i(\014eld;)f Fj(diver)n(genc)n(e)p
Fl(,)g(taking)e(a)h(v)o(ector)i(\014eld)e(op)q(erand)h(and)f(re-)225
2123 y(turning)d(a)g(scalar)h(\014eld,)f(and)g Fj(laplacian)p
Fl(,)g(de\014ned)i(for)e(b)q(oth)g(v)o(ector)h(and)f(scalar)h
(\014elds.)225 2173 y(I)j(illustrate)g(here)i(the)e(construction)i(of)d
(di\013eren)o(tial)h(op)q(erators)h(on)f(a)g(B-grid.)28
b(The)225 2223 y(B-grid)14 b(T-)f(and)h(U-cells)g(are)g(sho)o(wn)g(in)g
(Fig.)j(3:)p 225 2371 1423 2 v 225 2433 2 62 v 239 2412
a Fj(kernels:)i(submitte)n(d)14 b(to)h Fp(W)l(orld)g(Scien)o(ti\014)o
(c)d Fj(on)k(27)f(May)g(2001)313 b Fp(13)p 1646 2433
V 225 2435 1423 2 v eop
%%Page: 14 14
14 13 bop 685 225 476 2 v 685 697 2 473 v 1159 697 V
685 699 476 2 v 921 -11 V 921 461 2 473 v 1395 461 V
921 463 476 2 v 912 470 a Fk(\017)1148 234 y(\017)922
490 y Fb(T)946 496 y Fh(ij)1159 243 y Fb(u)1183 249 y
Fh(ij)547 778 y Fm(Figure)10 b(3.)17 b(T-)12 b(and)f(U-cells)g(on)g
(the)f(Arak)n(a)o(w)o(a)i(B-grid.)300 941 y Fl(The)19
b(discrete)h(represen)o(tation)h(of)d(gradien)o(t)g(and)h(div)o
(ergence)g(op)q(erators)h(using)225 991 y(forw)o(ard)13
b(di\013erences)k(on)c(the)i(B-grid)e(is:)697 1114 y
Fk(r)c(\001)g Fp(u)i Fl(=)h Fb(\016)862 1120 y Fh(x)883
1114 y Fl(\()p 899 1092 24 2 v Fb(u)923 1097 y Fh(y)943
1114 y Fl(\))d(+)h Fb(\016)1028 1120 y Fh(y)1048 1114
y Fl(\()p 1064 1092 22 2 v Fb(v)1086 1097 y Fh(x)1107
1114 y Fl(\))423 b(\(3a\))828 1182 y(\()p Fk(r)p Fb(T)6
b Fl(\))925 1188 y Fh(x)957 1182 y Fl(=)12 b Fb(\016)1019
1188 y Fh(x)1041 1182 y Fl(\()p 1057 1148 31 2 v Fb(T)1087
1155 y Fh(y)1107 1182 y Fl(\))421 b(\(3b\))829 1244 y(\()p
Fk(r)p Fb(T)6 b Fl(\))926 1250 y Fh(y)957 1244 y Fl(=)12
b Fb(\016)1019 1250 y Fh(y)1040 1244 y Fl(\()p 1056 1211
V Fb(T)1086 1218 y Fh(x)1107 1244 y Fl(\))425 b(\(3c)q(\))300
1368 y(The)14 b(co)q(de)h(for)f(the)g(gradien)o(t)g(op)q(erator)g(is)g
(sho)o(wn)g(b)q(elo)o(w:)225 1425 y Fe(function)20 b(grad\(scalar\))269
1475 y(type\(hvector2D\))e(::)k(grad)269 1525 y(type\(scalar2D\),)c
(intent\(inout\))h(::)j(scalar)269 1625 y(call)f(mpp_get_compute)o
(_doma)o(in\()e(domain,)h(is,)h(ie,)g(js,)g(je)h(\))269
1675 y(call)f(mpp_get_data_do)o(main\()d(domain,)j(isd,)g(ied,)f(jsd,)h
(jed)h(\))269 1724 y(grad\045x)e(=>)i(work2D\(:,:,nbuf)o(x\))269
1774 y(grad\045y)e(=>)i(work2D\(:,:,nbuf)o(y\))269 1824
y(if\()f(scalar\045ie.LE.ie)d(.OR.)j(scalar\045je.LE.je)e(\)then)356
1874 y(call)i(mpp_update_domai)o(ns\()e(scalar\045data,)g(domain,)h
(EAST+NORTH)g(\))356 1924 y(scalar\045ie)g(=)h(ied)356
1973 y(scalar\045je)f(=)h(jed)269 2023 y(end)g(if)269
2073 y(grad\045is)f(=)i(scalar\045is;)d(grad\045ie)i(=)g(scalar\045ie)f
(-)i(1)269 2123 y(grad\045js)e(=)i(scalar\045js;)d(grad\045je)i(=)g
(scalar\045je)f(-)i(1)269 2173 y(do)f(j)h(=)f(grad\045js,grad\045je)334
2223 y(do)g(i)h(=)g(grad\045is,grad\045ie)p 225 2371
1423 2 v 225 2433 2 62 v 239 2412 a Fj(kernels:)d(submitte)n(d)14
b(to)h Fp(W)l(orld)g(Scien)o(ti\014)o(c)d Fj(on)k(27)f(May)g(2001)313
b Fp(14)p 1646 2433 V 225 2435 1423 2 v eop
%%Page: 15 15
15 14 bop 399 267 a Fe(tmp1)21 b(=)h(scalar\045data\(i+1,j)o(+1\))d(-)i
(scalar\045data\(i,j\))399 316 y(tmp2)g(=)h(scalar\045data\(i+1,j)o(\))
d(-)j(scalar\045data\(i,j)o(+1\))399 366 y(work2D\(i,j,nbufx\))d(=)i
(gradx\(i,j\)*\()f(tmp1)g(+)i(tmp2)f(\))399 416 y(work2D\(i,j,nbufy\))e
(=)i(grady\(i,j\)*\()f(tmp1)g(-)i(tmp2)f(\))334 466 y(end)g(do)269
516 y(end)g(do)300 573 y Fl(There)15 b(are)f(certain)h(asp)q(ects)g(of)
f(this)g(co)q(de)g(fragmen)o(t)f(w)o(orth)h(highligh)o(ting:)267
659 y Fk(\017)20 b Fl(The)14 b(di\013erencing)f(on)g(the)h(B-grid)f
(requires)h(the)g(v)n(alues)e(at)h Fe(\(i+1,j+1\))e Fl(in)i(order)308
709 y(to)19 b(compute)g Fe(\(i,j\))p Fl(,)h(th)o(us)g(losing)e(one)i(p)
q(oin)o(t)f(in)g(the)h(eastern)h(and)f(northern)308 758
y(halos)d(on)h(eac)o(h)g(compute)g(cycle.)30 b(A)18 b(halo)f(up)q(date)
i(is)e(p)q(erformed)h(when)g(there)308 808 y(are)e(insu\016cien)o(t)f
(activ)o(e)g(p)q(oin)o(ts)g(a)o(v)n(ailable)e(to)j(\014ll)e(the)i
(compute)e(domain)f(of)i(the)308 858 y(resulting)f(v)o(ector)h
(\014eld.)k(W)m(e)13 b(ma)o(y)f(a)o(v)o(oid)h(up)q(dating)h(the)g(w)o
(estern)i(and)e(southern)308 908 y(halos,)f(whic)o(h)h(are)g(nev)o(er)h
(used)g(in)e(this)h(computation.)308 973 y(The)g(halo)e(size)h(m)o(ust)
f(b)q(e)i(at)f(least)g(1)g(for)g(this)g(n)o(umerical)e(k)o(ernel,)j
(but)f(can)g(b)q(e)h(set)308 1023 y(m)o(uc)o(h)i(higher)h(at)g
(initialization)d(in)i(the)i Fe(mpp_define_domain)o(s)c
Fl(call)i(\(Sec.)j(3\).)308 1073 y(F)m(or)9 b(a)h(halo)f(size)i(of)h
Fe(n)p Fl(,)e(halo)f(up)q(dates)i(are)f(required)h(only)e(once)h(ev)o
(ery)i Fe(n)d Fl(timesteps.)308 1123 y(This)h(illustrates)g(the)h
(sorts)g(of)f(parallel)f(optimizations)f(yielded)i(b)o(y)g(the)g
(construc-)308 1172 y(tion)j(of)h(mo)q(dular)e(n)o(umerical)g(k)o
(ernels.)267 1253 y Fk(\017)20 b Fl(The)d(lo)q(op)e(itself)h(has)h(a)f
(complicated)f(form,)g(particular)h(to)g(the)h(B-grid)f(stencil)308
1303 y(sho)o(wn.)22 b(Other)17 b(lo)q(op)d(optimizations)f(ma)o(y)h(b)q
(e)i(applied)f(here)h(without)f(compro-)308 1353 y(mising)f(the)j
(higher-lev)o(el)e(co)q(de.)26 b(Op)q(erators)17 b(for)f(other)h
(stencils)g(ma)o(y)d(b)q(e)j(o)o(v)o(er-)308 1403 y(loaded)h(here)i(as)
e(w)o(ell)g(under)h(the)h(generic)f(in)o(terface)g Fe(grad)p
Fl(,)f(again)g(preserving)308 1453 y(higher-lev)o(el)c(co)q(de)g
(structure.)267 1534 y Fk(\017)20 b Fl(The)12 b(halo)f(up)q(dates)i(ha)
o(v)o(e)e(b)q(een)i(illustrated)f(here)h(as)f Fj(blo)n(cking)j
Fl(calls,)c(whic)o(h)h(com-)308 1583 y(plete)g(up)q(on)f(return)h(from)
d(the)j(call.)k(F)m(or)11 b(a)g(fully)e(non-blo)q(c)o(king)h(halo)g(up)
q(date,)i(the)308 1633 y(call)j(w)o(ould)g(b)q(e)i(made)e(at)h(the)g
(end)h(of)e(a)h(compute)g(cycle,)g(and)g(the)h(usual)f(w)o(ait-)308
1683 y(for-completion)c(call)h(\(e.g)h Fe(MPI_WAIT)p
Fl(\))e(called)i(at)g(the)g(top)g(of)f(the)i(next)f(cycle.)225
1790 y Fj(4g)43 b(High-level)14 b(formulation)g(of)h(a)g(shal)r(low)g
(water)f(mo)n(del)225 1867 y Fl(Using)19 b(the)g(constructs)j(dev)o
(elop)q(ed)d(here,)i(a)e(basic)g(shallo)o(w)f(w)o(ater)h(mo)q(del)f(ma)
o(y)f(b)q(e)225 1916 y(written)d(in)g(standard)g(F)m(ortran-90)f(as)h
(follo)o(ws:)225 1973 y Fe(program)20 b(shallow_water)225
2023 y(use)h(fields)225 2073 y(type\(scalar2D\))e(::)i(eta)225
2123 y(type\(hvector2D\))e(::)i(u,)g(forcing)225 2173
y(do)g(t)h(=)g(start,end)237 b(!time)21 b(loop)247 2223
y(eta)g(=)h(eta)f(+)g(dt*\()g(-h*div\(u\))f(+)i(nu*lapl\(eta\))d(\))p
225 2371 1423 2 v 225 2433 2 62 v 239 2412 a Fj(kernels:)g(submitte)n
(d)14 b(to)h Fp(W)l(orld)g(Scien)o(ti\014)o(c)d Fj(on)k(27)f(May)g
(2001)313 b Fp(15)p 1646 2433 V 225 2435 1423 2 v eop
%%Page: 16 16
16 15 bop 247 267 a Fe(u)21 b(=)h(u)g(+)f(dt*\()g(-g*grad\(eta\))e(+)j
(f*kcross\(u\))e(+)h(nu*lapl\(u\))f(+)h(forcing)g(\))225
316 y(end)g(do)225 366 y(end)g(program)g(shallow_water)300
425 y Fl(This)10 b(co)q(de)472 410 y Fh(i)497 425 y Fl(p)q(ossesses)j
(sev)o(eral)d(of)g(the)h(features)g(w)o(e)g(seek)g(to)f(build)f(in)o
(to)h(our)g(co)q(des:)225 475 y(p)q(ortabilit)o(y)m(,)i(scalabilit)o(y)
m(,)f(ease)k(of)e(use,)h(mo)q(dularit)o(y)m(,)d(\015exibilit)o(y)h(and)
i(extensibilit)o(y:)267 570 y Fk(\017)20 b Fl(The)d(co)q(de)g(has)f(b)q
(een)i(v)n(alidated)d(on)h(Cra)o(y)g(PVP)h(and)f(MPP)h(systems,)f(SGI)g
(cc-)308 619 y(NUMA,)f(and)f(a)h(Beo)o(wulf)f(cluster)i(using)e(the)i
(PGF90)e(compiler.)19 b(On)c(the)g(Cra)o(y)308 669 y(and)g(SGI)g
(compilers,)f(the)i(abstraction)g(p)q(enalt)o(y)f(without)g(using)g(sp)
q(ecial)g(direc-)308 719 y(tiv)o(es)d(is)h(estimated)e(at)h(ab)q(out)g
(20\045.)17 b(Some)11 b(causes)j(for)e(the)g(abstraction)h(p)q(enalt)o
(y)308 769 y(are)h(noted)h(b)q(elo)o(w.)267 856 y Fk(\017)20
b Fl(F)m(or)15 b(a)g(t)o(ypical)f(mo)q(del)g(grid)h(of)g(200)p
Fk(\002)p Fl(200)f(p)q(oin)o(ts,)h(it)g(scales)h(to)f(80\045)f(on)h(64)
g(PEs)308 906 y(with)f(a)f(halo)g(size)i(of)e(1.)18 b(It)c(is)f
(memory-scaling)e(except)k(for)f(the)g(halo)f(region.)267
993 y Fk(\017)20 b Fl(The)15 b(parallel)e(calls)h(are)h(built)f(in)o
(to)g(the)h(k)o(ernels,)g(and)f(are)h(called)f(only)g(at)g(need.)308
1043 y(Both)e(blo)q(c)o(king)e(and)h(non-blo)q(c)o(king)f(halo)g(up)q
(dates)i(are)g(supp)q(orted.)18 b(In)11 b(addition,)308
1093 y(the)i(frequency)g(of)f(halo)g(up)q(dates)h(can)f(b)q(e)h
(reduced)h(on)f(a)f(high-latency)f(in)o(tercon-)308 1143
y(nect)i(at)f(the)h(cost)g(of)f(additional)e(computation,)h(merely)g(b)
o(y)h(setting)h(wider)f(halos)308 1193 y(at)i(initialization,)c(and)k
(no)g(other)g(co)q(de)h(c)o(hanges.)267 1280 y Fk(\017)20
b Fl(The)12 b(grid)f(stencils,)i(and)e(the)h(ordering)g(of)f(indices,)h
(etc.,)g(can)g(b)q(e)g(c)o(hanged)g(within)308 1330 y(the)k(k)o(ernels)
g(without)f(a\013ecting)h(the)g(calling)e(routines.)23
b(This)15 b(is)g(done)h(b)o(y)f(o)o(v)o(er-)308 1379
y(loading)9 b(k)o(ernels)j(for)e(di\013eren)o(t)i(grid)e(stencils)i
(under)g(the)f(same)f(generic)i(in)o(terface.)308 1429
y(In)g(addition)e(this)i(w)o(ould)f(p)q(ermit)g(the)i(use)f(of)g
(di\013eren)o(t)g(grid)g(stencils)g(in)g(di\013eren)o(t)308
1479 y(parts)h(of)f(the)i(co)q(de.)k(Ho)o(w)o(ev)o(er,)13
b(there)h(are)g(some)d(basic)i(limits)e(to)h(this)h(\015exibilit)o(y)m
(,)308 1529 y(noted)h(b)q(elo)o(w.)300 1623 y(Some)20
b(di\016culties)g(with)g(this)h(approac)o(h)g(ma)o(y)e(also)h(b)q(e)h
(noted.)40 b(One)21 b(is)g(that)225 1673 y(arithmetic)13
b(op)q(erators)j(constructed)h(as)d(sho)o(wn)h(here)h(do)e(not)h(p)q
(erform)e(certain)i(opti-)225 1723 y(mizations)f(that)h(w)o(ould)g(b)q
(e)h(done)f(for)g(equiv)n(alen)o(t)g(arra)o(y)g(op)q(erations,)h
(illustrated)f(b)o(y)225 1773 y(these)g(examples:)225
1832 y Fe(a)22 b(=)f(a)h(+)f(b)225 1882 y(a)h(=)f(b)h(+)f(c)h(+)g(d)300
1941 y Fl(In)15 b(the)g(\014rst)g(example,)e(one)i(memory)d(stream)i
(ma)o(y)e(b)q(e)j(sa)o(v)o(ed)g(b)o(y)f(kno)o(wing)g(that)225
1991 y(the)21 b(LHS)f(arra)o(y)g(also)g(app)q(ears)h(on)f(the)h(RHS.)e
(Since)i(a)f(function)g(call)g(is)g(used)h(to)225 2041
y(p)q(erform)16 b(the)i(addition)d(here,)k(an)d(extra)i(memory)c
(stream)j(is)f(used.)28 b(In)17 b(the)h(second)225 2090
y(example,)10 b(the)h(lo)q(op)g(construct)h(w)o(ould)f(c)o(hain)f(the)i
(t)o(w)o(o)e(additions)h(together)h(in)e(a)h(single)225
2140 y(lo)q(op.)16 b(Here)c(the)e(functions)h(are)f(called)g(pairwise.)
17 b(While)9 b(it)h(is)g(p)q(ossible)h(in)f(principle)g(to)p
225 2183 558 2 v 225 2211 a Fg(i)238 2223 y Fm(Av)n(ailable)g(for)h(do)
o(wnload)f(from)g(h)o(ttp://www.gfdl.noaa)o(.go)n(v/~)o(vb)o(/k)o(e)o
(rne)o(ls.h)o(t)o(ml)p 225 2371 1423 2 v 225 2433 2 62
v 239 2412 a Fj(kernels:)19 b(submitte)n(d)14 b(to)h
Fp(W)l(orld)g(Scien)o(ti\014)o(c)d Fj(on)k(27)f(May)g(2001)313
b Fp(16)p 1646 2433 V 225 2435 1423 2 v eop
%%Page: 17 17
17 16 bop 225 267 a Fl(c)o(hain)13 b(function)h(calls,)e(it)i(is)f
(unlik)o(ely)g(that)g(an)o(y)g(compiler)g(in)g(practice)h(p)q(erforms)g
(this)225 316 y(lev)o(el)j(of)g(in)o(terpro)q(cedural)i(analysis.)28
b(These)19 b(are)f(con)o(tributors)g(to)f(the)h(abstraction)225
366 y(p)q(enalt)o(y)c(noted)g(ab)q(o)o(v)o(e.)300 416
y(A)j(second)g(limitation)c(of)j(this)h(approac)o(h)g(a\013ects)h(the)f
(\015exibilit)o(y)e(in)h(the)h(c)o(hoice)225 466 y(of)e(grid)g(stencil)
h(for)f(a)g(giv)o(en)g(high-lev)o(el)g(casting)g(of)g(the)h(equations.)
23 b(This)15 b(is)h(due)g(to)225 516 y(the)i(fact)e(that)h(the)h(time)e
(discretization)h(m)o(ust)f(b)q(e)h(explicitly)f(main)o(tained)f(in)i
(high-)225 565 y(lev)o(el)d(co)q(de)h(while)f(w)o(e)g(seek)i(to)e
(construct)i(n)o(umerical)d(k)o(ernels)i(for)f(spatial)f(op)q(erators.)
225 615 y(This)f(is)g(b)q(est)i(illustrated)e(b)o(y)g(mo)q(difying)d
(Eq.)j(2)g(to)g(use)i(an)e(implicit)d(treatmen)o(t)j(of)g(the)225
665 y(Coriolis)h(force:)445 784 y Fb(\021)467 767 y Fh(n)p
Fi(+1)541 784 y Fk(\000)d Fb(\021)605 767 y Fh(n)p 445
802 183 2 v 511 840 a Fl(\001)p Fb(t)645 812 y Fl(=)i
Fk(\000)p Fb(H)s Fl(\()p Fk(r)e(\001)e Fp(u)p Fl(\))883
795 y Fh(n)1546 812 y Fl(\(4a\))436 893 y Fp(u)463 876
y Fh(n)p Fi(+1)537 893 y Fk(\000)h Fp(u)605 876 y Fh(n)p
436 911 191 2 v 507 949 a Fl(\001)p Fb(t)645 921 y Fl(=)j
Fk(\000)p Fb(g)q Fl(\()p Fk(r)p Fb(\021)q Fl(\))831 904
y Fh(n)p Fi(+1)906 921 y Fl(+)d Fb(f)t Fp(k)i Fk(\002)1048
862 y Fa(\022)1084 893 y Fp(u)1111 876 y Fh(n)p Fi(+1)1184
893 y Fl(+)e Fp(u)1252 876 y Fh(n)p 1084 911 V 1169 949
a Fl(2)1280 862 y Fa(\023)1319 921 y Fl(+)h Fp(F)1391
904 y Fh(n)1544 921 y Fl(\(4b\))300 1049 y(Using)j(a)g(grid)g(stencil)h
(where)g(v)o(ector)g(comp)q(onen)o(ts)f(are)h(collo)q(cated,)f(it)g(is)
g(easy)h(to)225 1099 y(rearrange)d(terms)f(in)g(the)h
Fp(u)f Fl(equation)g(to)g(bring)g Fp(u)1013 1084 y Fh(n)p
Fi(+1)1088 1099 y Fl(to)g(the)h(LHS.)f(The)h(timestepping)225
1149 y(for)j Fp(u)f Fl(then)h(tak)o(es)h(place)f(in)f(t)o(w)o(o)h
(steps:)225 1208 y Fe(f2)21 b(=)h(f/2)225 1258 y(u)g(=)f(u)h(+)f(dt*\()
g(-g*grad\(eta\))f(+)h(f2*kcross\(u\))f(+)h(nu*lapl\(u\))f(+)h(forcing)
g(\))225 1308 y(u)h(=)f(\()h(u)f(+)h(dt*f2*kcross\(u\))d(\)/\()i(1)g(+)
h(f2**2)f(\))300 1367 y Fl(Ho)o(w)o(ev)o(er,)12 b(on)f(a)g(C-grid,)g
(since)h(the)g(v)o(ector)g(comp)q(onen)o(ts)g(are)f(not)h(collo)q
(cated,)f(the)225 1416 y(implicit)f(Coriolis)i(term)g(requires)i(a)f
(matrix)e(in)o(v)o(ersion)1110 1401 y Fi(7)1128 1416
y Fl(.)17 b(P)o(articularly)12 b(v)o(exing)h(in)f(the)225
1466 y(curren)o(t)18 b(con)o(text)f(is)f(that)g(the)h(high-lev)o(el)e
(structure)j(of)e(the)h(equations)f(dep)q(ends)i(on)225
1516 y(the)e(spatial)f(grid)g(stencil.)24 b(The)17 b(high-lev)o(el)d
(form)g(of)h(the)i(equations)e(ma)o(y)f(not)i(in)f(all)225
1566 y(instances)g(b)q(e)g(able)e(to)h(b)q(e)g(made)f(indep)q(enden)o
(t)i(of)f(the)g(grid)g(n)o(umerics.)225 1682 y Fp(5)48
b(Discussion)225 1774 y Fl(Earth)19 b(systems)f(mo)q(dels)f(are)i(run)f
(o)o(v)o(er)h(a)f(wide)g(range)g(of)g(time)f(and)h(space)h(scales,)225
1824 y(in)g(man)o(y)e(con\014gurations,)j(serving)f(a)g(wide)g(v)n
(ariet)o(y)f(of)h(needs,)i(while)d(sharing)h(the)225
1874 y(same)11 b(underlying)g(Na)o(vier-Stok)o(es)h(dynamics)f(applied)
g(to)g(complex)g(\015uids.)17 b(As)12 b(mo)q(del)225
1924 y(complexit)o(y)i(gro)o(ws,)j(the)f(need)h(for)f(a)g(\015exible,)g
(mo)q(dular)f(and)h(extensible)h(high-lev)o(el)225 1973
y(structure)i(to)e(supp)q(ort)h(a)f(distributed)h(soft)o(w)o(are)f(dev)
o(elopmen)o(t)f(mo)q(del)g(has)h(b)q(ecome)225 2023 y(apparen)o(t.)300
2073 y(First)d(attempts)g(at)g(standardization)g(for)g(parallel)f
(computing)f(arc)o(hitecture)k(re-)225 2123 y(sulted)11
b(in)g(standards)g(for)g(lo)o(w-lev)o(el)e(comm)o(unication)f(APIs)j
(\(MPI,)g(Op)q(enMP\).)g(These)225 2173 y(ha)o(v)o(e)23
b(the)g(disadv)n(an)o(tage)g(of)f(implying)e(a)j(particular)f(kind)h
(of)f(underlying)h(hard-)225 2223 y(w)o(are)14 b(\(distributed)h(or)f
(shared)h(memory\))c(and)j(add)g(greatly)f(to)h(co)q(de)h(complexit)o
(y)d(for)p 225 2371 1423 2 v 225 2433 2 62 v 239 2412
a Fj(kernels:)19 b(submitte)n(d)14 b(to)h Fp(W)l(orld)g(Scien)o(ti\014)
o(c)d Fj(on)k(27)f(May)g(2001)313 b Fp(17)p 1646 2433
V 225 2435 1423 2 v eop
%%Page: 18 18
18 17 bop 225 267 a Fl(p)q(ortable)12 b(soft)o(w)o(are)g(that)h
(attempts)e(to)h(encompass)g(m)o(ultiple)e(parallelism)g(seman)o(tics.)
300 316 y(E\013orts)k(are)g(curren)o(tly)g(underw)o(a)o(y)g(to)f
(create)i(a)e(soft)o(w)o(are)g(infrastructure)i(for)e(the)225
366 y(climate)h(mo)q(deling)g(comm)o(unit)o(y)f(that)j(meets)g(these)i
(needs)f(with)f(high-p)q(erformance)225 416 y(co)q(de)c(running)f(on)g
(a)g(wide)g(v)n(ariet)o(y)f(of)h(parallel)f(computing)g(arc)o
(hitectures,)j(concealing)225 466 y(the)g(comm)o(unication)d(APIs)j
(from)e(high-lev)o(el)h(co)q(de.)19 b(A)12 b(protot)o(yp)q(e)i(for)e
(this)h(w)o(ould)f(b)q(e)225 516 y(the)i(domain)e(class)i(library)g
(describ)q(ed)h(in)f(Sec.)19 b(3)o(.)300 565 y(The)f(class)f(library)g
(approac)o(h)g(is)g(a)g(p)q(o)o(w)o(erful)g(means)f(of)h(encapsulating)
g(mo)q(del)225 615 y(structure)h(in)d(an)g(in)o(tuitiv)o(e)g(manner,)f
(so)i(that)g(the)g(data)f(structures)j(b)q(eing)e(used)g(are)225
665 y(ob)r(jects)e(conceptually)g(close)g(to)f(the)g(en)o(tities)h(b)q
(eing)f(mo)q(deled.)k(In)c(this)h(pap)q(er)g(I)f(ha)o(v)o(e)225
715 y(demonstrated)19 b(the)h(extension)f(of)g(this)g(approac)o(h)g(to)
g(create)h(a)f(class)h(of)e(mo)q(dular,)225 765 y(con\014gurable)h
(parallel)f(n)o(umerical)f(k)o(ernels)j(using)f(F)m(ortran-90)f
(suitable)h(for)f(use)i(in)225 814 y(earth)14 b(systems)f(mo)q(dels.)k
(The)d(language)e(o\013ers)j(a)e(reasonable)g(compromise)e(b)q(et)o(w)o
(een)225 864 y(high-p)q(erformance)j(n)o(umerical)f(k)o(ernels)i(and)g
(the)g(high-lev)o(el)f(structure)i(required)g(for)225
914 y(a)e(distributed)g(dev)o(elopmen)o(t)f(mo)q(del.)k(This)d(approac)
o(h)g(is)g(b)q(eing)g(exp)q(erimen)o(tally)e(ap-)225
964 y(plied)h(to)f(pro)q(duction)h(mo)q(dels,)f(particularly)g(in)h
(high-latency)f(co)q(de)i(segmen)o(ts)f(where)225 1014
y(con\014gurable)i(halos)f(could)h(yield)f(p)q(erformance)h(enhancemen)
o(ts.)21 b(It)15 b(could)g(yield)f(ad-)225 1064 y(ditional)j(adv)n(an)o
(tages)i(in)f(mo)q(dels)g(where)i(w)o(e)g(ma)o(y)d(need)j(to)e(c)o(ho)q
(ose)i(di\013eren)o(t)g(grid)225 1113 y(stencils)15 b(for)e(di\013eren)
o(t)i(researc)o(h)h(problems)d(using)g(the)i(same)e(mo)q(del)f(co)q
(de.)300 1163 y(The)21 b(parallel)e(n)o(umerical)g(k)o(ernels)i(dev)o
(elop)q(ed)g(here)h(ha)o(v)o(e)e(b)q(een)i(v)n(alidated)d(on)225
1213 y(a)h(small)d(subset)22 b(of)d(curren)o(t)j(compilers)d(and)g(arc)
o(hitectures.)39 b(As)20 b(they)h(use)g(man)o(y)225 1263
y(adv)n(anced)10 b(language)f(features,)i(it)e(is)h(lik)o(ely)e(that)i
(p)q(erformance)f(on)h(di\013eren)o(t)h(platforms)225
1313 y(will)18 b(b)q(e)j(unev)o(en.)36 b(This)20 b(is)f(something)g
(that)h(the)g(dev)o(elop)q(ers)h(of)e(shared)i(soft)o(w)o(are)225
1362 y(infrastructure)12 b(will)d(ha)o(v)o(e)h(to)g(come)f(to)h(terms)g
(with.)17 b(A)10 b(k)o(ey)h(recommendation)d(\015o)o(wing)225
1412 y(from)17 b(the)j(conclusions)f(of)g(this)g(pap)q(er)h(w)o(ould)e
(b)q(e)i(an)e(earnest)j(e\013ort)f(on)e(our)i(part)225
1462 y(to)14 b(in)o(v)o(olv)o(e)f(the)h(compiler)f(and)h(language)f
(standards)i(comm)o(uniti)o(es)d(in)i(these)h(e\013orts.)225
1512 y(This)10 b(in)o(v)o(olv)o(es)f(closer)h(partnership,)h(rather)g
(than)f(an)f(an)o(tagonistic)g(relationship,)h(with)225
1562 y(the)16 b(scalable)g(computing)e(industry)m(,)i(and)f
(participation)g(of)g(our)h(comm)o(unit)o(y)d(in)i(the)225
1611 y(ev)o(olution)e(of)g(language)g(standards.)225
1732 y Fp(Ac)o(kno)o(wledgmen)o(ts)225 1824 y Fl(This)h(w)o(ork)f(is)g
(a)h(part)f(of)g(the)i(researc)o(h)g(and)f(dev)o(elopmen)o(t)e
(undertak)o(en)j(b)o(y)e(the)i(FMS)225 1874 y(Dev)o(elopmen)o(t)i(T)m
(eam)f(at)i(NO)o(AA/GFDL)g(to)g(build)f(a)g(soft)o(w)o(are)i
(infrastructure)g(for)225 1924 y(mo)q(deling.)300 1973
y(Bill)c(Long)g(of)g(Cra)o(y)g(Inc.)24 b(pro)o(vided)15
b(v)n(aluable)g(assistance)i(and)e(advice)h(in)f(eluci-)225
2023 y(dating)g(issues)i(of)e(F90)g(standard)h(compliance,)f(implem)o
(en)o(tation)e(and)i(optimization)225 2073 y(in)e(an)h(actual)g
(compiler)e(\(CF90\).)300 2123 y(Thanks)17 b(to)g(Je\013)h(Anderson,)g
(Ron)f(P)o(acano)o(wski)f(and)h(Bob)g(Hallb)q(erg)g(of)f(GFDL)225
2173 y(for)d(close)h(examination)e(and)h(critique)h(of)f(this)h(w)o
(ork)f(at)h(eac)o(h)g(stage)g(of)f(dev)o(elopmen)o(t,)225
2223 y(including)g(the)h(\014nal)g(man)o(uscript.)p 225
2371 1423 2 v 225 2433 2 62 v 239 2412 a Fj(kernels:)19
b(submitte)n(d)14 b(to)h Fp(W)l(orld)g(Scien)o(ti\014)o(c)d
Fj(on)k(27)f(May)g(2001)313 b Fp(18)p 1646 2433 V 225
2435 1423 2 v eop
%%Page: 19 19
19 18 bop 225 267 a Fp(References)255 357 y Fl(1.)20
b(Mic)o(hael)15 b(Metcalf)g(and)f(John)h(Reid.)21 b Fj(F)m(ortr)n(an)16
b(90/95)g(Explaine)n(d)p Fl(.)22 b(Oxford)15 b(Uni-)308
407 y(v)o(ersit)o(y)f(Press,)h(2nd)f(edition,)f(1999.)255
457 y(2.)20 b(A.)15 b(Arak)n(a)o(w)o(a.)22 b(Computational)13
b(design)i(for)h(long-term)d(n)o(umerical)h(in)o(tegration)308
507 y(of)19 b(the)g(equations)h(of)e(atmospheric)h(motion.)32
b Fj(J.)19 b(Comp.)33 b(Phys.)p Fl(,)21 b(1:119{143,)308
557 y(1966.)255 606 y(3.)f(Ross)11 b(J.)g(Murra)o(y)m(.)16
b(Explicit)11 b(generation)g(of)f(orthogonal)g(grids)g(for)h(o)q(cean)g
(mo)q(dels.)308 656 y Fj(J.)j(Comp.)19 b(Phys.)p Fl(,)14
b(126:251)e({)h(273,)g(1996.)255 706 y(4.)20 b(M.)14
b(Rancic,)f(R.J.)g(Purser,)j(and)e(F.)f(Mesinger.)20
b(A)14 b(global)f(shallo)o(w-w)o(ater)g(mo)q(del)308
756 y(using)k(an)g(expanded)h(spherical)g(cub)q(e:)26
b(Gnomonic)14 b(v)o(ersus)19 b(conformal)c(co)q(ordi-)308
806 y(nates.)k Fj(Quart.)f(J.)d(R)n(oy.)k(Mete)n(or.)g(So)n(c.)p
Fl(,)13 b(122:959)f({)i(982,)e(1996.)255 856 y(5.)20
b(G.)15 b(J.)g(Haltiner)g(and)h(R.)e(T.)i(William)o(s.)k
Fj(Numeric)n(al)c(Pr)n(e)n(diction)g(and)h(Dynamic)308
905 y(Mete)n(or)n(olo)n(gy)p Fl(.)h(John)c(Wiley)f(and)h(Sons,)f(New)i
(Y)m(ork,)e(1980.)255 955 y(6.)20 b(Stephen)12 b(M.)f(Gri\016es,)g
(Ronald)f(C.)g(P)o(acano)o(wski,)h(Martin)g(Sc)o(hmidt,)f(and)h(V.)f
(Bal-)308 1005 y(a)r(ji.)42 b(T)m(racer)23 b(conserv)n(ation)f(with)g
(an)g(explicit)g(free)h(surface)g(metho)q(d)f(for)f(z-)308
1055 y(co)q(ordinate)14 b(o)q(cean)h(mo)q(dels.)i Fj(MWR)p
Fl(,)d(129:1081{1098,)c(2001.)255 1105 y(7.)20 b(D.E.)g(Dietric)o(h,)i
(M.G.)d(Marietta,)j(and)f(P)m(.J.)e(Roac)o(he.)39 b(An)21
b(o)q(cean)g(mo)q(deling)308 1154 y(system)10 b(with)f(turbulen)o(t)h
(b)q(oundary)g(la)o(y)o(ers)g(and)f(top)q(ograph)o(y)m(,)h(part)g(1:)15
b(n)o(umerical)308 1204 y(description.)k Fj(Int.)g(J.)14
b(Numer.)19 b(Metho)n(ds)c(Fluids)p Fl(,)e(7:833{855,)e(1987.)p
225 2371 1423 2 v 225 2433 2 62 v 239 2412 a Fj(kernels:)19
b(submitte)n(d)14 b(to)h Fp(W)l(orld)g(Scien)o(ti\014)o(c)d
Fj(on)k(27)f(May)g(2001)313 b Fp(19)p 1646 2433 V 225
2435 1423 2 v eop
%%Trailer
end
userdict /end-hook known{end-hook}if
%%EOF
