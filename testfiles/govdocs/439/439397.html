<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>loon: MadMKAnalysis class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.5 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>MadMKAnalysis Class Reference</h1><code>#include &lt;<a class="el" href="MadMKAnalysis_8h-source.html">MadMKAnalysis.h</a>&gt;</code>
<p>
<p>Inheritance diagram for MadMKAnalysis:
<p><center><img src="classMadMKAnalysis.png" usemap="#MadMKAnalysis_map" border="0" alt=""></center>
<map name="MadMKAnalysis_map">
<area href="classMadAnalysis.html" alt="MadAnalysis" shape="rect" coords="0,112,104,136">
<area href="classMadQuantities.html" alt="MadQuantities" shape="rect" coords="0,56,104,80">
<area href="classMadBase.html" alt="MadBase" shape="rect" coords="0,0,104,24">
</map>
<a href="classMadMKAnalysis-members.html">List of all members.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#a0">CreatePAN</a> (std::string s, const char *bmonpath="")</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#a1">MadMKAnalysis</a> (TChain *chainSR=0, TChain *chainMC=0, TChain *chainTH=0, TChain *chainEM=0)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#a2">MadMKAnalysis</a> (<a class="el" href="classJobC.html">JobC</a> *, string, int)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>virtual&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#a3">~MadMKAnalysis</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>Float_t&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#a4">ClosestPointToLine</a> (const Float_t &amp;x1, const Float_t &amp;y1, const Float_t &amp;x2, const Float_t &amp;y2, const Float_t &amp;xpt, const Float_t &amp;ypt, Float_t &amp;x, Float_t &amp;y)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#a5">ForceMCBeam</a> (const <a class="el" href="namespaceBeamType.html#a0">BeamType::BeamType_t</a> &amp;beam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>const <a class="el" href="namespaceBeamType.html#a0">BeamType::BeamType_t</a> &amp;&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#a6">GetForcedMCBeam</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#a7">SetDataUseMCBeam</a> (bool x)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#a8">OnlyWriteFidEvents</a> (bool x)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#a9">FillMCHists</a> (TFile *fout)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#a10">DoInukeReweight</a> (bool t)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#a11">SetNRandomSets</a> (int i)</td></tr>

<tr><td colspan=2><br><h2>Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>Bool_t&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#e0">PittInFidVol</a> (Float_t x, Float_t y, Float_t z, Float_t u, Float_t v)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>Int_t&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#e1">PittTrkContained</a> (Float_t x, Float_t y, Float_t z, Float_t u, Float_t v)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>Int_t&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#e2">InPartialRegion</a> (UShort_t plane, UShort_t strip)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>Int_t&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#e3">NDRadialFidVol</a> (Float_t x, Float_t y, Float_t z)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#e4">FarTrkContained</a> (Float_t x, Float_t y, Float_t z)</td></tr>

<tr><td colspan=2><br><h2>Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="classMadNsID.html">MadNsID</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#o0">nsid</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="classMadDpID.html">MadDpID</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#o1">dpid</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="classMadQEID.html">MadQEID</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#o2">qeid</a></td></tr>

<tr><td colspan=2><br><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#b0">SigInOut</a> (Float_t &amp;sigfull, Float_t &amp;sigpart, Float_t &amp;trkfull, Float_t &amp;trkpart)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#b1">SigInOut</a> (Int_t trkidx, Float_t &amp;sigfull, Float_t &amp;sigpart, Float_t &amp;trkfull, Float_t &amp;trkpart)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>Float_t&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#b2">RecoShwEnergy</a> (int ishw, const <a class="el" href="classDetector.html#w0">Detector::Detector_t</a> &amp;det, int mode=1, bool isdata=true)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>Float_t&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#b3">RecoMKMuEnergy</a> (Int_t &amp;opt, Int_t itrk, bool isdata=true, <a class="el" href="classDetector.html#w0">Detector::Detector_t</a> det=Detector::kNear)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>virtual Float_t&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#b4">RecoMuDCosNeuND</a> (Int_t itr=0, Float_t *vtx=0)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>virtual Float_t&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#b5">RecoMuDCosNeuFD</a> (Int_t itr=0, Float_t *vtx=0)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>virtual bool&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#b6">InFidVol</a> (Int_t evidx)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>virtual bool&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#b7">InFidVol</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>bool&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#b8">InFidVol</a> (float vx, float vy, float vx)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#b9">SetBECFile</a> (const char *f)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="classRegistry.html">Registry</a> &amp;&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#b10">GetBECRegistry</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>Int_t&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#b11">NPlanesInObj</a> (TObject *rec, TObject *obj, float phcut, float &amp;sumph)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>Int_t&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#b12">NStripsInObj</a> (TObject *rec, TObject *obj, float phcut, float &amp;sumph)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#b13">GetEvtTimeChar</a> (double &amp;timemin, double &amp;timemax, double &amp;timeln)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#b14">GetEvtTimeCharPHC</a> (double &amp;timemin, double &amp;timemax, double &amp;timeln)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>float&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#b15">MuonShowerEnergy</a> (const <a class="el" href="classNtpSREvent.html">NtpSREvent</a> *evt, const <a class="el" href="classNtpSRTrack.html">NtpSRTrack</a> *trk)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#b16">EarlyActivity</a> (int evidx, float &amp;earlywph, float &amp;earlywphpw, float &amp;earlywphsphere, float &amp;ph1000, float &amp;ph500, float &amp;ph100, float &amp;lateph1000, float &amp;lateph500, float &amp;lateph100, float &amp;lateph50)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#b17">DupRecoStrips</a> (int evidx, int &amp;nduprs, float &amp;dupphrs)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>float&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#b18">ComputeLowPHRatio</a> ()</td></tr>

<tr><td colspan=2><br><h2>Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="classRegistry.html">Registry</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#r0">fBECConfig</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="namespaceBeamType.html#a0">BeamType::BeamType_t</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#r1">fMCBeam</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>bool&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#r2">fDataUseMCBeam</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>bool&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#r3">fDoInukeReweight</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>bool&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#r4">fOnlyWriteFidEvents</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#r5">fNRandomSets</a></td></tr>

<tr><td colspan=2><br><h2>Static Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>const Float_t&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#v0">kVetoEndZ</a> = 1.2154</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>const Float_t&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#v1">kTargEndZ</a> = 3.5914</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>const Float_t&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#v2">kCalorEndZ</a> = 7.1554</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>const Float_t&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#v3">kHalfCalorEndZ</a> = <a class="el" href="classMadMKAnalysis.html#v1">kTargEndZ</a>+(<a class="el" href="classMadMKAnalysis.html#v2">kCalorEndZ</a>-<a class="el" href="classMadMKAnalysis.html#v1">kTargEndZ</a>)*0.5</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>const Float_t&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#v4">kSpecEndZ</a> = 16.656</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>const Float_t&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#v5">kXcenter</a> = 1.4885</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>const Float_t&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#v6">kYcenter</a> = 0.1397</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>const Double_t&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#v7">fEarlyActivityWindowSize</a> = 10.</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>const Double_t&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#v8">fPMTTimeConstant</a> = 700.</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>const Int_t&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#v9">fNPlaneEarlyAct</a> = 30</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>const Double_t&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classMadMKAnalysis.html#v10">fEarlyPlaneSphere</a> = 0.5</td></tr>

</table>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="a1" doxytag="MadMKAnalysis::MadMKAnalysis" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> MadMKAnalysis::MadMKAnalysis </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">TChain *&nbsp;</td>
          <td class="mdname" nowrap> <em>chainSR</em> = 0, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>TChain *&nbsp;</td>
          <td class="mdname" nowrap> <em>chainMC</em> = 0, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>TChain *&nbsp;</td>
          <td class="mdname" nowrap> <em>chainTH</em> = 0, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>TChain *&nbsp;</td>
          <td class="mdname" nowrap> <em>chainEM</em> = 0</td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8cxx-source.html#l00192">192</a> of file <a class="el" href="MadMKAnalysis_8cxx-source.html">MadMKAnalysis.cxx</a>.
<p>
References <a class="el" href="MadBase_8cxx-source.html#l00201">MadBase::Clear()</a>, <a class="el" href="MadMKAnalysis_8h-source.html#l00226">fBECConfig</a>, <a class="el" href="MadMKAnalysis_8h-source.html#l00228">fDataUseMCBeam</a>, <a class="el" href="MadMKAnalysis_8h-source.html#l00229">fDoInukeReweight</a>, <a class="el" href="MadMKAnalysis_8h-source.html#l00227">fMCBeam</a>, <a class="el" href="MadMKAnalysis_8h-source.html#l00231">fNRandomSets</a>, <a class="el" href="MadMKAnalysis_8h-source.html#l00230">fOnlyWriteFidEvents</a>, and <a class="el" href="classRegistry.html#a37">Registry::Set()</a>.
<p>
<div class="fragment"><pre>00194   : <a class="code" href="classMadAnalysis.html#a0">MadAnalysis</a>(chainSR, chainMC, chainTH, chainEM)
00195 {
00196   <a class="code" href="classMadMKAnalysis.html#r1">fMCBeam</a>=BeamType::kUnknown;
00197   <a class="code" href="classMadMKAnalysis.html#r2">fDataUseMCBeam</a>=<span class="keyword">false</span>;
00198   <a class="code" href="classMadMKAnalysis.html#r3">fDoInukeReweight</a>=<span class="keyword">false</span>;
00199   <a class="code" href="classMadMKAnalysis.html#r5">fNRandomSets</a>=0;
00200   <a class="code" href="classMadMKAnalysis.html#r4">fOnlyWriteFidEvents</a>=<span class="keyword">false</span>;
00201   <span class="keywordflow">if</span>(!chainSR) {
00202     <a class="code" href="classMadBase.html#p7">record</a> = 0;
00203     <a class="code" href="classMadBase.html#p29">emrecord</a> = 0;
00204     <a class="code" href="classMadBase.html#p20">mcrecord</a> = 0;
00205     <a class="code" href="classMadBase.html#p24">threcord</a> = 0;
00206     <a class="code" href="classMadBase.html#a6">Clear</a>();
00207     <a class="code" href="classMadBase.html#p5">whichSource</a> = -1;
00208     <a class="code" href="classMadBase.html#p32">isMC</a> = <span class="keyword">true</span>;
00209     <a class="code" href="classMadBase.html#p33">isTH</a> = <span class="keyword">true</span>;
00210     <a class="code" href="classMadBase.html#p34">isEM</a> = <span class="keyword">true</span>;
00211     <a class="code" href="classMadBase.html#p36">Nentries</a> = -1;
00212     <span class="keywordflow">return</span>;
00213   }
00214   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* default_bec_file=<span class="stringliteral">"/afs/fnal.gov/files/data/minos/d04/kordosky/bec_files/pbeams_0.5_gnumi_v16.root"</span>;
00215   <a class="code" href="classMadMKAnalysis.html#r0">fBECConfig</a>.<a class="code" href="classRegistry.html#a37">Set</a>(<span class="stringliteral">"beam:flux_file"</span>,default_bec_file);
00216   <a class="code" href="classMadMKAnalysis.html#r0">fBECConfig</a>.<a class="code" href="classRegistry.html#a37">Set</a>(<span class="stringliteral">"beam:beam_type"</span>,BeamType::kLE);
00217   <a class="code" href="classMadMKAnalysis.html#r0">fBECConfig</a>.<a class="code" href="classRegistry.html#a37">Set</a>(<span class="stringliteral">"beam:detector"</span>,Detector::kNear);
00218   <a class="code" href="classMadMKAnalysis.html#r0">fBECConfig</a>.<a class="code" href="classRegistry.html#a37">Set</a>(<span class="stringliteral">"beam:low_energy_limit"</span>,0.5);
00219   <a class="code" href="classMadMKAnalysis.html#r0">fBECConfig</a>.<a class="code" href="classRegistry.html#a37">Set</a>(<span class="stringliteral">"beam:high_energy_limit"</span>,60.0);
00220 
00221   
00222   <span class="comment">//  InitChain(chainSR,chainMC,chainTH,chainEM);</span>
00223   <a class="code" href="classMadBase.html#p5">whichSource</a> = 0;  
00224 
00225 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="MadMKAnalysis::MadMKAnalysis" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> MadMKAnalysis::MadMKAnalysis </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classJobC.html">JobC</a> *&nbsp;</td>
          <td class="mdname" nowrap>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>string&nbsp;</td>
          <td class="mdname" nowrap>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8cxx-source.html#l00228">228</a> of file <a class="el" href="MadMKAnalysis_8cxx-source.html">MadMKAnalysis.cxx</a>.
<p>
References <a class="el" href="MadBase_8cxx-source.html#l00201">MadBase::Clear()</a>, <a class="el" href="MadMKAnalysis_8h-source.html#l00226">fBECConfig</a>, <a class="el" href="MadMKAnalysis_8h-source.html#l00228">fDataUseMCBeam</a>, <a class="el" href="MadMKAnalysis_8h-source.html#l00229">fDoInukeReweight</a>, <a class="el" href="MadMKAnalysis_8h-source.html#l00227">fMCBeam</a>, <a class="el" href="MadMKAnalysis_8h-source.html#l00231">fNRandomSets</a>, <a class="el" href="MadMKAnalysis_8h-source.html#l00230">fOnlyWriteFidEvents</a>, and <a class="el" href="classRegistry.html#a37">Registry::Set()</a>.
<p>
<div class="fragment"><pre>00228                                                             : <a class="code" href="classMadAnalysis.html#a0">MadAnalysis</a>(j, path, entries)
00229 {
00230   <a class="code" href="classMadMKAnalysis.html#r1">fMCBeam</a>=BeamType::kUnknown;
00231   <a class="code" href="classMadMKAnalysis.html#r2">fDataUseMCBeam</a>=<span class="keyword">false</span>;
00232   <a class="code" href="classMadMKAnalysis.html#r3">fDoInukeReweight</a>=<span class="keyword">false</span>;
00233   <a class="code" href="classMadMKAnalysis.html#r5">fNRandomSets</a>=0;
00234   <a class="code" href="classMadMKAnalysis.html#r4">fOnlyWriteFidEvents</a>=<span class="keyword">false</span>;
00235   <a class="code" href="classMadBase.html#p7">record</a> = 0;
00236   <a class="code" href="classMadBase.html#p29">emrecord</a> = 0;
00237   <a class="code" href="classMadBase.html#p20">mcrecord</a> = 0;
00238   <a class="code" href="classMadBase.html#p24">threcord</a> = 0;
00239   <a class="code" href="classMadBase.html#a6">Clear</a>();
00240   <a class="code" href="classMadBase.html#p32">isMC</a> = <span class="keyword">true</span>;
00241   <a class="code" href="classMadBase.html#p33">isTH</a> = <span class="keyword">true</span>;
00242   <a class="code" href="classMadBase.html#p34">isEM</a> = <span class="keyword">true</span>;
00243   <a class="code" href="classMadBase.html#p36">Nentries</a> = entries;
00244   <a class="code" href="classMadBase.html#p5">whichSource</a> = 1;
00245   <a class="code" href="classMadBase.html#p2">jcPath</a> = path;
00246   <a class="code" href="classMadBase.html#p1">fJC</a> = j;
00247   <a class="code" href="classMadBase.html#p0">fChain</a> = NULL;
00248 
00249 
00250   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* default_bec_file=<span class="stringliteral">"/afs/fnal.gov/files/data/minos/d04/kordosky/bec_files/pbeams_0.5_gnumi_v16.root"</span>;
00251   <a class="code" href="classMadMKAnalysis.html#r0">fBECConfig</a>.<a class="code" href="classRegistry.html#a37">Set</a>(<span class="stringliteral">"beam:flux_file"</span>,default_bec_file);
00252   <a class="code" href="classMadMKAnalysis.html#r0">fBECConfig</a>.<a class="code" href="classRegistry.html#a37">Set</a>(<span class="stringliteral">"beam:beam_type"</span>,BeamType::kLE);
00253   <a class="code" href="classMadMKAnalysis.html#r0">fBECConfig</a>.<a class="code" href="classRegistry.html#a37">Set</a>(<span class="stringliteral">"beam:detector"</span>,Detector::kNear);
00254   <a class="code" href="classMadMKAnalysis.html#r0">fBECConfig</a>.<a class="code" href="classRegistry.html#a37">Set</a>(<span class="stringliteral">"beam:low_energy_limit"</span>,0.5);
00255   <a class="code" href="classMadMKAnalysis.html#r0">fBECConfig</a>.<a class="code" href="classRegistry.html#a37">Set</a>(<span class="stringliteral">"beam:high_energy_limit"</span>,60.0);
00256 
00257 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="MadMKAnalysis::~MadMKAnalysis" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> MadMKAnalysis::~<a class="el" href="classMadMKAnalysis.html">MadMKAnalysis</a> </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8cxx-source.html#l00260">260</a> of file <a class="el" href="MadMKAnalysis_8cxx-source.html">MadMKAnalysis.cxx</a>.
<p>
<div class="fragment"><pre>00261 {
00262 
00263 }
</pre></div>    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="a4" doxytag="MadMKAnalysis::ClosestPointToLine" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> Float_t MadMKAnalysis::ClosestPointToLine </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const Float_t &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>x1</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>const Float_t &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>y1</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>const Float_t &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>x2</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>const Float_t &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>y2</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>const Float_t &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>xpt</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>const Float_t &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>ypt</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>Float_t &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>x</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>Float_t &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>y</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8cxx-source.html#l02231">2231</a> of file <a class="el" href="MadMKAnalysis_8cxx-source.html">MadMKAnalysis.cxx</a>.
<p>
References <a class="el" href="nrutil__val_8h-source.html#l00374">pow()</a>.
<p>
<div class="fragment"><pre>02237                                                                  {
02238   <span class="comment">// given a line with end points (x1,y1) (x2,y2) </span>
02239   <span class="comment">// and a spatial point (xpt,ypt)</span>
02240   <span class="comment">// report the closest point on the line (x,y) to the spatial point</span>
02241   <span class="comment">// and compute the distance from (xpt,ypt) to (x,y)</span>
02242   Float_t u= (xpt-x1)*(x2-x1)+(ypt-y1)*(y2-y1);
02243   u/=sqrt( <a class="code" href="nrutil__val_8h.html#a22">pow</a>(x2-x1,2) + <a class="code" href="nrutil__val_8h.html#a22">pow</a>(y2-y1,2));
02244   x=x1+u*(x2-x1);
02245   y=y1+u*(y2-y1);
02246   Float_t dist =sqrt(<a class="code" href="nrutil__val_8h.html#a22">pow</a>(xpt-x, 2)+<a class="code" href="nrutil__val_8h.html#a22">pow</a>(ypt-y,2));
02247   <span class="keywordflow">return</span> dist;
02248 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="b18" doxytag="MadMKAnalysis::ComputeLowPHRatio" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> float MadMKAnalysis::ComputeLowPHRatio </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8cxx-source.html#l03136">3136</a> of file <a class="el" href="MadMKAnalysis_8cxx-source.html">MadMKAnalysis.cxx</a>.
<p>
References <a class="el" href="MadBase_8h-source.html#l00222">MadBase::GetEventSummary()</a>, <a class="el" href="MadBase_8cxx-source.html#l00692">MadBase::LoadStrip()</a>, <a class="el" href="NtpSREventSummary_8h-source.html#l00040">NtpSREventSummary::nstrip</a>, <a class="el" href="NtpSRPulseHeight_8h-source.html#l00038">NtpSRPulseHeight::pe</a>, <a class="el" href="NtpSRStrip_8h-source.html#l00059">NtpSRStrip::ph0</a>, and <a class="el" href="NtpSRStrip_8h-source.html#l00060">NtpSRStrip::ph1</a>.
<p>
Referenced by <a class="el" href="MadMKAnalysis_8cxx-source.html#l00265">CreatePAN()</a>.
<p>
<div class="fragment"><pre>03137 {
03138   <span class="keywordtype">float</span> lowphsum=0.;
03139   <span class="keywordtype">float</span> totphsum=0.;
03140 
03141   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="classMadBase.html#a7">GetEventSummary</a>()-&gt;<a class="code" href="classNtpSREventSummary.html#o1">nstrip</a>;i++){
03142     <span class="keywordflow">if</span>(!<a class="code" href="classMadBase.html#b6">LoadStrip</a>(i)) <span class="keywordflow">continue</span>;
03143     totphsum+=<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o13">ph1</a>.<a class="code" href="classNtpSRPulseHeight.html#o3">pe</a>+<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o12">ph0</a>.<a class="code" href="classNtpSRPulseHeight.html#o3">pe</a>;
03144     <span class="keywordflow">if</span>(<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o13">ph1</a>.<a class="code" href="classNtpSRPulseHeight.html#o3">pe</a>+<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o12">ph0</a>.<a class="code" href="classNtpSRPulseHeight.html#o3">pe</a>&lt;2){
03145       lowphsum+=<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o13">ph1</a>.<a class="code" href="classNtpSRPulseHeight.html#o3">pe</a>+<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o12">ph0</a>.<a class="code" href="classNtpSRPulseHeight.html#o3">pe</a>;
03146     }
03147   }
03148 
03149   <span class="keywordtype">float</span> result=-1.;
03150   <span class="keywordflow">if</span>(totphsum!=0){
03151     result = lowphsum/totphsum;
03152   }
03153 
03154   <span class="keywordflow">return</span> result;
03155 
03156 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="MadMKAnalysis::CreatePAN" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void MadMKAnalysis::CreatePAN </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">std::string&nbsp;</td>
          <td class="mdname" nowrap> <em>tag</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>bmonpath</em> = ""</td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
fill event-by-event trees here 
<p>
BEGIN: intranuke reweighting init.<p>
END: intranuke reweighting init. 
<p>
Definition at line <a class="el" href="MadMKAnalysis_8cxx-source.html#l00265">265</a> of file <a class="el" href="MadMKAnalysis_8cxx-source.html">MadMKAnalysis.cxx</a>.
<p>
References <a class="el" href="NtpStNC_8h-source.html#l00041">abs()</a>, <a class="el" href="inuke__rw_8h-source.html#l00021">inuke_reweight::delta_fate::abs</a>, <a class="el" href="Moments_8cxx-source.html#l00023">Moments::AddPoint()</a>, <a class="el" href="MadQEID_8cxx-source.html#l00344">MadQEID::AltCalcQEID()</a>, <a class="el" href="namespaceBeamType.html#a0">BeamType::BeamType_t</a>, <a class="el" href="NtpSRPlane_8h-source.html#l00040">NtpSRPlane::beg</a>, <a class="el" href="neugen3__dummy_8h-source.html#l00142">neugen_wrapper::begin_generation()</a>, <a class="el" href="NtpSRPlane_8h-source.html#l00041">NtpSRPlane::begu</a>, <a class="el" href="NtpSRPlane_8h-source.html#l00042">NtpSRPlane::begv</a>, <a class="el" href="inuke__rw_8cxx-source.html#l00211">inuke_reweight::calc_weights()</a>, <a class="el" href="MadDpID_8cxx-source.html#l00172">MadDpID::CalcPID()</a>, <a class="el" href="inuke__rw_8h-source.html#l00021">inuke_reweight::delta_fate::cex</a>, <a class="el" href="NtpSRFitTrack_8h-source.html#l00038">NtpSRFitTrack::chi2</a>, <a class="el" href="MadDpID_8cxx-source.html#l00403">MadDpID::ChoosePDFs()</a>, <a class="el" href="MadNsID_8cxx-source.html#l00689">MadNsID::ChooseWeightFile()</a>, <a class="el" href="NearbyEvents_8cxx-source.html#l00150">NearbyVertexFinder::ClosestSpatial()</a>, <a class="el" href="NearbyEvents_8cxx-source.html#l00167">NearbyVertexFinder::ClosestTemporal()</a>, <a class="el" href="NtpSRShower_8h-source.html#l00093">NtpSRShower::clu</a>, <a class="el" href="NtpSRDetStatus_8h-source.html#l00034">NtpSRDetStatus::coilstatus</a>, <a class="el" href="NtpTHShower_8h-source.html#l00039">NtpTHShower::completeslc</a>, <a class="el" href="NtpTHTrack_8h-source.html#l00039">NtpTHTrack::completeslc</a>, <a class="el" href="MadMKAnalysis_8cxx-source.html#l03136">ComputeLowPHRatio()</a>, <a class="el" href="EnergyCorrections_8cxx-source.html#l00690">EnergyCorrections::CorrectMomentumFromRange()</a>, <a class="el" href="EnergyCorrections_8cxx-source.html#l00709">EnergyCorrections::CorrectSignedMomentumFromCurvature()</a>, <a class="el" href="classDetector.html#w0">Detector::Detector_t</a>, <a class="el" href="MadMKAnalysis_8h-source.html#l00145">dpid</a>, <a class="el" href="MadMKAnalysis_8cxx-source.html#l03158">DupRecoStrips()</a>, <a class="el" href="MadMKAnalysis_8cxx-source.html#l02802">EarlyActivity()</a>, <a class="el" href="inuke__rw_8h-source.html#l00021">inuke_reweight::delta_fate::elas</a>, <a class="el" href="NtpSRTrack_8h-source.html#l00102">NtpSRTrack::end</a>, <a class="el" href="NtpSRPlane_8h-source.html#l00043">NtpSRPlane::end</a>, <a class="el" href="NtpSRPlane_8h-source.html#l00044">NtpSRPlane::endu</a>, <a class="el" href="NtpSRPlane_8h-source.html#l00045">NtpSRPlane::endv</a>, <a class="el" href="NtpSRMomentum_8h-source.html#l00038">NtpSRMomentum::eqp</a>, <a class="el" href="MadMKAnalysis_8cxx-source.html#l03118">FarTrkContained()</a>, <a class="el" href="MadMKAnalysis_8h-source.html#l00226">fBECConfig</a>, <a class="el" href="BeamMonSpill_8h-source.html#l00139">BeamMonSpill::fBpmInt</a>, <a class="el" href="MadMKAnalysis_8h-source.html#l00228">fDataUseMCBeam</a>, <a class="el" href="MadMKAnalysis_8h-source.html#l00229">fDoInukeReweight</a>, <a class="el" href="BeamMonSpill_8h-source.html#l00146">BeamMonSpill::fHadInt</a>, <a class="el" href="BeamMonSpill_8h-source.html#l00130">BeamMonSpill::fHornCur</a>, <a class="el" href="MadMKAnalysis_8cxx-source.html#l02933">FillMCHists()</a>, <a class="el" href="NtpSRTrack_8h-source.html#l00110">NtpSRTrack::fit</a>, <a class="el" href="MadQuantities_8cxx-source.html#l00506">MadQuantities::Flavour()</a>, <a class="el" href="NtpMCTruth_8h-source.html#l00078">NtpMCTruth::flux</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00038">NtpMCFluxInfo::fluxevtno</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00037">NtpMCFluxInfo::fluxrun</a>, <a class="el" href="MadMKAnalysis_8h-source.html#l00227">fMCBeam</a>, <a class="el" href="BeamMonSpill_8h-source.html#l00146">BeamMonSpill::fMuInt1</a>, <a class="el" href="BeamMonSpill_8h-source.html#l00146">BeamMonSpill::fMuInt2</a>, <a class="el" href="BeamMonSpill_8h-source.html#l00146">BeamMonSpill::fMuInt3</a>, <a class="el" href="MadMKAnalysis_8h-source.html#l00231">fNRandomSets</a>, <a class="el" href="MadMKAnalysis_8h-source.html#l00230">fOnlyWriteFidEvents</a>, <a class="el" href="BeamMonSpill_8h-source.html#l00144">BeamMonSpill::fProfWidX</a>, <a class="el" href="BeamMonSpill_8h-source.html#l00144">BeamMonSpill::fProfWidY</a>, <a class="el" href="BeamType_8cxx-source.html#l00102">BeamType::FromBeamMon()</a>, <a class="el" href="inuke__rw_8h-source.html#l00031">inuke_reweight::delta_scale::ft</a>, <a class="el" href="BeamMonSpill_8h-source.html#l00132">BeamMonSpill::fTargBpmX</a>, <a class="el" href="BeamMonSpill_8h-source.html#l00132">BeamMonSpill::fTargBpmY</a>, <a class="el" href="BeamMonSpill_8h-source.html#l00142">BeamMonSpill::fTargProfX</a>, <a class="el" href="BeamMonSpill_8h-source.html#l00142">BeamMonSpill::fTargProfY</a>, <a class="el" href="BeamMonSpill_8h-source.html#l00128">BeamMonSpill::fTor101</a>, <a class="el" href="BeamMonSpill_8h-source.html#l00128">BeamMonSpill::fTortgt</a>, <a class="el" href="BeamMonSpill_8h-source.html#l00128">BeamMonSpill::fTr101d</a>, <a class="el" href="BeamMonSpill_8h-source.html#l00128">BeamMonSpill::fTrtgtd</a>, <a class="el" href="inuke__rw_8cxx-source.html#l00410">inuke_reweight::generate_1sigma_shifts()</a>, <a class="el" href="inuke__rw_8cxx-source.html#l00507">inuke_reweight::generate_uncor_shifts()</a>, <a class="el" href="BDSpillAccessor_8cxx-source.html#l00016">BDSpillAccessor::Get()</a>, <a class="el" href="classRegistry.html#a24">Registry::Get()</a>, <a class="el" href="VldContext_8h-source.html#l00051">VldContext::GetDetector()</a>, <a class="el" href="MadBase_8cxx-source.html#l00068">MadBase::GetEntry()</a>, <a class="el" href="MadMKAnalysis_8cxx-source.html#l02636">GetEvtTimeChar()</a>, <a class="el" href="MadMKAnalysis_8cxx-source.html#l02675">GetEvtTimeCharPHC()</a>, <a class="el" href="GnumiInterface_8cxx-source.html#l00152">GnumiInterface::GetParent()</a>, <a class="el" href="MadNsID_8cxx-source.html#l00720">MadNsID::GetPID()</a>, <a class="el" href="RecPhysicsHeader_8h-source.html#l00035">RecPhysicsHeader::GetRemoteSpillType()</a>, <a class="el" href="Moments_8cxx-source.html#l00036">Moments::GetRMS()</a>, <a class="el" href="RecDataHeader_8h-source.html#l00026">RecDataHeader::GetRun()</a>, <a class="el" href="VldContext_8h-source.html#l00052">VldContext::GetSimFlag()</a>, <a class="el" href="RecPhysicsHeader_8h-source.html#l00032">RecPhysicsHeader::GetSnarl()</a>, <a class="el" href="WeightCalculator_8h-source.html#l00031">WeightCalculator::GetStandardConfig()</a>, <a class="el" href="BeamMonSpill_8h-source.html#l00172">BeamMonSpill::GetStatusBits()</a>, <a class="el" href="RecDataHeader_8h-source.html#l00027">RecDataHeader::GetSubRun()</a>, <a class="el" href="VldContext_8h-source.html#l00053">VldContext::GetTimeStamp()</a>, <a class="el" href="SpillTimeFinder_8h-source.html#l00112">SpillTimeFinder::GetTimeToNearestSpill()</a>, <a class="el" href="RecPhysicsHeader_8h-source.html#l00033">RecPhysicsHeader::GetTrigSrc()</a>, <a class="el" href="RecHeader_8h-source.html#l00028">RecHeader::GetVldContext()</a>, <a class="el" href="NtpSRStripPulseHeight_8h-source.html#l00034">NtpSRStripPulseHeight::gev</a>, <a class="el" href="MsgRootDummies_8cxx.html#a0">gSystem()</a>, <a class="el" href="MadQuantities_8cxx-source.html#l01175">MadQuantities::HadronicFinalState()</a>, <a class="el" href="MadQuantities_8cxx-source.html#l00528">MadQuantities::IAction()</a>, <a class="el" href="NtpSRCluster_8h-source.html#l00047">NtpSRCluster::id</a>, <a class="el" href="inuke__rw_8h-source.html#l00021">inuke_reweight::delta_fate::inel</a>, <a class="el" href="MadMKAnalysis_8cxx-source.html#l02067">InFidVol()</a>, <a class="el" href="MadQuantities_8cxx-source.html#l01128">MadQuantities::Initial_state()</a>, <a class="el" href="SpillTimeFinder_8cxx-source.html#l00014">SpillTimeFinder::Instance()</a>, <a class="el" href="MadQuantities_8cxx-source.html#l00492">MadQuantities::INu()</a>, <a class="el" href="MadQuantities_8cxx-source.html#l00535">MadQuantities::IResonance()</a>, <a class="el" href="MadQuantities_8cxx-source.html#l00324">MadQuantities::IsFidAll()</a>, <a class="el" href="MadMKAnalysis_8cxx-source.html#l00184">kXcenter</a>, <a class="el" href="MadMKAnalysis_8cxx-source.html#l00185">kYcenter</a>, <a class="el" href="NtpSREventSummary_8h-source.html#l00050">NtpSREventSummary::litime</a>, <a class="el" href="MadBase_8cxx-source.html#l00306">MadBase::LoadCluster()</a>, <a class="el" href="MadBase_8cxx-source.html#l00536">MadBase::LoadEvent()</a>, <a class="el" href="MadBase_8cxx-source.html#l00244">MadBase::LoadLargestTrackFromEvent()</a>, <a class="el" href="MadBase_8cxx-source.html#l00323">MadBase::LoadShower()</a>, <a class="el" href="MadBase_8cxx-source.html#l00363">MadBase::LoadShower_Jim()</a>, <a class="el" href="MadBase_8cxx-source.html#l00501">MadBase::LoadSlice()</a>, <a class="el" href="BDSpillAccessor_8cxx-source.html#l00039">BDSpillAccessor::LoadSpill()</a>, <a class="el" href="MadBase_8cxx-source.html#l00483">MadBase::LoadTHShower()</a>, <a class="el" href="MadBase_8cxx-source.html#l00227">MadBase::LoadTrack()</a>, <a class="el" href="MadBase_8cxx-source.html#l00553">MadBase::LoadTruth()</a>, <a class="el" href="MadBase_8cxx-source.html#l00660">MadBase::LoadTruthForRecoTH()</a>, <a class="el" href="inuke__rw_8h-source.html#l00057">inuke_reweight::parameter_limits::lower</a>, <a class="el" href="NtpSRStripPulseHeight_8h-source.html#l00033">NtpSRStripPulseHeight::mip</a>, <a class="el" href="NtpSRTrack_8h-source.html#l00109">NtpSRTrack::momentum</a>, <a class="el" href="MadMKAnalysis_8cxx-source.html#l02722">MuonShowerEnergy()</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00072">NtpMCFluxInfo::mupare</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00069">NtpMCFluxInfo::muparpx</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00070">NtpMCFluxInfo::muparpy</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00071">NtpMCFluxInfo::muparpz</a>, <a class="el" href="NtpSRPlane_8h-source.html#l00037">NtpSRPlane::n</a>, <a class="el" href="NtpSRShower_8h-source.html#l00092">NtpSRShower::ncluster</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00052">NtpMCFluxInfo::ndecay</a>, <a class="el" href="NtpSRFitTrack_8h-source.html#l00035">NtpSRFitTrack::ndof</a>, <a class="el" href="MadMKAnalysis_8cxx-source.html#l02266">NDRadialFidVol()</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00039">NtpMCFluxInfo::ndxdz</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00047">NtpMCFluxInfo::ndxdzfar</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00043">NtpMCFluxInfo::ndxdznear</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00040">NtpMCFluxInfo::ndydz</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00048">NtpMCFluxInfo::ndydzfar</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00044">NtpMCFluxInfo::ndydznear</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00073">NtpMCFluxInfo::necm</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00042">NtpMCFluxInfo::nenergy</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00049">NtpMCFluxInfo::nenergyfar</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00045">NtpMCFluxInfo::nenergynear</a>, <a class="el" href="NtpTHTrack_8h-source.html#l00034">NtpTHTrack::neumc</a>, <a class="el" href="NtpSREventSummary_8h-source.html#l00045">NtpSREventSummary::nevent</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00074">NtpMCFluxInfo::nimpwt</a>, <a class="el" href="NtpSRDmxStatus_8h-source.html#l00042">NtpSRDmxStatus::nonphysicalfail</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00051">NtpMCFluxInfo::norig</a>, <a class="el" href="MadMKAnalysis_8cxx-source.html#l02468">NPlanesInObj()</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00041">NtpMCFluxInfo::npz</a>, <a class="el" href="NtpSREvent_8h-source.html#l00070">NtpSREvent::nshower</a>, <a class="el" href="MadMKAnalysis_8h-source.html#l00144">nsid</a>, <a class="el" href="NtpSRTrack_8h-source.html#l00070">NtpSRTrack::nstrip</a>, <a class="el" href="NtpSREvent_8h-source.html#l00062">NtpSREvent::nstrip</a>, <a class="el" href="MadMKAnalysis_8cxx-source.html#l02557">NStripsInObj()</a>, <a class="el" href="NtpSREvent_8h-source.html#l00072">NtpSREvent::ntrack</a>, <a class="el" href="NtpSRTrackPlane_8h-source.html#l00035">NtpSRTrackPlane::ntrklike</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00053">NtpMCFluxInfo::ntype</a>, <a class="el" href="MadQuantities_8cxx-source.html#l00773">MadQuantities::Nucleus()</a>, <a class="el" href="MadQuantities_8cxx-source.html#l00664">MadQuantities::NumFSNeutron()</a>, <a class="el" href="MadQuantities_8cxx-source.html#l00682">MadQuantities::NumFSPion()</a>, <a class="el" href="MadQuantities_8cxx-source.html#l00725">MadQuantities::NumFSPiZero()</a>, <a class="el" href="MadQuantities_8cxx-source.html#l00646">MadQuantities::NumFSProton()</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00050">NtpMCFluxInfo::nwtfar</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00046">NtpMCFluxInfo::nwtnear</a>, <a class="el" href="NtpSRFitTrack_8h-source.html#l00034">NtpSRFitTrack::pass</a>, <a class="el" href="MadAnalysis_8h-source.html#l00101">MadAnalysis::PassBasicCuts()</a>, <a class="el" href="MadQEID_8cxx-source.html#l00387">MadQEID::PassMEDQECut()</a>, <a class="el" href="MadQuantities_8cxx-source.html#l00140">MadQuantities::PassTrackCuts()</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00057">NtpMCFluxInfo::pdpx</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00058">NtpMCFluxInfo::pdpy</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00059">NtpMCFluxInfo::pdpz</a>, <a class="el" href="NtpSRCluster_8h-source.html#l00065">NtpSRCluster::ph</a>, <a class="el" href="NtpSRTrack_8h-source.html#l00099">NtpSRTrack::ph</a>, <a class="el" href="NtpSREvent_8h-source.html#l00084">NtpSREvent::ph</a>, <a class="el" href="inuke__rw_8h-source.html#l00041">inuke_reweight::parameter_set::pi_fate</a>, <a class="el" href="inuke__rw_8h-source.html#l00043">inuke_reweight::parameter_set::pi_scale</a>, <a class="el" href="inuke__rw_8h-source.html#l00021">inuke_reweight::delta_fate::piprod</a>, <a class="el" href="MadMKAnalysis_8cxx-source.html#l02282">PittInFidVol()</a>, <a class="el" href="MadMKAnalysis_8cxx-source.html#l02298">PittTrkContained()</a>, <a class="el" href="NtpSRShower_8h-source.html#l00097">NtpSRShower::plane</a>, <a class="el" href="NtpSRTrack_8h-source.html#l00100">NtpSRTrack::plane</a>, <a class="el" href="NtpSREvent_8h-source.html#l00085">NtpSREvent::plane</a>, <a class="el" href="NtpSRCluster_8h-source.html#l00043">NtpSRCluster::planeview</a>, <a class="el" href="inuke__rw_8h-source.html#l00042">inuke_reweight::parameter_set::pn_fate</a>, <a class="el" href="inuke__rw_8h-source.html#l00044">inuke_reweight::parameter_set::pn_scale</a>, <a class="el" href="nrutil__val_8h-source.html#l00374">pow()</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00060">NtpMCFluxInfo::ppdxdz</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00061">NtpMCFluxInfo::ppdydz</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00063">NtpMCFluxInfo::ppenergy</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00064">NtpMCFluxInfo::ppmedium</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00062">NtpMCFluxInfo::pppz</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00066">NtpMCFluxInfo::ppvx</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00067">NtpMCFluxInfo::ppvy</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00068">NtpMCFluxInfo::ppvz</a>, <a class="el" href="Registry_8cxx-source.html#l00184">Registry::Print()</a>, <a class="el" href="inuke__rw_8cxx-source.html#l00152">inuke_reweight::parameter_limits::print()</a>, <a class="el" href="inuke__rw_8cxx-source.html#l00055">inuke_reweight::parameter_set::print()</a>, <a class="el" href="neugen3__dummy_8h-source.html#l00141">neugen_wrapper::print_configuration()</a>, <a class="el" href="NearbyEvents_8cxx-source.html#l00185">NearbyVertexFinder::ProcessEntry()</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00065">NtpMCFluxInfo::ptype</a>, <a class="el" href="NtpTHShower_8h-source.html#l00036">NtpTHShower::purity</a>, <a class="el" href="MadQuantities_8cxx-source.html#l00759">MadQuantities::Q2()</a>, <a class="el" href="MadMKAnalysis_8h-source.html#l00146">qeid</a>, <a class="el" href="NtpSRMomentum_8h-source.html#l00037">NtpSRMomentum::qp</a>, <a class="el" href="NtpSRMomentum_8h-source.html#l00033">NtpSRMomentum::range</a>, <a class="el" href="MadMKAnalysis_8cxx-source.html#l02113">RecoMKMuEnergy()</a>, <a class="el" href="MadMKAnalysis_8cxx-source.html#l02191">RecoMuDCosNeuFD()</a>, <a class="el" href="MadMKAnalysis_8cxx-source.html#l02201">RecoMuDCosNeuND()</a>, <a class="el" href="MadQuantities_8cxx-source.html#l01415">MadQuantities::RecoMuDCosZ()</a>, <a class="el" href="MadQuantities_8cxx-source.html#l01650">MadQuantities::RecoQENuEnergy()</a>, <a class="el" href="MadQuantities_8cxx-source.html#l01668">MadQuantities::RecoQEQ2()</a>, <a class="el" href="MadMKAnalysis_8cxx-source.html#l02152">RecoShwEnergy()</a>, <a class="el" href="do__extrap_8h-source.html#l00353">run()</a>, <a class="el" href="BMSpillAna_8cxx-source.html#l00163">BMSpillAna::SelectSpill()</a>, <a class="el" href="neugen3__dummy_8h-source.html#l00054">neugen_config::set_config_no()</a>, <a class="el" href="MadDpID_8h-source.html#l00092">MadDpID::SetPHCorrection()</a>, <a class="el" href="BMSpillAna_8cxx-source.html#l00115">BMSpillAna::SetSpill()</a>, <a class="el" href="BMSpillAna_8h-source.html#l00279">BMSpillAna::SetTimeDiff()</a>, <a class="el" href="NtpSRShower_8h-source.html#l00096">NtpSRShower::shwph</a>, <a class="el" href="NtpSRPulseHeight_8h-source.html#l00037">NtpSRPulseHeight::sigcor</a>, <a class="el" href="MadMKAnalysis_8cxx-source.html#l02410">SigInOut()</a>, <a class="el" href="NtpSREvent_8h-source.html#l00056">NtpSREvent::slc</a>, <a class="el" href="NtpSRCluster_8h-source.html#l00062">NtpSRCluster::slope</a>, <a class="el" href="GnumiInterface_8h-source.html#l00043">GnumiInterface::Status()</a>, <a class="el" href="MadQuantities_8cxx-source.html#l01209">MadQuantities::Target4Vector()</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00085">NtpMCFluxInfo::tgen</a>, <a class="el" href="MadQuantities_8cxx-source.html#l00670">MadQuantities::TotFSNeutronEnergy()</a>, <a class="el" href="MadQuantities_8cxx-source.html#l00690">MadQuantities::TotFSPionEnergy()</a>, <a class="el" href="MadQuantities_8cxx-source.html#l00731">MadQuantities::TotFSPiZeroEnergy()</a>, <a class="el" href="MadQuantities_8cxx-source.html#l00652">MadQuantities::TotFSProtonEnergy()</a>, <a class="el" href="NtpSRCluster_8h-source.html#l00061">NtpSRCluster::tposvtx</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00084">NtpMCFluxInfo::tptype</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00081">NtpMCFluxInfo::tpx</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00082">NtpMCFluxInfo::tpy</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00083">NtpMCFluxInfo::tpz</a>, <a class="el" href="NtpSREventSummary_8h-source.html#l00046">NtpSREventSummary::trigtime</a>, <a class="el" href="MadQuantities_8cxx-source.html#l01304">MadQuantities::TrueMuDCosNeu()</a>, <a class="el" href="MadQuantities_8cxx-source.html#l01293">MadQuantities::TrueMuDCosZ()</a>, <a class="el" href="MadQuantities_8cxx-source.html#l01256">MadQuantities::TrueMuEnergy()</a>, <a class="el" href="MadQuantities_8cxx-source.html#l01222">MadQuantities::TrueNuEnergy()</a>, <a class="el" href="MadQuantities_8cxx-source.html#l01228">MadQuantities::TrueNuMom()</a>, <a class="el" href="MadQuantities_8cxx-source.html#l01286">MadQuantities::TrueShwEnergy()</a>, <a class="el" href="MadQuantities_8cxx-source.html#l01242">MadQuantities::TrueVtx()</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00078">NtpMCFluxInfo::tvx</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00079">NtpMCFluxInfo::tvy</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00080">NtpMCFluxInfo::tvz</a>, <a class="el" href="NtpSRVertex_8h-source.html#l00038">NtpSRVertex::u</a>, <a class="el" href="inuke__rw_8h-source.html#l00056">inuke_reweight::parameter_limits::upper</a>, <a class="el" href="NtpSRVertex_8h-source.html#l00039">NtpSRVertex::v</a>, <a class="el" href="NtpSRDmxStatus_8h-source.html#l00043">NtpSRDmxStatus::validplanesfail</a>, <a class="el" href="NtpSRDmxStatus_8h-source.html#l00044">NtpSRDmxStatus::vertexplanefail</a>, <a class="el" href="NtpSRTrack_8h-source.html#l00101">NtpSRTrack::vtx</a>, <a class="el" href="NtpSRShower_8h-source.html#l00098">NtpSRShower::vtx</a>, <a class="el" href="NtpSREvent_8h-source.html#l00086">NtpSREvent::vtx</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00054">NtpMCFluxInfo::vx</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00055">NtpMCFluxInfo::vy</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00056">NtpMCFluxInfo::vz</a>, <a class="el" href="MadQuantities_8cxx-source.html#l00766">MadQuantities::W2()</a>, <a class="el" href="NtpSRShowerPulseHeight_8h-source.html#l00034">NtpSRShowerPulseHeight::wtCCgev</a>, <a class="el" href="NtpSRVertex_8h-source.html#l00040">NtpSRVertex::x</a>, <a class="el" href="MadQuantities_8cxx-source.html#l00752">MadQuantities::X()</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00075">NtpMCFluxInfo::xpoint</a>, <a class="el" href="inuke__rw_8h-source.html#l00031">inuke_reweight::delta_scale::xsec</a>, <a class="el" href="NtpSRVertex_8h-source.html#l00041">NtpSRVertex::y</a>, <a class="el" href="MadQuantities_8cxx-source.html#l00745">MadQuantities::Y()</a>, <a class="el" href="NtpMCFluxInfo_8h-source.html#l00076">NtpMCFluxInfo::ypoint</a>, <a class="el" href="NtpSRVertex_8h-source.html#l00042">NtpSRVertex::z</a>, and <a class="el" href="NtpMCFluxInfo_8h-source.html#l00077">NtpMCFluxInfo::zpoint</a>.
<p>
<div class="fragment"><pre>00266 {
00267   
00268   <span class="comment">// is this MC??</span>
00269   this-&gt;<a class="code" href="classMadBase.html#a3">GetEntry</a>(0);
00270   <span class="keyword">const</span> <span class="keywordtype">bool</span> file_is_mc
00271     =(<a class="code" href="classMadBase.html#p8">ntpHeader</a>-&gt;<a class="code" href="classRecHeader.html#a3">GetVldContext</a>().<a class="code" href="classVldContext.html#a5">GetSimFlag</a>()==SimFlag::kMC);
00272   <span class="comment">// stuff for bmpt reweighting... from tricia</span>
00273   <span class="comment">// only do this if mc</span>
00274 
00275   <a class="code" href="classGnumiInterface.html">GnumiInterface</a>* gnumi=0;  
00276   <span class="keywordflow">if</span>(file_is_mc){
00277     gnumi=<span class="keyword">new</span> <a class="code" href="classGnumiInterface.html">GnumiInterface</a>();
00278     
00279     <span class="keywordflow">if</span>(!gnumi-&gt;<a class="code" href="classGnumiInterface.html#a3">Status</a>()) {
00280       cout &lt;&lt; <span class="stringliteral">"Warning: MadMKAnalysis::CreatePAN() - Flux files not open."</span>
00281            &lt;&lt; <span class="stringliteral">" Will not be filling NuParent info"</span>
00282            &lt;&lt; endl;
00283       cout &lt;&lt; <span class="stringliteral">"Set environmental variable $GNUMIAUX to point to the "</span>
00284            &lt;&lt; <span class="stringliteral">"directory containing the gnumi files to fix this!"</span>
00285            &lt;&lt; endl;    
00286     }
00287     <span class="keywordflow">else</span>{
00288       <span class="keyword">const</span> <span class="keywordtype">char</span>* gnumidir= getenv(<span class="stringliteral">"GNUMIAUX"</span>);
00289       cout&lt;&lt;<span class="stringliteral">"Read gnumi files from "</span>&lt;&lt;gnumidir&lt;&lt;endl;
00290     }
00291   }
00292   <span class="comment">//For Beam Reweighting:</span>
00293   <span class="comment">// must have this here, because it's in ntuple</span>
00294   <a class="code" href="classNuParent.html">NuParent</a> *nuparent = <span class="keyword">new</span> <a class="code" href="classNuParent.html">NuParent</a>();
00295 
00296   
00297   <span class="comment">//PAN Quantities </span>
00298   <span class="comment">//Truth:</span>
00299   Float_t true_enu;       <span class="comment">// true neutrino energy (GeV)</span>
00300   Float_t true_emu;       <span class="comment">// true muon energy</span>
00301   Float_t true_eshw;      <span class="comment">// true shower energy</span>
00302   Float_t true_x;         <span class="comment">// true x</span>
00303   Float_t true_y;         <span class="comment">// true y</span>
00304   Float_t true_q2;        <span class="comment">// true q2</span>
00305   Float_t true_w2;        <span class="comment">// true w2</span>
00306   Float_t true_dircosneu; <span class="comment">// true muon dircos w.r.t neutrino</span>
00307   Float_t true_dircosz;   <span class="comment">// track z-direction cosine</span>
00308   Float_t true_vtxx;      <span class="comment">// true x vtx</span>
00309   Float_t true_vtxy;      <span class="comment">// true y vtx</span>
00310   Float_t true_vtxz;      <span class="comment">// true z vtx</span>
00311   Int_t true_pitt_fid; <span class="comment">// was event truly in fiducial volue?</span>
00312   Float_t true_trk_cmplt;  <span class="comment">//true track completeness</span>
00313 
00314   <span class="comment">//For Neugen:</span>
00315   Float_t flavour;        <span class="comment">// true flavour: 1-e 2-mu 3-tau</span>
00316   Int_t <a class="code" href="classprocess.html">process</a>;          <span class="comment">// process: 1001-QEL 1002-RES 1003-DIS 1004-COH</span>
00317   Int_t <a class="code" href="classnucleus.html">nucleus</a>;          <span class="comment">// target nucleus: 274-C 284-O 372-Fe</span>
00318   Int_t cc_nc;            <span class="comment">// cc/nc flag: 1-cc 2-nc</span>
00319   Int_t initial_state;    <span class="comment">// initial state: 1-vp 2-vn 3-vbarp 4-vbarn ...</span>
00320   Int_t inu;              <span class="comment">// stdhep inu</span>
00321   Int_t resnum; <span class="comment">// IdHEP%1000 of resonance state</span>
00322 
00323   Short_t npp; <span class="comment">// # final state pi+</span>
00324   Short_t npm; <span class="comment">// # fs pi-</span>
00325   Short_t npz; <span class="comment">// # fs pi0</span>
00326   Short_t np; <span class="comment">// # fs p</span>
00327   Short_t nn; <span class="comment">// # fs n</span>
00328   <span class="keywordtype">float</span> epp; <span class="comment">// energy final state pi+</span>
00329   <span class="keywordtype">float</span> epm; <span class="comment">// energy fs pi-</span>
00330   <span class="keywordtype">float</span> epz; <span class="comment">// energy fs pi0</span>
00331   <span class="keywordtype">float</span> ep; <span class="comment">// energy fs p</span>
00332   <span class="keywordtype">float</span> en; <span class="comment">// energy fs n</span>
00333 
00334   
00335   <span class="comment">//Reco Quantities</span>
00336   Int_t detector;         <span class="comment">// Near = 1, Far = 2;</span>
00337   Int_t <a class="code" href="do__extrap_8h.html#a34">run</a>;              <span class="comment">// run number</span>
00338   Int_t snarl;            <span class="comment">// snarl number</span>
00339   Int_t subrun;           <span class="comment">// subrun number</span>
00340   UInt_t trgsrc;          <span class="comment">// trigger source</span>
00341   <span class="keywordtype">double</span> trgtime;         <span class="comment">// trigger time</span>
00342   Int_t spilltype;        <span class="comment">// comes from mdSpillTypeEnum</span>
00343                           <span class="comment">// 0=none, 1=reported, 2=predicted</span>
00344                           <span class="comment">// 3=fake, 4=local</span>
00345 
00346   Int_t nevent;           <span class="comment">// number of events in snarl</span>
00347   Int_t event;            <span class="comment">// event index</span>
00348   Int_t mcevent;          <span class="comment">// mc event index</span>
00349   Int_t ntrack;           <span class="comment">// number of tracks in event</span>
00350   Int_t nshower;          <span class="comment">// number of showers in event</span>
00351   Int_t nstrip;           <span class="comment">// number of strips in event</span>
00352 
00353   Int_t is_fid;           <span class="comment">// pass fid cut. true = 1, false = 0</span>
00354   Int_t is_cev;           <span class="comment">// fully contained. true = 1, false = 0 </span>
00355   Int_t is_mc;            <span class="comment">// is a corresponding mc event found</span>
00356   Int_t pass_basic;       <span class="comment">// Pass basic cuts. true = 1, false = 0</span>
00357   Int_t is_pitt_fid;      <span class="comment">// passes pitt ND vtx fid cut true=1, false=0</span>
00358   Int_t is_trk_fid;       <span class="comment">// is the trkvtx in fid (pitt fid for ND)</span>
00359                           <span class="comment">// true=1, false=0, notrack = -1</span>
00360   Int_t nd_radial_fid;    <span class="comment">// a bitfield, bits correspond to r cuts</span>
00361   Int_t pitt_evt_class;   <span class="comment">// CC event class as defined by pitt group</span>
00362   <span class="comment">// 1 = track is fully contained in the upstream region</span>
00363   <span class="comment">// 2 = track is partially contained in the upstream region</span>
00364   <span class="comment">// 3 = track is fully contained in the downstream region</span>
00365   <span class="comment">// 4 = track is partially contained in the downstream region</span>
00366   Int_t pitt_trk_qual;   <span class="comment">// pitt tracking quality cuts</span>
00367   Int_t duvvtx;          <span class="comment">//delta (Uvtx-Vvtx)</span>
00368 
00369   Float_t pid0;           <span class="comment">// pid parameter (usual method)</span>
00370   Float_t pid1;           <span class="comment">// pid parameter (alternative method 1)</span>
00371   Float_t pid2;           <span class="comment">// pid parameter (alternative method 2)</span>
00372   Int_t pass_track;       <span class="comment">// the primary track passes track cuts</span>
00373   Int_t pass;             <span class="comment">// pass analysis cuts. true = 1, false = 0</span>
00374 
00375   Int_t emu_meth;         <span class="comment">// method used to determine muon energy</span>
00376   Float_t reco_enu;       <span class="comment">// reco neutrino energy</span>
00377   Float_t reco_emu;       <span class="comment">// reco muon energy</span>
00378   Float_t reco_mushw;     <span class="comment">// showers along muon track</span>
00379   Float_t reco_eshw;      <span class="comment">// reco shower energy (largest shower</span>
00380   Float_t reco_wtd_eshw;    <span class="comment">// as above but weighted </span>
00381   Float_t reco_vtx_eshw;    <span class="comment">// reco shower energy (=0 if no vertex shower)</span>
00382   Float_t reco_vtx_wtd_eshw;<span class="comment">// as above but weighted (=0 if no vertex shower)</span>
00383   
00384   Float_t reco_dircosneu; <span class="comment">// reco track vtx dircos w.r.t neutrino</span>
00385   Float_t reco_dircosz;   <span class="comment">// reco track vtx z-dircos</span>
00386 
00387   Float_t reco_vtxx;      <span class="comment">// reco x vtx</span>
00388   Float_t reco_vtxy;      <span class="comment">// reco y vtx</span>
00389   Float_t reco_vtxz;      <span class="comment">// reco z vtx</span>
00390   Float_t reco_vtxr;<span class="comment">// radial position of vertex</span>
00391 
00392   Float_t reco_trk_vtxx;      <span class="comment">// reco x track vtx</span>
00393   Float_t reco_trk_vtxy;      <span class="comment">// reco y track vtx</span>
00394   Float_t reco_trk_vtxz;      <span class="comment">// reco z track vtx</span>
00395   Float_t reco_trk_vtxr;<span class="comment">// radial position of vertex</span>
00396 
00397   Float_t reco_shw_vtxx;      <span class="comment">// reco x track vtx</span>
00398   Float_t reco_shw_vtxy;      <span class="comment">// reco y track vtx</span>
00399   Float_t reco_shw_vtxz;      <span class="comment">// reco z track vtx</span>
00400   Float_t reco_shw_vtxr;<span class="comment">// radial position of vertex</span>
00401 
00402 
00403   Float_t reco_trk_endx;      <span class="comment">// reco x track end</span>
00404   Float_t reco_trk_endy;      <span class="comment">// reco y track end</span>
00405   Float_t reco_trk_endz;      <span class="comment">// reco z track end</span>
00406   Float_t reco_trk_endr;<span class="comment">// radial position of vertex</span>
00407 
00408   Int_t evt_nplanes;        <span class="comment">//number of planes in event above some ph</span>
00409   Int_t trk_nplanes;        <span class="comment">//number of planes in track above some ph</span>
00410   Int_t slc_nplanes;        <span class="comment">//number of planes in slice above some ph</span>
00411   Int_t shw_nplanes_cut;        <span class="comment">//number of planes in shower above some ph</span>
00412   Int_t shw_nplanes_raw;        <span class="comment">//number of planes in shower</span>
00413   Float_t shw_ph_cut, shw_ph_raw; <span class="comment">// sigcor in shower, w/ &amp; w/o ph cut</span>
00414   
00415   Int_t evt_nstrips;        <span class="comment">//number of strips in event above some ph</span>
00416   Int_t trk_nstrips;        <span class="comment">//number of strips in track above some ph</span>
00417   Int_t slc_nstrips;        <span class="comment">//number of strips in slice above some ph</span>
00418 
00419 
00420   <span class="comment">// reconstructed kinematics</span>
00421   <span class="comment">// formulae given for high-energy CC interactions</span>
00422   <span class="comment">// Assume nu = Ehad</span>
00423   Float_t reco_y;<span class="comment">// y = (Enu-Emu)/Enu</span>
00424   Float_t reco_Q2;<span class="comment">// Q2 = -q^{2} = 2 Enu Emu (1 - cos(theta_mu))</span>
00425   Float_t reco_x;<span class="comment">// x = Q2 / (2M* Ehad)  {M=nucleon mass}</span>
00426   Float_t reco_W2;<span class="comment">// W2 = M^{2} + q^{2} + 2M(Enu-Emu)</span>
00427 
00428   <span class="comment">// reco quantities, assuming a QE event</span>
00429   Float_t reco_qe_enu;    <span class="comment">// reco qe neutrino energy</span>
00430   Float_t reco_qe_q2;     <span class="comment">// reco qe q2</span>
00431 
00432   
00433   Float_t evtlength;      <span class="comment">// reco event length</span>
00434   Float_t shwlength;      <span class="comment">// reco shower length</span>
00435   Float_t trklength;      <span class="comment">// reco track length (planes)</span>
00436   Int_t ntrklike;      <span class="comment">// number of track-like planes</span>
00437   Float_t trkmomrange;    <span class="comment">// reco track momentum from range</span>
00438   Float_t trkqp;          <span class="comment">// reco track q/p</span>
00439   Float_t trkeqp;         <span class="comment">// reco track q/p error</span>
00440   Float_t trkphfrac;      <span class="comment">// reco pulse height fraction in track</span>
00441   Float_t trkphplane;     <span class="comment">// reco average track pulse height/plane</span>
00442   Float_t trkchi2;
00443   Int_t trkndf;
00444 
00445 
00446   Int_t trkend, trkendu, trkendv; <span class="comment">// track end plane, u, v</span>
00447   Int_t shwend,shwbeg; <span class="comment">// shower begin,end planes</span>
00448 
00449   Int_t nss[6];<span class="comment">//</span>
00450   Float_t ess[6];<span class="comment">//</span>
00451   Int_t ntotss;
00452 
00453 
00454 
00455   <span class="comment">// variables to tag nearest event  in space and time</span>
00456   <span class="comment">// nvsi = nearest vertex space : index</span>
00457   <span class="comment">// nvsd = nearest vertex space : distance</span>
00458   <span class="comment">// nvst = nearest vertex space : distance</span>
00459   <span class="comment">// nvsp = nearest vertex space : pulse height</span>
00460   <span class="comment">// nvsevt = nearest vertex space : mc event</span>
00461   <span class="comment">// nvti = nearest vertex time : index</span>
00462   <span class="comment">// ....  </span>
00463   <span class="comment">// bvsi = back vertex space : index</span>
00464   <span class="comment">// the "back" variables hold the same info as the "near" variables</span>
00465   <span class="comment">// but for that nearest event</span>
00466   <span class="comment">// I'm interested in this case</span>
00467   <span class="comment">//  </span>
00468   <span class="comment">//  (this vtx)------&gt;(nearest)---&gt;(nearest to it)</span>
00469   <span class="comment">//</span>
00470   <span class="comment">// if you are going to try to recombine events</span>
00471   <span class="comment">// you need to somehow account for this</span>
00472   <span class="comment">//</span>
00473 
00474   Int_t nvsi, bvsi, nvti, bvti;
00475   Int_t nvsevt, bvsevt, nvtevt, bvtevt;
00476   Float_t nvsd, bvsd, nvtd, bvtd;
00477   Float_t nvst, bvst, nvtt, bvtt;
00478   Float_t nvsp, bvsp, nvtp, bvtp;
00479 
00480   <span class="comment">// this event's pulseheight (in sigcor)</span>
00481   Float_t evtph;
00482   Float_t evtphgev;
00483 
00484   <span class="comment">// the pulse height of the event and track</span>
00485   <span class="comment">// in the fully and partially instrumented regions</span>
00486   Float_t evtsigfull,trksigfull,evtsigpart,trksigpart;
00487 
00488 
00489   <span class="comment">//time structure of event</span>
00490   <span class="keywordtype">double</span> evttimemin, evttimemax, evttimeln;
00491   <span class="keywordtype">double</span> evttimeminphc, evttimemaxphc, evttimelnphc;
00492 
00493   <span class="comment">//early activity variables</span>
00494   <span class="keywordtype">float</span> earlywph, earlywphpw, earlywphsphere;
00495   <span class="keywordtype">float</span> ph1000, ph500, ph100;
00496   <span class="keywordtype">float</span> lateph1000, lateph500, lateph100, lateph50;
00497 
00498   <span class="comment">//duplicate reconstructed strip variables</span>
00499   <span class="keywordtype">int</span> nduprs; <span class="comment">//number of reco strips that are duplicated in another event</span>
00500   <span class="keywordtype">float</span> dupphrs; <span class="comment">//pulseheight of reco strips </span>
00501                  <span class="comment">//that are duplicated in another event</span>
00502 
00503   <span class="comment">//time last li event in snarl, -1 if none;</span>
00504   <span class="keywordtype">double</span> litime;
00505 
00506   <span class="comment">//demux failures (for fd)</span>
00507   UChar_t dmx_stat;
00508   <span class="comment">//  std::cout&lt;&lt;"Second Print"&lt;&lt;std::endl;</span>
00509 
00510   <span class="comment">//brian's cut on lowph ratio to remove junk events </span>
00511   <span class="comment">//in FD that pass the dmx_stat variable</span>
00512   <span class="keywordtype">float</span> lowphrat;
00513 
00514   <span class="comment">//Trees</span>
00515   <span class="comment">// output file</span>
00516   std::string savename = <span class="stringliteral">"PAN_"</span> + tag + <span class="stringliteral">".root"</span>;
00517   TFile save(savename.c_str(),<span class="stringliteral">"RECREATE"</span>); 
00518   save.cd();
00519   TTree *tree = <span class="keyword">new</span> TTree(<span class="stringliteral">"pan"</span>,<span class="stringliteral">"pan"</span>);
00520   <span class="comment">//Truth</span>
00521   tree-&gt;Branch(<span class="stringliteral">"true_enu"</span>,&amp;true_enu,<span class="stringliteral">"true_enu/F"</span>,32000);
00522   tree-&gt;Branch(<span class="stringliteral">"true_emu"</span>,&amp;true_emu,<span class="stringliteral">"true_emu/F"</span>,32000);
00523   tree-&gt;Branch(<span class="stringliteral">"true_eshw"</span>,&amp;true_eshw,<span class="stringliteral">"true_eshw/F"</span>,32000);
00524   tree-&gt;Branch(<span class="stringliteral">"true_x"</span>,&amp;true_x,<span class="stringliteral">"true_x/F"</span>,32000);
00525   tree-&gt;Branch(<span class="stringliteral">"true_y"</span>,&amp;true_y,<span class="stringliteral">"true_y/F"</span>,32000);
00526   tree-&gt;Branch(<span class="stringliteral">"true_q2"</span>,&amp;true_q2,<span class="stringliteral">"true_q2/F"</span>,32000);
00527   tree-&gt;Branch(<span class="stringliteral">"true_w2"</span>,&amp;true_w2,<span class="stringliteral">"true_w2/F"</span>,32000);
00528   Float_t nu_px, nu_py, nu_pz;
00529   Float_t tar_px, tar_py, tar_pz, tar_e;
00530   tree-&gt;Branch(<span class="stringliteral">"nu_px"</span>, &amp;nu_px, <span class="stringliteral">"nu_px/F"</span>);
00531   tree-&gt;Branch(<span class="stringliteral">"nu_py"</span>, &amp;nu_py, <span class="stringliteral">"nu_py/F"</span>);
00532   tree-&gt;Branch(<span class="stringliteral">"nu_pz"</span>, &amp;nu_pz, <span class="stringliteral">"nu_pz/F"</span>);
00533   tree-&gt;Branch(<span class="stringliteral">"tar_px"</span>, &amp;tar_px, <span class="stringliteral">"tar_px/F"</span>);
00534   tree-&gt;Branch(<span class="stringliteral">"tar_py"</span>, &amp;tar_py, <span class="stringliteral">"tar_py/F"</span>);
00535   tree-&gt;Branch(<span class="stringliteral">"tar_pz"</span>, &amp;tar_pz, <span class="stringliteral">"tar_pz/F"</span>);
00536   tree-&gt;Branch(<span class="stringliteral">"tar_e"</span>, &amp;tar_e, <span class="stringliteral">"tar_e/F"</span>);
00537 
00538 
00539   tree-&gt;Branch(<span class="stringliteral">"true_dircosneu"</span>,&amp;true_dircosneu,<span class="stringliteral">"true_dircosneu/F"</span>,32000);
00540   tree-&gt;Branch(<span class="stringliteral">"true_dircosz"</span>,&amp;true_dircosz,<span class="stringliteral">"true_dircosz/F"</span>,32000);
00541   tree-&gt;Branch(<span class="stringliteral">"true_vtxx"</span>,&amp;true_vtxx,<span class="stringliteral">"true_vtxx/F"</span>,32000);
00542   tree-&gt;Branch(<span class="stringliteral">"true_vtxy"</span>,&amp;true_vtxy,<span class="stringliteral">"true_vtxy/F"</span>,32000);
00543   tree-&gt;Branch(<span class="stringliteral">"true_vtxz"</span>,&amp;true_vtxz,<span class="stringliteral">"true_vtxz/F"</span>,32000);
00544   tree-&gt;Branch(<span class="stringliteral">"true_pitt_fid"</span>,&amp;true_pitt_fid,<span class="stringliteral">"true_pitt_fid/I"</span>,32000);
00545   tree-&gt;Branch(<span class="stringliteral">"true_trk_cmplt"</span>,&amp;true_trk_cmplt,<span class="stringliteral">"true_trk_cmplt/F"</span>,32000);
00546 
00547   <span class="comment">//Neugen</span>
00548   tree-&gt;Branch(<span class="stringliteral">"flavour"</span>,&amp;flavour,<span class="stringliteral">"flavour/F"</span>,32000);
00549   tree-&gt;Branch(<span class="stringliteral">"process"</span>,&amp;process,<span class="stringliteral">"process/I"</span>,32000);
00550   tree-&gt;Branch(<span class="stringliteral">"nucleus"</span>,&amp;nucleus,<span class="stringliteral">"nucleus/I"</span>,32000);
00551   tree-&gt;Branch(<span class="stringliteral">"cc_nc"</span>,&amp;cc_nc,<span class="stringliteral">"cc_nc/I"</span>,32000);
00552   tree-&gt;Branch(<span class="stringliteral">"inu"</span>,&amp;inu,<span class="stringliteral">"inu/I"</span>,32000);
00553 
00554   tree-&gt;Branch(<span class="stringliteral">"initial_state"</span>,&amp;initial_state,<span class="stringliteral">"initial_state/I"</span>,32000);
00555   tree-&gt;Branch(<span class="stringliteral">"resnum"</span>,&amp;resnum,<span class="stringliteral">"resnum/I"</span>,32000);
00556   tree-&gt;Branch(<span class="stringliteral">"npp"</span>,&amp;npp,<span class="stringliteral">"npp/S"</span>,32000);
00557   tree-&gt;Branch(<span class="stringliteral">"npm"</span>,&amp;npm,<span class="stringliteral">"npm/S"</span>,32000);
00558   tree-&gt;Branch(<span class="stringliteral">"npz"</span>,&amp;npz,<span class="stringliteral">"npz/S"</span>,32000);
00559   tree-&gt;Branch(<span class="stringliteral">"np"</span>,&amp;np,<span class="stringliteral">"np/S"</span>,32000);
00560   tree-&gt;Branch(<span class="stringliteral">"nn"</span>,&amp;nn,<span class="stringliteral">"nn/S"</span>,32000);
00561 
00562   tree-&gt;Branch(<span class="stringliteral">"epp"</span>,&amp;epp,<span class="stringliteral">"epp/F"</span>,32000);
00563   tree-&gt;Branch(<span class="stringliteral">"epm"</span>,&amp;epm,<span class="stringliteral">"epm/F"</span>,32000);
00564   tree-&gt;Branch(<span class="stringliteral">"epz"</span>,&amp;epz,<span class="stringliteral">"epz/F"</span>,32000);
00565   tree-&gt;Branch(<span class="stringliteral">"ep"</span>,&amp;ep,<span class="stringliteral">"ep/F"</span>,32000);
00566   tree-&gt;Branch(<span class="stringliteral">"en"</span>,&amp;en,<span class="stringliteral">"en/F"</span>,32000);
00567 
00568   <span class="comment">//Reco</span>
00569   tree-&gt;Branch(<span class="stringliteral">"detector"</span>,&amp;detector,<span class="stringliteral">"detector/I"</span>,32000);
00570   tree-&gt;Branch(<span class="stringliteral">"run"</span>,&amp;run,<span class="stringliteral">"run/I"</span>,32000);
00571   tree-&gt;Branch(<span class="stringliteral">"snarl"</span>,&amp;snarl,<span class="stringliteral">"snarl/I"</span>,32000);
00572   tree-&gt;Branch(<span class="stringliteral">"subrun"</span>,&amp;subrun,<span class="stringliteral">"subrun/I"</span>,32000);
00573   tree-&gt;Branch(<span class="stringliteral">"trgsrc"</span>,&amp;trgsrc,<span class="stringliteral">"trgsrc/i"</span>,32000);
00574   tree-&gt;Branch(<span class="stringliteral">"trgtime"</span>,&amp;trgtime,<span class="stringliteral">"trgtime/D"</span>,32000);
00575   tree-&gt;Branch(<span class="stringliteral">"spilltype"</span>,&amp;spilltype,<span class="stringliteral">"spiltype/I"</span>,32000);
00576   tree-&gt;Branch(<span class="stringliteral">"nevent"</span>,&amp;nevent,<span class="stringliteral">"nevent/I"</span>,32000);
00577   tree-&gt;Branch(<span class="stringliteral">"event"</span>,&amp;event,<span class="stringliteral">"event/I"</span>,32000);
00578   tree-&gt;Branch(<span class="stringliteral">"mcevent"</span>,&amp;mcevent,<span class="stringliteral">"mcevent/I"</span>,32000);
00579   tree-&gt;Branch(<span class="stringliteral">"ntrack"</span>,&amp;ntrack,<span class="stringliteral">"ntrack/I"</span>,32000);
00580   tree-&gt;Branch(<span class="stringliteral">"nshower"</span>,&amp;nshower,<span class="stringliteral">"nshower/I"</span>,32000);
00581   tree-&gt;Branch(<span class="stringliteral">"nstrip"</span>,&amp;nstrip,<span class="stringliteral">"nstrip/I"</span>,32000);
00582   
00583   tree-&gt;Branch(<span class="stringliteral">"is_fid"</span>,&amp;is_fid,<span class="stringliteral">"is_fid/I"</span>,32000);
00584   tree-&gt;Branch(<span class="stringliteral">"is_cev"</span>,&amp;is_cev,<span class="stringliteral">"is_cev/I"</span>,32000);
00585   tree-&gt;Branch(<span class="stringliteral">"is_mc"</span>,&amp;is_mc,<span class="stringliteral">"is_mc/I"</span>,32000);
00586   tree-&gt;Branch(<span class="stringliteral">"pass_basic"</span>,&amp;pass_basic,<span class="stringliteral">"pass_basic/I"</span>,32000);
00587   tree-&gt;Branch(<span class="stringliteral">"pass_track"</span>,&amp;pass_track,<span class="stringliteral">"pass_track/I"</span>,32000);
00588   tree-&gt;Branch(<span class="stringliteral">"emu_meth"</span>,&amp;emu_meth,<span class="stringliteral">"emu_meth/I"</span>,32000);
00589   tree-&gt;Branch(<span class="stringliteral">"is_pitt_fid"</span>,&amp;is_pitt_fid,<span class="stringliteral">"is_pitt_fid/I"</span>,32000);
00590   tree-&gt;Branch(<span class="stringliteral">"is_trk_fid"</span>,&amp;is_trk_fid,<span class="stringliteral">"is_trk_fid/I"</span>,32000);
00591 
00592   tree-&gt;Branch(<span class="stringliteral">"nd_radial_fid"</span>,&amp;nd_radial_fid,<span class="stringliteral">"nd_radial_fid/I"</span>,32000);
00593   tree-&gt;Branch(<span class="stringliteral">"pitt_evt_class"</span>,&amp;pitt_evt_class,<span class="stringliteral">"pitt_evt_class/I"</span>,32000);
00594   tree-&gt;Branch(<span class="stringliteral">"pitt_trk_qual"</span>,&amp;pitt_trk_qual,<span class="stringliteral">"pitt_trk_qual/I"</span>,32000);
00595   tree-&gt;Branch(<span class="stringliteral">"duvvtx"</span>,&amp;duvvtx,<span class="stringliteral">"duvvtx/I"</span>,32000);
00596 
00597   tree-&gt;Branch(<span class="stringliteral">"pid0"</span>,&amp;pid0,<span class="stringliteral">"pid0/F"</span>,32000);
00598   tree-&gt;Branch(<span class="stringliteral">"pid1"</span>,&amp;pid1,<span class="stringliteral">"pid1/F"</span>,32000);
00599   tree-&gt;Branch(<span class="stringliteral">"pid2"</span>,&amp;pid2,<span class="stringliteral">"pid2/F"</span>,32000);
00600   tree-&gt;Branch(<span class="stringliteral">"pass"</span>,&amp;pass,<span class="stringliteral">"pass/I"</span>,32000);
00601 
00602   <span class="keywordtype">float</span> med_qe_pid;
00603   <span class="keywordtype">int</span> med_qe_pass;
00604   tree-&gt;Branch(<span class="stringliteral">"med_qe_pid"</span>,&amp;med_qe_pid,<span class="stringliteral">"med_qe_pid/F"</span>,32000);
00605   tree-&gt;Branch(<span class="stringliteral">"med_qe_pass"</span>,&amp;med_qe_pass,<span class="stringliteral">"med_qe_pass/I"</span>,32000);
00606 
00607   <span class="keywordtype">double</span> niki_cc_pid;
00608   tree-&gt;Branch(<span class="stringliteral">"niki_cc_pid"</span>,&amp;niki_cc_pid,<span class="stringliteral">"niki_cc_pid/D"</span>,32000);
00609   <span class="keywordtype">float</span> dave_cc_pid;
00610   tree-&gt;Branch(<span class="stringliteral">"dave_cc_pid"</span>,&amp;dave_cc_pid,<span class="stringliteral">"dave_cc_pid/F"</span>,32000);
00611 
00612 
00613   tree-&gt;Branch(<span class="stringliteral">"reco_enu"</span>,&amp;reco_enu,<span class="stringliteral">"reco_enu/F"</span>,32000);
00614   tree-&gt;Branch(<span class="stringliteral">"reco_emu"</span>,&amp;reco_emu,<span class="stringliteral">"reco_emu/F"</span>,32000);
00615   tree-&gt;Branch(<span class="stringliteral">"reco_mushw"</span>,&amp;reco_mushw,<span class="stringliteral">"reco_mushw/F"</span>,32000);
00616   tree-&gt;Branch(<span class="stringliteral">"reco_eshw"</span>,&amp;reco_eshw,<span class="stringliteral">"reco_eshw/F"</span>,32000);
00617   tree-&gt;Branch(<span class="stringliteral">"reco_wtd_eshw"</span>,&amp;reco_wtd_eshw,<span class="stringliteral">"reco_wtd_eshw/F"</span>,32000);
00618   tree-&gt;Branch(<span class="stringliteral">"reco_vtx_eshw"</span>,&amp;reco_vtx_eshw,<span class="stringliteral">"reco_vtx_eshw/F"</span>,32000);
00619   tree-&gt;Branch(<span class="stringliteral">"reco_vtx_wtd_eshw"</span>,&amp;reco_vtx_wtd_eshw,<span class="stringliteral">"reco_vtx_wtd_eshw/F"</span>,32000);
00620   Float_t shw_pur, shw_comp;
00621   tree-&gt;Branch(<span class="stringliteral">"shw_pur"</span>,&amp;shw_pur,<span class="stringliteral">"shw_pur/F"</span>,32000);
00622   tree-&gt;Branch(<span class="stringliteral">"shw_comp"</span>,&amp;shw_comp,<span class="stringliteral">"shw_comp/F"</span>,32000);
00623 
00624 
00625 
00626   tree-&gt;Branch(<span class="stringliteral">"reco_dircosneu"</span>,&amp;reco_dircosneu,<span class="stringliteral">"reco_dircosneu/F"</span>,32000);
00627   tree-&gt;Branch(<span class="stringliteral">"reco_dircosz"</span>,&amp;reco_dircosz,<span class="stringliteral">"reco_dircosz/F"</span>,32000);
00628 
00629   tree-&gt;Branch(<span class="stringliteral">"reco_vtxx"</span>,&amp;reco_vtxx,<span class="stringliteral">"reco_vtxx/F"</span>,32000);
00630   tree-&gt;Branch(<span class="stringliteral">"reco_vtxy"</span>,&amp;reco_vtxy,<span class="stringliteral">"reco_vtxy/F"</span>,32000);
00631   tree-&gt;Branch(<span class="stringliteral">"reco_vtxz"</span>,&amp;reco_vtxz,<span class="stringliteral">"reco_vtxz/F"</span>,32000);
00632   tree-&gt;Branch(<span class="stringliteral">"reco_vtxr"</span>,&amp;reco_vtxr,<span class="stringliteral">"reco_vtxr/F"</span>,32000);
00633 
00634   tree-&gt;Branch(<span class="stringliteral">"reco_trk_vtxx"</span>,&amp;reco_trk_vtxx,<span class="stringliteral">"reco_trk_vtxx/F"</span>,32000);
00635   tree-&gt;Branch(<span class="stringliteral">"reco_trk_vtxy"</span>,&amp;reco_trk_vtxy,<span class="stringliteral">"reco_trk_vtxy/F"</span>,32000);
00636   tree-&gt;Branch(<span class="stringliteral">"reco_trk_vtxz"</span>,&amp;reco_trk_vtxz,<span class="stringliteral">"reco_trk_vtxz/F"</span>,32000);
00637   tree-&gt;Branch(<span class="stringliteral">"reco_trk_vtxr"</span>,&amp;reco_trk_vtxr,<span class="stringliteral">"reco_trk_vtxr/F"</span>,32000);
00638 
00639   tree-&gt;Branch(<span class="stringliteral">"reco_shw_vtxx"</span>,&amp;reco_shw_vtxx,<span class="stringliteral">"reco_shw_vtxx/F"</span>,32000);
00640   tree-&gt;Branch(<span class="stringliteral">"reco_shw_vtxy"</span>,&amp;reco_shw_vtxy,<span class="stringliteral">"reco_shw_vtxy/F"</span>,32000);
00641   tree-&gt;Branch(<span class="stringliteral">"reco_shw_vtxz"</span>,&amp;reco_shw_vtxz,<span class="stringliteral">"reco_shw_vtxz/F"</span>,32000);
00642   <span class="comment">//  tree-&gt;Branch("reco_shw_vtxr",&amp;reco_shw_vtxr,"reco_shw_vtxr/F",32000);</span>
00643 
00644   tree-&gt;Branch(<span class="stringliteral">"reco_trk_endx"</span>,&amp;reco_trk_endx,<span class="stringliteral">"reco_trk_endx/F"</span>,32000);
00645   tree-&gt;Branch(<span class="stringliteral">"reco_trk_endy"</span>,&amp;reco_trk_endy,<span class="stringliteral">"reco_trk_endy/F"</span>,32000);
00646   tree-&gt;Branch(<span class="stringliteral">"reco_trk_endz"</span>,&amp;reco_trk_endz,<span class="stringliteral">"reco_trk_endz/F"</span>,32000);
00647   tree-&gt;Branch(<span class="stringliteral">"reco_trk_endr"</span>,&amp;reco_trk_endr,<span class="stringliteral">"reco_trk_endr/F"</span>,32000);
00648 
00649   tree-&gt;Branch(<span class="stringliteral">"evt_nplanes"</span>,&amp;evt_nplanes,<span class="stringliteral">"evt_nplanes/I"</span>,32000);
00650   tree-&gt;Branch(<span class="stringliteral">"trk_nplanes"</span>,&amp;trk_nplanes,<span class="stringliteral">"trk_nplanes/I"</span>,32000);
00651   tree-&gt;Branch(<span class="stringliteral">"slc_nplanes"</span>,&amp;slc_nplanes,<span class="stringliteral">"slc_nplanes/I"</span>,32000);
00652   tree-&gt;Branch(<span class="stringliteral">"shw_nplanes_cut"</span>,&amp;shw_nplanes_cut,<span class="stringliteral">"shw_nplanes_cut/I"</span>,32000);
00653   tree-&gt;Branch(<span class="stringliteral">"shw_nplanes_raw"</span>,&amp;shw_nplanes_raw,<span class="stringliteral">"shw_nplanes_raw/I"</span>,32000);
00654 
00655   tree-&gt;Branch(<span class="stringliteral">"shw_ph_cut"</span>,&amp;shw_ph_cut,<span class="stringliteral">"shw_ph_cut/F"</span>,32000);
00656   tree-&gt;Branch(<span class="stringliteral">"shw_ph_raw"</span>,&amp;shw_ph_raw,<span class="stringliteral">"shw_ph_raw/F"</span>,32000);
00657 
00658 
00659   tree-&gt;Branch(<span class="stringliteral">"evt_nstrips"</span>,&amp;evt_nstrips,<span class="stringliteral">"evt_nstrips/I"</span>,32000);
00660   tree-&gt;Branch(<span class="stringliteral">"trk_nstrips"</span>,&amp;trk_nstrips,<span class="stringliteral">"trk_nstrips/I"</span>,32000);
00661   tree-&gt;Branch(<span class="stringliteral">"slc_nstrips"</span>,&amp;slc_nstrips,<span class="stringliteral">"slc_nstrips/I"</span>,32000);
00662 
00663   tree-&gt;Branch(<span class="stringliteral">"reco_y"</span>,&amp;reco_y,<span class="stringliteral">"reco_y/F"</span>,32000);
00664   tree-&gt;Branch(<span class="stringliteral">"reco_Q2"</span>,&amp;reco_Q2,<span class="stringliteral">"reco_Q2/F"</span>,32000);
00665   tree-&gt;Branch(<span class="stringliteral">"reco_x"</span>,&amp;reco_x,<span class="stringliteral">"reco_x/F"</span>,32000);
00666   tree-&gt;Branch(<span class="stringliteral">"reco_W2"</span>,&amp;reco_W2,<span class="stringliteral">"reco_W2/F"</span>,32000);
00667 
00668   tree-&gt;Branch(<span class="stringliteral">"reco_qe_enu"</span>,&amp;reco_qe_enu,<span class="stringliteral">"reco_qe_enu/F"</span>,32000);
00669   tree-&gt;Branch(<span class="stringliteral">"reco_qe_q2"</span>,&amp;reco_qe_q2,<span class="stringliteral">"reco_qe_q2/F"</span>,32000);
00670 
00671   tree-&gt;Branch(<span class="stringliteral">"evtlength"</span>,&amp;evtlength,<span class="stringliteral">"evtlength/F"</span>,32000);
00672   tree-&gt;Branch(<span class="stringliteral">"trklength"</span>,&amp;trklength,<span class="stringliteral">"trklength/F"</span>,32000);
00673   tree-&gt;Branch(<span class="stringliteral">"shwlength"</span>,&amp;shwlength,<span class="stringliteral">"shwlength/F"</span>,32000);
00674   tree-&gt;Branch(<span class="stringliteral">"ntrklike"</span>,&amp;ntrklike,<span class="stringliteral">"ntrklike/I"</span>,32000);
00675   tree-&gt;Branch(<span class="stringliteral">"trkend"</span>,&amp;trkend,<span class="stringliteral">"trkend/I"</span>,32000);
00676   tree-&gt;Branch(<span class="stringliteral">"trkendu"</span>,&amp;trkendu,<span class="stringliteral">"trkendu/I"</span>,32000);
00677   tree-&gt;Branch(<span class="stringliteral">"trkendv"</span>,&amp;trkendv,<span class="stringliteral">"trkendv/I"</span>,32000);
00678   tree-&gt;Branch(<span class="stringliteral">"shwbeg"</span>,&amp;shwbeg,<span class="stringliteral">"shwbeg/I"</span>,32000);
00679   tree-&gt;Branch(<span class="stringliteral">"shwend"</span>,&amp;shwend,<span class="stringliteral">"shwend/I"</span>,32000);
00680 
00681 
00682   Int_t trknstp;
00683   tree-&gt;Branch(<span class="stringliteral">"trkmomrange"</span>,&amp;trkmomrange,<span class="stringliteral">"trkmomrange/F"</span>,32000);
00684   tree-&gt;Branch(<span class="stringliteral">"trkqp"</span>,&amp;trkqp,<span class="stringliteral">"trkqp/F"</span>,32000);
00685   tree-&gt;Branch(<span class="stringliteral">"trkeqp"</span>,&amp;trkeqp,<span class="stringliteral">"trkeqp/F"</span>,32000);
00686   tree-&gt;Branch(<span class="stringliteral">"trkphfrac"</span>,&amp;trkphfrac,<span class="stringliteral">"trkphfrac/F"</span>,32000);
00687   tree-&gt;Branch(<span class="stringliteral">"trkphplane"</span>,&amp;trkphplane,<span class="stringliteral">"trkphplane/F"</span>,32000);
00688   tree-&gt;Branch(<span class="stringliteral">"trkchi2"</span>,&amp;trkchi2,<span class="stringliteral">"trkchi2/F"</span>,32000);
00689   tree-&gt;Branch(<span class="stringliteral">"trkndf"</span>,&amp;trkndf,<span class="stringliteral">"trkndf/I"</span>,32000);
00690   tree-&gt;Branch(<span class="stringliteral">"trknstp"</span>,&amp;trknstp,<span class="stringliteral">"trknstp/I"</span>,32000);
00691 
00692 
00693   <span class="comment">// vertex track back variables (described above and in code)</span>
00694   tree-&gt;Branch(<span class="stringliteral">"nvsi"</span>, &amp;nvsi, <span class="stringliteral">"nvsi/I"</span>);
00695   tree-&gt;Branch(<span class="stringliteral">"nvsevt"</span>, &amp;nvsevt, <span class="stringliteral">"nvsevt/I"</span>);
00696   tree-&gt;Branch(<span class="stringliteral">"nvsd"</span>, &amp;nvsd, <span class="stringliteral">"nvsd/F"</span>);
00697   tree-&gt;Branch(<span class="stringliteral">"nvst"</span>, &amp;nvst, <span class="stringliteral">"nvst/F"</span>);
00698   tree-&gt;Branch(<span class="stringliteral">"nvsp"</span>, &amp;nvsp, <span class="stringliteral">"nvsp/F"</span>);
00699   tree-&gt;Branch(<span class="stringliteral">"nvti"</span>, &amp;nvti, <span class="stringliteral">"nvti/I"</span>);
00700   tree-&gt;Branch(<span class="stringliteral">"nvtevt"</span>, &amp;nvtevt, <span class="stringliteral">"nvtevt/I"</span>);
00701   tree-&gt;Branch(<span class="stringliteral">"nvtd"</span>, &amp;nvtd, <span class="stringliteral">"nvtd/F"</span>);
00702   tree-&gt;Branch(<span class="stringliteral">"nvtt"</span>, &amp;nvtt, <span class="stringliteral">"nvtt/F"</span>);
00703   tree-&gt;Branch(<span class="stringliteral">"nvtp"</span>, &amp;nvtp, <span class="stringliteral">"nvtp/F"</span>);
00704   <span class="comment">/*</span>
00705 <span class="comment">  tree-&gt;Branch("bvsi", &amp;bvsi, "bvsi/I");</span>
00706 <span class="comment">  tree-&gt;Branch("bvsevt", &amp;bvsevt, "bvsevt/I");</span>
00707 <span class="comment">  tree-&gt;Branch("bvsd", &amp;bvsd, "bvsd/F");</span>
00708 <span class="comment">  tree-&gt;Branch("bvst", &amp;bvst, "bvst/F");</span>
00709 <span class="comment">  tree-&gt;Branch("bvsp", &amp;bvsp, "bvsp/F");</span>
00710 <span class="comment">  tree-&gt;Branch("bvti", &amp;bvti, "bvti/I");</span>
00711 <span class="comment">  tree-&gt;Branch("bvtevt", &amp;bvtevt, "bvtevt/I");</span>
00712 <span class="comment">  tree-&gt;Branch("bvtd", &amp;bvtd, "bvtd/F");</span>
00713 <span class="comment">  tree-&gt;Branch("bvtt", &amp;bvtt, "bvtt/F");</span>
00714 <span class="comment">  tree-&gt;Branch("bvtp", &amp;bvtp, "bvtp/F");</span>
00715 <span class="comment">  */</span>
00716 
00717   tree-&gt;Branch(<span class="stringliteral">"evtph"</span>, &amp;evtph, <span class="stringliteral">"evtph/F"</span>);
00718   tree-&gt;Branch(<span class="stringliteral">"evtphgev"</span>, &amp;evtphgev, <span class="stringliteral">"evtphgev/F"</span>);
00719   
00720   tree-&gt;Branch(<span class="stringliteral">"evtsigfull"</span>, &amp;evtsigfull, <span class="stringliteral">"evtsigfull/F"</span>);
00721   tree-&gt;Branch(<span class="stringliteral">"evtsigpart"</span>, &amp;evtsigpart, <span class="stringliteral">"evtsigpart/F"</span>);
00722 
00723   tree-&gt;Branch(<span class="stringliteral">"trksigfull"</span>, &amp;trksigfull, <span class="stringliteral">"trksigfull/F"</span>);
00724   tree-&gt;Branch(<span class="stringliteral">"trksigpart"</span>, &amp;trksigpart, <span class="stringliteral">"trksigpart/F"</span>);
00725 
00726   tree-&gt;Branch(<span class="stringliteral">"evttimemin"</span>,&amp;evttimemin,<span class="stringliteral">"evttimemin/D"</span>);
00727   tree-&gt;Branch(<span class="stringliteral">"evttimemax"</span>,&amp;evttimemax,<span class="stringliteral">"evttimemax/D"</span>);
00728   tree-&gt;Branch(<span class="stringliteral">"evttimeln"</span>,&amp;evttimeln,<span class="stringliteral">"evttimeln/D"</span>);
00729 
00730   tree-&gt;Branch(<span class="stringliteral">"evttimeminphc"</span>,&amp;evttimeminphc,<span class="stringliteral">"evttimeminphc/D"</span>);
00731   tree-&gt;Branch(<span class="stringliteral">"evttimemaxphc"</span>,&amp;evttimemaxphc,<span class="stringliteral">"evttimemaxphc/D"</span>);
00732   tree-&gt;Branch(<span class="stringliteral">"evttimelnphc"</span>,&amp;evttimelnphc,<span class="stringliteral">"evttimelnphc/D"</span>);
00733 
00734   tree-&gt;Branch(<span class="stringliteral">"earlywph"</span>,&amp;earlywph,<span class="stringliteral">"earlywph/F"</span>);
00735   tree-&gt;Branch(<span class="stringliteral">"earlywphpw"</span>,&amp;earlywphpw,<span class="stringliteral">"earlywphpw/F"</span>);
00736   tree-&gt;Branch(<span class="stringliteral">"earlywphsphere"</span>,&amp;earlywphsphere,<span class="stringliteral">"earlywphsphere/F"</span>);
00737   tree-&gt;Branch(<span class="stringliteral">"ph1000"</span>,&amp;ph1000,<span class="stringliteral">"ph1000/F"</span>);
00738   tree-&gt;Branch(<span class="stringliteral">"ph500"</span>,&amp;ph500,<span class="stringliteral">"ph500/F"</span>);
00739   tree-&gt;Branch(<span class="stringliteral">"ph100"</span>,&amp;ph100,<span class="stringliteral">"ph100/F"</span>);
00740   tree-&gt;Branch(<span class="stringliteral">"lateph1000"</span>,&amp;lateph1000,<span class="stringliteral">"lateph1000/F"</span>);
00741   tree-&gt;Branch(<span class="stringliteral">"lateph500"</span>,&amp;lateph500,<span class="stringliteral">"lateph500/F"</span>);
00742   tree-&gt;Branch(<span class="stringliteral">"lateph100"</span>,&amp;lateph100,<span class="stringliteral">"lateph100/F"</span>);
00743   tree-&gt;Branch(<span class="stringliteral">"lateph50"</span>,&amp;lateph50,<span class="stringliteral">"lateph50/F"</span>);
00744 
00745   tree-&gt;Branch(<span class="stringliteral">"nduprs"</span>,&amp;nduprs,<span class="stringliteral">"ndubrs/I"</span>);
00746   tree-&gt;Branch(<span class="stringliteral">"dupphrs"</span>,&amp;dupphrs,<span class="stringliteral">"dupphrs/F"</span>);
00747 
00748   tree-&gt;Branch(<span class="stringliteral">"nss"</span>, nss, <span class="stringliteral">"nss[6]/I"</span>);
00749   tree-&gt;Branch(<span class="stringliteral">"ess"</span>, ess, <span class="stringliteral">"ess[6]/F"</span>);
00750   tree-&gt;Branch(<span class="stringliteral">"ntotss"</span>, &amp;ntotss, <span class="stringliteral">"ntotss/I"</span>);
00751 
00752   Float_t etu, etv, elu, elv;
00753   tree-&gt;Branch(<span class="stringliteral">"etu"</span>, &amp;etu, <span class="stringliteral">"etu/F"</span>); <span class="comment">// transveres u and v energy</span>
00754   tree-&gt;Branch(<span class="stringliteral">"etv"</span>, &amp;etv, <span class="stringliteral">"etv/F"</span>); <span class="comment">// uses subshowers</span>
00755   tree-&gt;Branch(<span class="stringliteral">"elu"</span>, &amp;elu, <span class="stringliteral">"elu/F"</span>); <span class="comment">// longitudinal energy</span>
00756   tree-&gt;Branch(<span class="stringliteral">"elv"</span>, &amp;elv, <span class="stringliteral">"elv/F"</span>);
00757 
00758   Float_t swu,swv,wswu,wswv; 
00759   tree-&gt;Branch(<span class="stringliteral">"swu"</span>,&amp;swu, <span class="stringliteral">"swu/F"</span>);<span class="comment">// shower width in u</span>
00760   tree-&gt;Branch(<span class="stringliteral">"swv"</span>,&amp;swv, <span class="stringliteral">"swv/F"</span>);<span class="comment">// shower width in u</span>
00761   tree-&gt;Branch(<span class="stringliteral">"wswu"</span>,&amp;wswu, <span class="stringliteral">"wswu/F"</span>);<span class="comment">// shower width in u</span>
00762   tree-&gt;Branch(<span class="stringliteral">"wswv"</span>,&amp;wswv, <span class="stringliteral">"wswv/F"</span>);<span class="comment">// shower width in u</span>
00763 
00764   <span class="comment">// beam energy weights</span>
00765   <span class="comment">// 1/E flux, le, z=050, z=100, z=200, z=250 cm</span>
00766   Float_t bec_inve, bec_le, bec_050, bec_100, bec_200, bec_250;
00767   
00768   tree-&gt;Branch(<span class="stringliteral">"bec_inve"</span>, &amp;bec_inve, <span class="stringliteral">"bec_inve/F"</span>);
00769   tree-&gt;Branch(<span class="stringliteral">"bec_le"</span>, &amp;bec_le, <span class="stringliteral">"bec_le/F"</span>);
00770   tree-&gt;Branch(<span class="stringliteral">"bec_050"</span>, &amp;bec_050, <span class="stringliteral">"bec_050/F"</span>);
00771   tree-&gt;Branch(<span class="stringliteral">"bec_100"</span>, &amp;bec_100, <span class="stringliteral">"bec_100/F"</span>);
00772   tree-&gt;Branch(<span class="stringliteral">"bec_200"</span>, &amp;bec_200, <span class="stringliteral">"bec_200/F"</span>);
00773   tree-&gt;Branch(<span class="stringliteral">"bec_250"</span>, &amp;bec_250, <span class="stringliteral">"bec_250/F"</span>);
00774 
00775   <span class="comment">//li time</span>
00776   tree-&gt;Branch(<span class="stringliteral">"litime"</span>,&amp;litime,<span class="stringliteral">"litime/D"</span>);
00777 
00778   <span class="comment">//demux status</span>
00779   tree-&gt;Branch(<span class="stringliteral">"dmx_stat"</span>,&amp;dmx_stat,<span class="stringliteral">"dmx_stat/b"</span>);
00780   tree-&gt;Branch(<span class="stringliteral">"lowphrat"</span>,&amp;lowphrat,<span class="stringliteral">"lowphrat/F"</span>);
00781 
00782   <span class="comment">// beam monitoring variables</span>
00783   Double_t hbw,vbw,hpos1,vpos1,hpos2,vpos2,hornI,closestspill;
00784   <span class="comment">//goodbeam==1 if spill meets criteria defined below </span>
00785   <span class="comment">//(see the line where goodbeam gets set)</span>
00786   <span class="comment">//beamcnf is a unsigned int as defined in BeamMonSpill::StatusBits</span>
00787   UInt_t beamcnf;
00788   <span class="comment">//leaving nuTarZ in until we've phased out the summary ntuples</span>
00789   Double_t nuTarZ;
00790   <span class="comment">//goodbeam==0 if spill doesnt meet these criteria</span>
00791   Int_t goodbeam;
00792 
00793   <span class="comment">//these next variables weren't available in the old beam monitoring ntuples</span>
00794   UInt_t horn_on, target_in, n_batches;
00795   Float_t tor101, tr101d, tortgt, trtgtd;
00796   Float_t hadmon, mumon1, mumon2, mumon3;
00797 
00798   tree-&gt;Branch(<span class="stringliteral">"hbw"</span>,&amp;hbw,<span class="stringliteral">"hbw/D"</span>);
00799   tree-&gt;Branch(<span class="stringliteral">"vbw"</span>,&amp;vbw,<span class="stringliteral">"vbw/D"</span>);
00800   tree-&gt;Branch(<span class="stringliteral">"hpos1"</span>,&amp;hpos1,<span class="stringliteral">"hpos1/D"</span>);
00801   tree-&gt;Branch(<span class="stringliteral">"vpos1"</span>,&amp;vpos1,<span class="stringliteral">"vpos1/D"</span>);
00802   tree-&gt;Branch(<span class="stringliteral">"hpos2"</span>,&amp;hpos2,<span class="stringliteral">"hpos2/D"</span>);
00803   tree-&gt;Branch(<span class="stringliteral">"vpos2"</span>,&amp;vpos2,<span class="stringliteral">"vpos2/D"</span>);
00804   tree-&gt;Branch(<span class="stringliteral">"hornI"</span>,&amp;hornI,<span class="stringliteral">"hornI/D"</span>);
00805   tree-&gt;Branch(<span class="stringliteral">"closestspill"</span>,&amp;closestspill,<span class="stringliteral">"closestspill/D"</span>);
00806   tree-&gt;Branch(<span class="stringliteral">"beamcnf"</span>,&amp;beamcnf,<span class="stringliteral">"beamcnf/i"</span>);
00807   tree-&gt;Branch(<span class="stringliteral">"nuTarZ"</span>,&amp;nuTarZ,<span class="stringliteral">"nuTarZ/D"</span>);
00808   tree-&gt;Branch(<span class="stringliteral">"goodbeam"</span>,&amp;goodbeam,<span class="stringliteral">"goodbeam/I"</span>);
00809   tree-&gt;Branch(<span class="stringliteral">"horn_on"</span>,&amp;horn_on,<span class="stringliteral">"horn_on/i"</span>);
00810   tree-&gt;Branch(<span class="stringliteral">"target_in"</span>,&amp;target_in,<span class="stringliteral">"target_in/i"</span>);
00811   tree-&gt;Branch(<span class="stringliteral">"n_batches"</span>,&amp;n_batches,<span class="stringliteral">"n_batches/i"</span>);
00812   tree-&gt;Branch(<span class="stringliteral">"tor101"</span>,&amp;tor101,<span class="stringliteral">"tor101/F"</span>);
00813   tree-&gt;Branch(<span class="stringliteral">"tr101d"</span>,&amp;tr101d,<span class="stringliteral">"tr101d/F"</span>);
00814   tree-&gt;Branch(<span class="stringliteral">"tortgt"</span>,&amp;tortgt,<span class="stringliteral">"tortgt/F"</span>);
00815   tree-&gt;Branch(<span class="stringliteral">"trtgtd"</span>,&amp;trtgtd,<span class="stringliteral">"trtgtd/F"</span>);
00816   tree-&gt;Branch(<span class="stringliteral">"hadmon"</span>,&amp;hadmon,<span class="stringliteral">"hadmon/F"</span>);
00817   tree-&gt;Branch(<span class="stringliteral">"mumon1"</span>,&amp;mumon1,<span class="stringliteral">"mumon1/F"</span>);
00818   tree-&gt;Branch(<span class="stringliteral">"mumon2"</span>,&amp;mumon2,<span class="stringliteral">"mumon2/F"</span>);
00819   tree-&gt;Branch(<span class="stringliteral">"mumon3"</span>,&amp;mumon3,<span class="stringliteral">"mumon3/F"</span>);
00820   
00821   <span class="comment">//coil status</span>
00822   Short_t coil_stat;
00823   tree-&gt;Branch(<span class="stringliteral">"coil_stat"</span>,&amp;coil_stat,<span class="stringliteral">"coil_stat/S"</span>);
00824   
00825 
00826   <span class="comment">//for bmpt reweighting</span>
00827   tree-&gt;Branch(<span class="stringliteral">"NuParent"</span>,<span class="stringliteral">"NuParent"</span>,&amp;nuparent,8000,1);
00828 
00829   <span class="comment">//gnumiflux info</span>
00830   Int_t      fluxrun;     <span class="comment">// gnumi flux run number</span>
00831   Int_t      fluxevtno;   <span class="comment">// gnumi flux event number</span>
00832   Float_t    nudxdz;       <span class="comment">// dx/dz slope, neutrino rndm decay</span>
00833   Float_t    nudydz;       <span class="comment">// dy/dz slope, neutrino rndm decay</span>
00834   Float_t    nupz;         <span class="comment">// Pz of neutrino (GeV)  rndm decay</span>
00835   Float_t    nuenergy;     <span class="comment">// E(neutrino)    (GeV)  rndm decay</span>
00836   Float_t    nudxdznear;   <span class="comment">// dx/dz slope, neutrino NearDet center</span>
00837   Float_t    nudydznear;   <span class="comment">// dy/dz slope, neutrino NearDet center</span>
00838   Float_t    nuenergynear;    <span class="comment">// E(neutrino)    (GeV)  NearDet center</span>
00839   Float_t    nwtnear;     <span class="comment">// Weight of nu          NearDet center</span>
00840   Float_t    nudxdzfar;    <span class="comment">// dx/dz slope, neutrino FarDet center</span>
00841   Float_t    nudydzfar;    <span class="comment">// dy/dz slope, neutrino FarDet center</span>
00842   Float_t    nuenergyfar;    <span class="comment">// E(neutrino)    (GeV)  FarDet center</span>
00843   Float_t    nwtfar;      <span class="comment">// Weight of nu          FarDet center</span>
00844   Int_t      norig;       <span class="comment">// (ignore)</span>
00845   Int_t      ndecay;      <span class="comment">// Tag of decay mode</span>
00846   Int_t      ntype;       <span class="comment">// Neutrino type (translated to PDG)</span>
00847   Float_t    vx;          <span class="comment">// x vertex of hadron (cm)</span>
00848   Float_t    vy;          <span class="comment">// y vertex of hadron (cm)</span>
00849   Float_t    vz;          <span class="comment">// z vertex of hadron (cm)</span>
00850   Float_t    pdpx;        <span class="comment">// nu parent px at decay point</span>
00851   Float_t    pdpy;        <span class="comment">// nu parent py at decay point</span>
00852   Float_t    pdpz;        <span class="comment">// nu parent pz at decay point</span>
00853   Float_t    ppdxdz;      <span class="comment">// nu parent slope at production</span>
00854   Float_t    ppdydz;      <span class="comment">// nu parent slope at production</span>
00855   Float_t    pppz;        <span class="comment">// nu parent pz at production</span>
00856   Float_t    ppenergy;    <span class="comment">// nu parent energy at production</span>
00857   Int_t      ppmedium;    <span class="comment">// GEANT medium of nu parent at parent production</span>
00858   Int_t      ptype;       <span class="comment">// nu parent type (translated to PDG)</span>
00859   Float_t    ppvx;        <span class="comment">// nu parent production vtx x</span>
00860   Float_t    ppvy;        <span class="comment">// nu parent production vtx y</span>
00861   Float_t    ppvz;        <span class="comment">// nu parent production vtx z</span>
00862   Float_t    muparpx;     <span class="comment">// if parent=mu, hadron parent px</span>
00863   Float_t    muparpy;     <span class="comment">// if parent=mu, hadron parent py</span>
00864   Float_t    muparpz;     <span class="comment">// if parent=mu, hadron parent pz</span>
00865   Float_t    mupare;      <span class="comment">// if parent=mu, hadron parent energy</span>
00866   Float_t    necm;        <span class="comment">// E(nu) in parent cm</span>
00867   Float_t    nimpwt;      <span class="comment">// importance weight</span>
00868   Float_t    xpoint;      <span class="comment">// (unused)</span>
00869   Float_t    ypoint;      <span class="comment">// (unused)</span>
00870   Float_t    zpoint;      <span class="comment">// (unused)</span>
00871   Float_t    tvx;         <span class="comment">// target exit point (x) of parent</span>
00872   Float_t    tvy;         <span class="comment">// target exit point (y) of parent</span>
00873   Float_t    tvz;         <span class="comment">// target exit point (z) of parent</span>
00874   Float_t    tpx;         <span class="comment">// parent px at target exit</span>
00875   Float_t    tpy;         <span class="comment">// parent py at target exit</span>
00876   Float_t    tpz;         <span class="comment">// parent pz at target exit</span>
00877   Int_t      tptype;      <span class="comment">// parent particle type (translated to PDG)</span>
00878   Int_t      tgen;        <span class="comment">// parent generation in cascade</span>
00879 
00880   tree-&gt;Branch(<span class="stringliteral">"fluxrun"</span>,&amp;fluxrun,<span class="stringliteral">"fluxrun/I"</span>);
00881   tree-&gt;Branch(<span class="stringliteral">"fluxevtno"</span>,&amp;fluxevtno,<span class="stringliteral">"fluxevtno/I"</span>);
00882   tree-&gt;Branch(<span class="stringliteral">"nudxdz"</span>,&amp;nudxdz,<span class="stringliteral">"nudxdz/F"</span>);
00883   tree-&gt;Branch(<span class="stringliteral">"nudydz"</span>,&amp;nudydz,<span class="stringliteral">"nudydz/F"</span>);
00884   tree-&gt;Branch(<span class="stringliteral">"nupz"</span>,&amp;nupz,<span class="stringliteral">"nupz/F"</span>);
00885   tree-&gt;Branch(<span class="stringliteral">"nuenergy"</span>,&amp;nuenergy,<span class="stringliteral">"nuenergy/F"</span>);
00886   tree-&gt;Branch(<span class="stringliteral">"nudxdznear"</span>,&amp;nudxdznear,<span class="stringliteral">"nudxdznear/F"</span>);
00887   tree-&gt;Branch(<span class="stringliteral">"nudydznear"</span>,&amp;nudydznear,<span class="stringliteral">"nudydznear/F"</span>);
00888   tree-&gt;Branch(<span class="stringliteral">"nuenergynear"</span>,&amp;nuenergynear,<span class="stringliteral">"nuenergynear/F"</span>);
00889   tree-&gt;Branch(<span class="stringliteral">"nwtnear"</span>,&amp;nwtnear,<span class="stringliteral">"nwtnear/F"</span>);
00890   tree-&gt;Branch(<span class="stringliteral">"nudxdzfar"</span>,&amp;nudxdzfar,<span class="stringliteral">"nudxdzfar/F"</span>);
00891   tree-&gt;Branch(<span class="stringliteral">"nudydzfar"</span>,&amp;nudydzfar,<span class="stringliteral">"nudydzfar/F"</span>);
00892   tree-&gt;Branch(<span class="stringliteral">"nuenergyfar"</span>,&amp;nuenergyfar,<span class="stringliteral">"nuenergyfar/F"</span>);
00893   tree-&gt;Branch(<span class="stringliteral">"nwtfar"</span>,&amp;nwtfar,<span class="stringliteral">"nwtfar/F"</span>);
00894   tree-&gt;Branch(<span class="stringliteral">"norig"</span>,&amp;norig,<span class="stringliteral">"norig/I"</span>);
00895   tree-&gt;Branch(<span class="stringliteral">"ndecay"</span>,&amp;ndecay,<span class="stringliteral">"ndecay/I"</span>);
00896   tree-&gt;Branch(<span class="stringliteral">"ntype"</span>,&amp;ntype,<span class="stringliteral">"ntype/I"</span>);
00897   tree-&gt;Branch(<span class="stringliteral">"vx"</span>,&amp;vx,<span class="stringliteral">"vx/F"</span>);
00898   tree-&gt;Branch(<span class="stringliteral">"vy"</span>,&amp;vy,<span class="stringliteral">"vy/F"</span>);
00899   tree-&gt;Branch(<span class="stringliteral">"vz"</span>,&amp;vz,<span class="stringliteral">"vz/F"</span>);
00900   tree-&gt;Branch(<span class="stringliteral">"pdpx"</span>,&amp;pdpx,<span class="stringliteral">"pdpx/F"</span>);
00901   tree-&gt;Branch(<span class="stringliteral">"pdpy"</span>,&amp;pdpy,<span class="stringliteral">"pdpy/F"</span>);
00902   tree-&gt;Branch(<span class="stringliteral">"pdpz"</span>,&amp;pdpz,<span class="stringliteral">"pdpz/F"</span>);
00903   tree-&gt;Branch(<span class="stringliteral">"ppdxdz"</span>,&amp;ppdxdz,<span class="stringliteral">"ppdxdz/F"</span>);
00904   tree-&gt;Branch(<span class="stringliteral">"ppdydz"</span>,&amp;ppdydz,<span class="stringliteral">"ppdydz/F"</span>);
00905   tree-&gt;Branch(<span class="stringliteral">"pppz"</span>,&amp;pppz,<span class="stringliteral">"pppz/F"</span>);
00906   tree-&gt;Branch(<span class="stringliteral">"ppenergy"</span>,&amp;ppenergy,<span class="stringliteral">"ppenergy/F"</span>);
00907   tree-&gt;Branch(<span class="stringliteral">"ppmedium"</span>,&amp;ppmedium,<span class="stringliteral">"ppmedium/I"</span>);
00908   tree-&gt;Branch(<span class="stringliteral">"ptype"</span>,&amp;ptype,<span class="stringliteral">"ptype/I"</span>);
00909   tree-&gt;Branch(<span class="stringliteral">"ppvx"</span>,&amp;ppvx,<span class="stringliteral">"ppvx/F"</span>);
00910   tree-&gt;Branch(<span class="stringliteral">"ppvy"</span>,&amp;ppvy,<span class="stringliteral">"ppvy/F"</span>);
00911   tree-&gt;Branch(<span class="stringliteral">"ppvz"</span>,&amp;ppvz,<span class="stringliteral">"ppvz/F"</span>);
00912   tree-&gt;Branch(<span class="stringliteral">"muparpx"</span>,&amp;muparpx,<span class="stringliteral">"muparpx/F"</span>);
00913   tree-&gt;Branch(<span class="stringliteral">"muparpy"</span>,&amp;muparpy,<span class="stringliteral">"muparpy/F"</span>);
00914   tree-&gt;Branch(<span class="stringliteral">"muparpz"</span>,&amp;muparpz,<span class="stringliteral">"muparpz/F"</span>);
00915   tree-&gt;Branch(<span class="stringliteral">"mupare"</span>,&amp;mupare,<span class="stringliteral">"mupare/F"</span>);
00916   tree-&gt;Branch(<span class="stringliteral">"necm"</span>,&amp;necm,<span class="stringliteral">"necm/F"</span>);
00917   tree-&gt;Branch(<span class="stringliteral">"nimpwt"</span>,&amp;nimpwt,<span class="stringliteral">"nimpwt/F"</span>);
00918   tree-&gt;Branch(<span class="stringliteral">"xpoint"</span>,&amp;xpoint,<span class="stringliteral">"xpoint/F"</span>);
00919   tree-&gt;Branch(<span class="stringliteral">"ypoint"</span>,&amp;ypoint,<span class="stringliteral">"ypoint/F"</span>);
00920   tree-&gt;Branch(<span class="stringliteral">"zpoint"</span>,&amp;zpoint,<span class="stringliteral">"zpoint/F"</span>);
00921   tree-&gt;Branch(<span class="stringliteral">"tvx"</span>,&amp;tvx,<span class="stringliteral">"tvx/F"</span>);
00922   tree-&gt;Branch(<span class="stringliteral">"tvy"</span>,&amp;tvy,<span class="stringliteral">"tvy/F"</span>);
00923   tree-&gt;Branch(<span class="stringliteral">"tvz"</span>,&amp;tvz,<span class="stringliteral">"tvz/F"</span>);
00924   tree-&gt;Branch(<span class="stringliteral">"tpx"</span>,&amp;tpx,<span class="stringliteral">"tpx/F"</span>);
00925   tree-&gt;Branch(<span class="stringliteral">"tpy"</span>,&amp;tpy,<span class="stringliteral">"tpy/F"</span>);
00926   tree-&gt;Branch(<span class="stringliteral">"tpz"</span>,&amp;tpz,<span class="stringliteral">"tpz/F"</span>);
00927   tree-&gt;Branch(<span class="stringliteral">"tptype"</span>,&amp;tptype,<span class="stringliteral">"tptype/I"</span>);
00928   tree-&gt;Branch(<span class="stringliteral">"tgen"</span>,&amp;tgen,<span class="stringliteral">"tgen/I"</span>);
00929   
00930   <span class="comment">//pot counting</span>
00931   <span class="keywordtype">float</span> pottor101=0.;
00932   <span class="keywordtype">float</span> pottortgt=0.;
00933   <span class="keywordtype">float</span> pot=0.;
00934   <span class="keywordtype">int</span> NRUNS=0;
00935   <span class="keywordtype">int</span> NSNARLS=0;
00936   TTree *pottree = <span class="keyword">new</span> TTree(<span class="stringliteral">"pottree"</span>,<span class="stringliteral">"pottree"</span>);
00937   pottree-&gt;Branch(<span class="stringliteral">"pot"</span>,&amp;pot,<span class="stringliteral">"pot/F"</span>);
00938   pottree-&gt;Branch(<span class="stringliteral">"pottor101"</span>,&amp;pottor101,<span class="stringliteral">"pottor101/F"</span>);
00939   pottree-&gt;Branch(<span class="stringliteral">"pottortgt"</span>,&amp;pottortgt,<span class="stringliteral">"pottortgt/F"</span>);
00940   pottree-&gt;Branch(<span class="stringliteral">"nruns"</span>,&amp;NRUNS,<span class="stringliteral">"nruns/I"</span>);
00941   pottree-&gt;Branch(<span class="stringliteral">"nsnarls"</span>,&amp;NSNARLS,<span class="stringliteral">"nsnarls/I"</span>);
00942 
00943   <span class="comment">//make a BMSpillAna so we can tell if it's goodbeam</span>
00944   <a class="code" href="classBMSpillAna.html">BMSpillAna</a> bmana;
00945 
00946 
00950   TTree* inukerw = 0;
00951   <span class="keywordtype">int</span> n_inuke_wts=0;
00952   <span class="keywordtype">float</span>* inuke_wts=0;
00953   <span class="keywordtype">double</span> nucrad=-1.0;
00954   <span class="keywordtype">double</span> wrad=1.0;
00955   std::vector&lt;inuke_reweight::parameter_set&gt; psets;
00956   
00957   <span class="keywordflow">if</span>(file_is_mc &amp;&amp; <a class="code" href="classMadMKAnalysis.html#r3">fDoInukeReweight</a>){
00958     
00959     <a class="code" href="classinuke__reweight_1_1parameter__set.html">inuke_reweight::parameter_set</a> sigmas;
00960 
00961     <a class="code" href="classneugen__config.html">neugen_config</a> nc(<span class="stringliteral">"MODBYRS"</span>);
00962     nc.<a class="code" href="classneugen__config.html#a5">set_config_no</a>(4);
00963     <a class="code" href="classneugen__wrapper.html">neugen_wrapper</a> nw(&amp;nc);
00964     nw.<a class="code" href="classneugen__wrapper.html#a18">print_configuration</a>();
00965     <a class="code" href="MsgRootDummies_8cxx.html#a0">gSystem</a>-&gt;Setenv(<span class="stringliteral">"NEUGEN3_XSEC"</span>,<span class="stringliteral">"MODBYRS4_xsec.dat"</span>);
00966     nw.<a class="code" href="classneugen__wrapper.html#a19">begin_generation</a>();
00967 
00968     <span class="comment">/*    </span>
00969 <span class="comment">    sigmas.pi_fate.inel=0.2;</span>
00970 <span class="comment">    sigmas.pi_fate.abs=0.25;</span>
00971 <span class="comment">    sigmas.pi_scale.ft=0.5;</span>
00972 <span class="comment">    sigmas.pi_scale.xsec=0.1;    </span>
00973 <span class="comment">    //    sigmas.pn_scale.ft=0.5;</span>
00974 <span class="comment">    sigmas.pn_scale.xsec=0.1;</span>
00975 <span class="comment">    */</span>
00976 
00977     sigmas.<a class="code" href="classinuke__reweight_1_1parameter__set.html#o0">pi_fate</a>.<a class="code" href="classinuke__reweight_1_1delta__fate.html#o1">elas</a>=0.1;
00978     sigmas.<a class="code" href="classinuke__reweight_1_1parameter__set.html#o0">pi_fate</a>.<a class="code" href="classinuke__reweight_1_1delta__fate.html#o2">inel</a>=0.4;
00979     sigmas.<a class="code" href="classinuke__reweight_1_1parameter__set.html#o0">pi_fate</a>.<a class="code" href="classinuke__reweight_1_1delta__fate.html#o3">abs</a>=0.3;
00980     sigmas.<a class="code" href="classinuke__reweight_1_1parameter__set.html#o0">pi_fate</a>.<a class="code" href="classinuke__reweight_1_1delta__fate.html#o0">cex</a>=0.49;
00981     sigmas.<a class="code" href="classinuke__reweight_1_1parameter__set.html#o0">pi_fate</a>.<a class="code" href="classinuke__reweight_1_1delta__fate.html#o8">piprod</a>=0.2;
00982 
00983     sigmas.<a class="code" href="classinuke__reweight_1_1parameter__set.html#o2">pi_scale</a>.<a class="code" href="classinuke__reweight_1_1delta__scale.html#o2">xsec</a>=0.1;
00984 
00985     sigmas.<a class="code" href="classinuke__reweight_1_1parameter__set.html#o1">pn_fate</a>.<a class="code" href="classinuke__reweight_1_1delta__fate.html#o3">abs</a>=0.2;
00986     sigmas.<a class="code" href="classinuke__reweight_1_1parameter__set.html#o1">pn_fate</a>.<a class="code" href="classinuke__reweight_1_1delta__fate.html#o8">piprod</a>=0.2;
00987 
00988     sigmas.<a class="code" href="classinuke__reweight_1_1parameter__set.html#o3">pn_scale</a>.<a class="code" href="classinuke__reweight_1_1delta__scale.html#o2">xsec</a>=0.1;
00989 
00990     sigmas.<a class="code" href="classinuke__reweight_1_1parameter__set.html#o2">pi_scale</a>.<a class="code" href="classinuke__reweight_1_1delta__scale.html#o1">ft</a>=0.5; <span class="comment">// apply to both pi and p</span>
00991 
00992     std::cout&lt;&lt;<span class="stringliteral">"Inuke Reweight sigmas: "</span>&lt;&lt;std::endl;
00993     sigmas.<a class="code" href="classinuke__reweight_1_1parameter__set.html#a0">print</a>(std::cout);
00994 
00995     <span class="keywordflow">if</span>(<a class="code" href="classMadMKAnalysis.html#r5">fNRandomSets</a>&lt;=0) {
00996       <a class="code" href="namespaceinuke__reweight.html#a20">inuke_reweight::generate_1sigma_shifts</a>(sigmas,psets);    
00997       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iset=0; iset&lt;psets.size(); iset++){
00998         psets[iset].pi_fate.set_abs_fates();
00999         psets[iset].pn_fate.set_abs_fates();
01000         psets[iset].pn_scale.ft=psets[iset].pi_scale.ft; <span class="comment">// pi,pn same Ftime</span>
01001         <span class="comment">// correlate change in pn xsec with change in pn elastic fate</span>
01002         <span class="keywordflow">if</span>(psets[iset].pn_scale.xsec!=0) {
01003           psets[iset].pn_fate.elas = 2.0*psets[iset].pn_scale.xsec;
01004         }
01005       }
01006     }
01007     <span class="keywordflow">else</span>{
01008       <a class="code" href="classinuke__reweight_1_1parameter__limits.html">inuke_reweight::parameter_limits</a> limits(sigmas,2.0);
01009       limits.<a class="code" href="classinuke__reweight_1_1parameter__limits.html#o0">upper</a>.<a class="code" href="classinuke__reweight_1_1parameter__set.html#o2">pi_scale</a>.<a class="code" href="classinuke__reweight_1_1delta__scale.html#o1">ft</a>=0.5;  <span class="comment">// special case, 1 sigma, but uniform dist</span>
01010       limits.<a class="code" href="classinuke__reweight_1_1parameter__limits.html#o1">lower</a>.<a class="code" href="classinuke__reweight_1_1parameter__set.html#o2">pi_scale</a>.<a class="code" href="classinuke__reweight_1_1delta__scale.html#o1">ft</a>=-0.5;
01011       std::cout&lt;&lt;<span class="stringliteral">"Inuke Reweight Limits: "</span>&lt;&lt;std::endl;
01012       limits.<a class="code" href="classinuke__reweight_1_1parameter__limits.html#a2">print</a>(std::cout);
01013       gRandom-&gt;SetSeed(1);
01014       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classMadMKAnalysis.html#r5">fNRandomSets</a>; i++){
01015         <a class="code" href="classinuke__reweight_1_1parameter__set.html">inuke_reweight::parameter_set</a> p;
01016         <a class="code" href="namespaceinuke__reweight.html#a21">inuke_reweight::generate_uncor_shifts</a>(sigmas,limits,p);
01017         psets.push_back(p);
01018       }
01019       <span class="comment">// massage parameters</span>
01020       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> iset=0; iset&lt;fNRandomSets; iset++){
01021         psets[iset].pi_fate.set_abs_fates();
01022         psets[iset].pn_fate.set_abs_fates();
01023         psets[iset].pn_scale.ft=psets[iset].pi_scale.ft; <span class="comment">// pi,pn same Ftime</span>
01024         <span class="comment">// correlate change in pn xsec with change in pn elastic fate</span>
01025         <span class="keywordflow">if</span>(psets[iset].pn_scale.xsec!=0) {
01026           psets[iset].pn_fate.elas = 2.0*psets[iset].pn_scale.xsec;
01027         }
01028       }
01029 
01030 
01031     }
01032 
01033     n_inuke_wts=psets.size();
01034     inuke_wts = <span class="keyword">new</span> <span class="keywordtype">float</span>[n_inuke_wts];
01035     
01036     <span class="comment">//    inukerw = new TTree("inukerw","intranuke weights");</span>
01037     inukerw=tree;
01038     inukerw-&gt;Branch(<span class="stringliteral">"r"</span>,&amp;run,<span class="stringliteral">"r/I"</span>);
01039     inukerw-&gt;Branch(<span class="stringliteral">"s"</span>,&amp;snarl,<span class="stringliteral">"s/I"</span>);
01040     inukerw-&gt;Branch(<span class="stringliteral">"e"</span>,&amp;event,<span class="stringliteral">"e/I"</span>);
01041     inukerw-&gt;Branch(<span class="stringliteral">"nwts"</span>,&amp;n_inuke_wts,<span class="stringliteral">"nwts/I"</span>);
01042     inukerw-&gt;Branch(<span class="stringliteral">"wts"</span>,inuke_wts,<span class="stringliteral">"wts[nwts]/F"</span>);          
01043     inukerw-&gt;Branch(<span class="stringliteral">"nucrad"</span>,&amp;nucrad,<span class="stringliteral">"nucrad/D"</span>);
01044     inukerw-&gt;Branch(<span class="stringliteral">"wrad"</span>,&amp;wrad,<span class="stringliteral">"wrad/D"</span>);
01045 
01046     <span class="comment">// save psets</span>
01047     <span class="comment">// 9*2 fates + 3*2 scales = 24</span>
01048     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ipar=0; ipar&lt;24; ipar++){
01049       TVectorD* vptr = <span class="keyword">new</span> TVectorD(n_inuke_wts);
01050       inukerw-&gt;GetUserInfo()-&gt;Add(vptr);
01051     }
01052     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> iset=0; iset&lt;n_inuke_wts; iset++){
01053       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ipar=0; ipar&lt;24; ipar++){ 
01054         TVectorD* vptr = 
01055           dynamic_cast&lt;TVectorD*&gt;(inukerw-&gt;GetUserInfo()-&gt;At(ipar));    
01056         (*vptr)[iset]=psets[iset].get_par(ipar);
01057       }      
01058     }
01059 
01060 
01061   }
01062 
01066 
01067 
01068   <span class="comment">//  map&lt;VldTimeStamp, BeamMonTV&gt;* beam_mon_map=0;</span>
01069   <span class="comment">//  if(!file_is_mc) beam_mon_map = new BeamMonMap::MakeBeamMonMap(bmonpath);</span>
01070   <span class="comment">//  map&lt;VldTimeStamp, BeamMonTV&gt; beam_mon_map</span>
01071   <span class="comment">//    =BeamMonMap::MakeBeamMonMap(bmonpath);</span>
01072   <span class="comment">//  std::cout&lt;&lt;"map file: "&lt;&lt;bmonpath&lt;&lt;std::endl;</span>
01073   <span class="comment">//  std::cout&lt;&lt;"map size: "&lt;&lt;beam_mon_map.size()&lt;&lt;std::endl;</span>
01074 
01080   <a class="code" href="classBeamEnergyCalculator.html">BeamEnergyCalculator</a> ecalc(&amp;fBECConfig);
01081   <span class="keywordtype">double</span> bec_high=0; <span class="keywordtype">double</span> bec_low=0;
01082   ecalc.<a class="code" href="classWeightCalculator.html#a8">GetStandardConfig</a>()-&gt;<a class="code" href="classRegistry.html#a12">Print</a>();
01083   ecalc.<a class="code" href="classWeightCalculator.html#a8">GetStandardConfig</a>()-&gt;<a class="code" href="classRegistry.html#a24">Get</a>(<span class="stringliteral">"beam:high_energy_limit"</span>,bec_high);
01084   ecalc.<a class="code" href="classWeightCalculator.html#a8">GetStandardConfig</a>()-&gt;<a class="code" href="classRegistry.html#a24">Get</a>(<span class="stringliteral">"beam:low_energy_limit"</span>,bec_low);
01085 
01086   <span class="comment">// mark's QE id</span>
01087   <span class="comment">//  MadQEID qeid;</span>
01088   <span class="comment">//  qeid.ReadPDFs("/afs/fnal.gov/files/data/minos/d04/kordosky/madqe_files/QEpdfs.root");</span>
01089 
01090   
01092   <span class="comment">//  bool beamdb=false;</span>
01093   <span class="comment">//  bool checkeddb=false;</span>
01094   <span class="keywordtype">int</span> lastrun=-1;
01095   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ii=0;ii&lt;<a class="code" href="classMadBase.html#p36">Nentries</a>;ii++){   
01096     <span class="keywordflow">if</span>(ii%1000==0) std::cout &lt;&lt; float(ii)*100./float(Nentries) 
01097                             &lt;&lt; <span class="stringliteral">"% done"</span> &lt;&lt; std::endl;
01098 
01099     <span class="keywordflow">if</span>(!this-&gt;<a class="code" href="classMadBase.html#a3">GetEntry</a>(ii)) <span class="keywordflow">continue</span>;
01100     NSNARLS++;
01101     <span class="comment">// fill some histograms for mc acceptance</span>
01102     <span class="keywordflow">if</span>(file_is_mc) <a class="code" href="classMadMKAnalysis.html#a9">FillMCHists</a>(&amp;save);
01103 
01104     <span class="comment">/*</span>
01105 <span class="comment">    if(!checkeddb){</span>
01106 <span class="comment">      //      ntpHeader-&gt;GetVldContext().Print();</span>
01107 <span class="comment">      //      cout&lt;&lt;"IM HERE!!!!"&lt;&lt;endl;</span>
01108 <span class="comment">      DbiResultPtr&lt;BeamMonSpill&gt; testbs(ntpHeader-&gt;GetVldContext(), </span>
01109 <span class="comment">                                        Dbi::kDefaultTask, </span>
01110 <span class="comment">                                        Dbi::kDisabled);</span>
01111 <span class="comment">      //      cout&lt;&lt;"tried to get the dbiresult ptr"&lt;&lt;endl;</span>
01112 <span class="comment">      checkeddb=true;</span>
01113 <span class="comment">      //      cout&lt;&lt;"****************checking for beam monitoring db:"&lt;&lt;endl;</span>
01114 <span class="comment">      if(testbs.GetNumRows()&gt;0){</span>
01115 <span class="comment">        beamdb=true;</span>
01116 <span class="comment">        cout&lt;&lt;"Found the Beam Monitoring Database Tables"&lt;&lt;endl;</span>
01117 <span class="comment">      }</span>
01118 <span class="comment">      else{     </span>
01119 <span class="comment">        cout&lt;&lt;"Didn't find the Beam Monitoring Database Tables"&lt;&lt;endl;</span>
01120 <span class="comment">        cout&lt;&lt;"Resorting to old beamsummary ntuples"&lt;&lt;endl;</span>
01121 <span class="comment">      }</span>
01122 <span class="comment">    }</span>
01123 <span class="comment">    */</span>
01124 
01125     nevent = <a class="code" href="classMadBase.html#p10">eventSummary</a>-&gt;<a class="code" href="classNtpSREventSummary.html#o6">nevent</a>;
01126     <a class="code" href="do__extrap_8h.html#a34">run</a> = <a class="code" href="classMadBase.html#p8">ntpHeader</a>-&gt;<a class="code" href="classRecDataHeader.html#a3">GetRun</a>();
01127     <span class="keywordflow">if</span>(<a class="code" href="do__extrap_8h.html#a34">run</a>!=lastrun){
01128       NRUNS++;
01129       lastrun = <a class="code" href="do__extrap_8h.html#a34">run</a>;
01130     }
01131     snarl = <a class="code" href="classMadBase.html#p8">ntpHeader</a>-&gt;<a class="code" href="classRecPhysicsHeader.html#a3">GetSnarl</a>();
01132     subrun = <a class="code" href="classMadBase.html#p8">ntpHeader</a>-&gt;<a class="code" href="classRecDataHeader.html#a4">GetSubRun</a>();
01133     trgsrc = <a class="code" href="classMadBase.html#p8">ntpHeader</a>-&gt;<a class="code" href="classRecPhysicsHeader.html#a4">GetTrigSrc</a>();
01134     spilltype = <a class="code" href="classMadBase.html#p8">ntpHeader</a>-&gt;<a class="code" href="classRecPhysicsHeader.html#a6">GetRemoteSpillType</a>();
01135     trgtime = <a class="code" href="classMadBase.html#p10">eventSummary</a>-&gt;<a class="code" href="classNtpSREventSummary.html#o7">trigtime</a>;
01136     litime = <a class="code" href="classMadBase.html#p10">eventSummary</a>-&gt;<a class="code" href="classNtpSREventSummary.html#o8">litime</a>;
01137     coil_stat = <a class="code" href="classMadBase.html#p12">detStatus</a>-&gt;<a class="code" href="classNtpSRDetStatus.html#o0">coilstatus</a>;
01138     dmx_stat=0;
01139 
01140     <span class="comment">//figure out demux status</span>
01141     dmx_stat+=(<a class="code" href="classMadBase.html#p11">dmxStatus</a>-&gt;<a class="code" href="classNtpSRDmxStatus.html#o1">nonphysicalfail</a>);
01142     dmx_stat+=((<a class="code" href="classMadBase.html#p11">dmxStatus</a>-&gt;<a class="code" href="classNtpSRDmxStatus.html#o2">validplanesfail</a>&lt;&lt;1));
01143     dmx_stat+=((<a class="code" href="classMadBase.html#p11">dmxStatus</a>-&gt;<a class="code" href="classNtpSRDmxStatus.html#o3">vertexplanefail</a>&lt;&lt;2));
01144 
01145     <span class="comment">//figure out how much of snarl ph was deposited as low ph</span>
01146     lowphrat=0.;
01147     lowphrat = <a class="code" href="classMadMKAnalysis.html#b18">ComputeLowPHRatio</a>();
01148 
01150     <span class="comment">// look through "events" and characterize how close together</span>
01151     <span class="comment">// their vertices are</span>
01152     <span class="comment">// idea is to flag runt events caused by late activity near vertex</span>
01154 <span class="comment"></span>    <a class="code" href="classNearbyVertexFinder.html">NearbyVertexFinder</a> nby(nevent);
01155     nby.<a class="code" href="classNearbyVertexFinder.html#a6">ProcessEntry</a>(<span class="keyword">this</span>);
01156 
01157 
01158     detector = -1; 
01159     <span class="comment">//get detector type:</span>
01160     <span class="keyword">const</span> <a class="code" href="classDetector.html#w0">Detector::Detector_t</a> det 
01161       = <a class="code" href="classMadBase.html#p8">ntpHeader</a>-&gt;<a class="code" href="classRecHeader.html#a3">GetVldContext</a>().<a class="code" href="classVldContext.html#a4">GetDetector</a>();
01162     <span class="keywordflow">if</span>(det==<a class="code" href="classDetector.html#w8w3">Detector::kFar</a>){
01163       detector = 2;
01164     }
01165     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(det==<a class="code" href="classDetector.html#w8w2">Detector::kNear</a>){
01166       detector = 1;     
01167     }
01168     <span class="comment">// deal with beam type as best we can</span>
01169     <a class="code" href="namespaceBeamType.html#a0">BeamType::BeamType_t</a> current_beam=BeamType::kUnknown;
01170     <span class="keywordflow">if</span>(file_is_mc){
01171       <span class="comment">// for MC set beam to fMCbeam</span>
01172       current_beam=<a class="code" href="classMadMKAnalysis.html#r1">fMCBeam</a>;
01173       <span class="comment">// for data we will try to deduce from beam monitoring</span>
01174     }
01175 
01176 
01178     <span class="comment">// first thing, if data do beam monitoring</span>
01180 <span class="comment"></span>    hbw=vbw=hpos1=vpos1=hpos2=vpos2=hornI=closestspill=0.0;
01181     beamcnf=0;
01182     nuTarZ=0.0;
01183     goodbeam=0;
01184     horn_on=target_in=n_batches=0;
01185     tor101=tr101d=tortgt=trtgtd=0.0;
01186     hadmon=mumon1=mumon2=mumon3=0.0;  
01187 
01188     <span class="keywordflow">if</span>(!file_is_mc){
01189       <a class="code" href="classVldContext.html">VldContext</a> vc = <a class="code" href="classMadBase.html#p8">ntpHeader</a>-&gt;<a class="code" href="classRecHeader.html#a3">GetVldContext</a>();
01190       <a class="code" href="classVldTimeStamp.html">VldTimeStamp</a> vts = vc.<a class="code" href="classVldContext.html#a6">GetTimeStamp</a>();
01191       <span class="comment">//      if(beamdb){</span>
01192       <a class="code" href="classBDSpillAccessor.html">BDSpillAccessor</a> &amp;sa = <a class="code" href="classBDSpillAccessor.html#e0">BDSpillAccessor::Get</a>();
01193       <span class="keyword">const</span> <a class="code" href="classBeamMonSpill.html">BeamMonSpill</a> *bs = sa.<a class="code" href="classBDSpillAccessor.html#a2">LoadSpill</a>(vts);
01194       hbw=bs-&gt;<a class="code" href="classBeamMonSpill.html#o12">fProfWidX</a>*1000.;<span class="comment">//make it in mm</span>
01195       vbw=bs-&gt;<a class="code" href="classBeamMonSpill.html#o13">fProfWidY</a>*1000.;<span class="comment">//make it in mm</span>
01196       hpos1=bs-&gt;<a class="code" href="classBeamMonSpill.html#o10">fTargProfX</a>*1000.;<span class="comment">//make it in mm</span>
01197       vpos1=bs-&gt;<a class="code" href="classBeamMonSpill.html#o11">fTargProfY</a>*1000.;<span class="comment">//make it in mm</span>
01198       n_batches=0;
01199       <span class="keywordtype">float</span> btint=0.;
01200       hpos2=0.;
01201       vpos2=0.;
01202       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> bt=0;bt&lt;6;bt++){
01203         <span class="comment">//cout&lt;&lt;"batch "&lt;&lt;bt&lt;&lt;" x "&lt;&lt;bs-&gt;fTargBpmX[bt]&lt;&lt;" y "&lt;&lt;bs-&gt;fTargBpmY[bt]</span>
01204         <span class="comment">//              &lt;&lt;" int "&lt;&lt;bs-&gt;fBpmInt[bt]&lt;&lt;endl;</span>
01205         hpos2+=(bs-&gt;<a class="code" href="classBeamMonSpill.html#o7">fTargBpmX</a>[bt]*bs-&gt;<a class="code" href="classBeamMonSpill.html#o9">fBpmInt</a>[bt]);
01206         vpos2+=(bs-&gt;<a class="code" href="classBeamMonSpill.html#o8">fTargBpmY</a>[bt]*bs-&gt;<a class="code" href="classBeamMonSpill.html#o9">fBpmInt</a>[bt]);
01207         <span class="keywordflow">if</span>(bs-&gt;<a class="code" href="classBeamMonSpill.html#o9">fBpmInt</a>[bt]&gt;0.001){
01208           n_batches++;
01209         }
01210         btint+=bs-&gt;<a class="code" href="classBeamMonSpill.html#o9">fBpmInt</a>[bt];
01211       }
01212       <span class="keywordflow">if</span>(btint!=0){
01213         hpos2=hpos2*1000./btint;<span class="comment">//make it in mm</span>
01214         vpos2=vpos2*1000./btint;<span class="comment">//make it in mm</span>
01215       }
01216       <span class="keywordflow">else</span>{
01217         hpos2=-999.;
01218         vpos2=-999.;
01219       }
01220       
01221       hornI=bs-&gt;<a class="code" href="classBeamMonSpill.html#o6">fHornCur</a>;       
01222       <a class="code" href="classSpillTimeFinder.html">SpillTimeFinder</a> &amp;sfind= <a class="code" href="classSpillTimeFinder.html#e0">SpillTimeFinder::Instance</a>();
01223       closestspill = 
01224         sfind.<a class="code" href="classSpillTimeFinder.html#a9">GetTimeToNearestSpill</a>(vc);
01225       
01226       beamcnf =bs-&gt;<a class="code" href="classBeamMonSpill.html#a14">GetStatusBits</a>().beam_type;
01227       nuTarZ=0.;
01228       horn_on = bs-&gt;<a class="code" href="classBeamMonSpill.html#a14">GetStatusBits</a>().horn_on;
01229       target_in = bs-&gt;<a class="code" href="classBeamMonSpill.html#a14">GetStatusBits</a>().target_in;
01230       
01231       
01232       tor101=bs-&gt;<a class="code" href="classBeamMonSpill.html#o2">fTor101</a>;
01233       tr101d=bs-&gt;<a class="code" href="classBeamMonSpill.html#o3">fTr101d</a>;
01234       tortgt=bs-&gt;<a class="code" href="classBeamMonSpill.html#o4">fTortgt</a>;
01235       trtgtd=bs-&gt;<a class="code" href="classBeamMonSpill.html#o5">fTrtgtd</a>;
01236       hadmon=bs-&gt;<a class="code" href="classBeamMonSpill.html#o14">fHadInt</a>;
01237       mumon1=bs-&gt;<a class="code" href="classBeamMonSpill.html#o15">fMuInt1</a>;
01238       mumon2=bs-&gt;<a class="code" href="classBeamMonSpill.html#o16">fMuInt2</a>;
01239       mumon3=bs-&gt;<a class="code" href="classBeamMonSpill.html#o17">fMuInt3</a>;
01240       
01241       goodbeam=0;
01242       <span class="comment">//      }</span>
01243       <span class="comment">/*</span>
01244 <span class="comment">      else{</span>
01245 <span class="comment">        // could the following return a reference?</span>
01246 <span class="comment">        BeamMonTV btv = BeamMonMap::FindClosestSpill(beam_mon_map,vts);</span>
01247 <span class="comment">        hbw=btv.hbw;</span>
01248 <span class="comment">        vbw=btv.vbw;</span>
01249 <span class="comment">        hpos2=btv.hpos2;</span>
01250 <span class="comment">        vpos2=btv.vpos2;</span>
01251 <span class="comment">        hornI=btv.hornI;</span>
01252 <span class="comment">        closestspill=btv.closestspill;</span>
01253 <span class="comment">        </span>
01254 <span class="comment">        nuTarZ=btv.nuTarZ;</span>
01255 <span class="comment">        //approximately assign beamcnf based on nuTarZ</span>
01256 <span class="comment">        if(nuTarZ&lt;20000&amp;&amp;nuTarZ&gt;=0){</span>
01257 <span class="comment">          beamcnf=1;</span>
01258 <span class="comment">          target_in=1;</span>
01259 <span class="comment">        }</span>
01260 <span class="comment">        else if(nuTarZ&gt;20000&amp;&amp;nuTarZ&lt;60000){</span>
01261 <span class="comment">          beamcnf=4;</span>
01262 <span class="comment">          target_in=1;</span>
01263 <span class="comment">        }</span>
01264 <span class="comment">        else{</span>
01265 <span class="comment">          beamcnf=5;</span>
01266 <span class="comment">          target_in=1;</span>
01267 <span class="comment">        }</span>
01268 <span class="comment">        if(fabs(hornI)&gt;10){</span>
01269 <span class="comment">          horn_on=1;</span>
01270 <span class="comment">        }</span>
01271 <span class="comment">        n_batches=0;</span>
01272 <span class="comment">        tor101=0.;</span>
01273 <span class="comment">        tr101d=0.;        </span>
01274 <span class="comment">        tortgt=btv.bI;</span>
01275 <span class="comment">        trtgtd=0.;</span>
01276 <span class="comment">        hadmon=0.;</span>
01277 <span class="comment">        mumon1=0.;</span>
01278 <span class="comment">        mumon2=0.;</span>
01279 <span class="comment">        mumon3=0.;</span>
01280 <span class="comment">      }</span>
01281 <span class="comment">      */</span>
01282       <span class="comment">//set goodbeam==1 if it passes some basic beam monitoring cuts</span>
01283       <span class="comment">//changing widths to deal with rms instead of fits</span>
01284       <span class="comment">//getting rid of horn_on and target_in since they sometime</span>
01285       <span class="comment">//go haywire</span>
01286       <span class="comment">//        if(horn_on&amp;&amp;target_in&amp;&amp;tortgt&gt;0.1&amp;&amp;hbw&lt;1.5&amp;&amp;vbw&lt;2&amp;&amp;</span>
01287       <span class="comment">//           hpos2&gt;-2&amp;&amp;hpos2&lt;0&amp;&amp;vpos2&gt;0&amp;&amp;vpos2&lt;2&amp;&amp;fabs(closestspill)&lt;2){</span>
01288       <span class="comment">/*</span>
01289 <span class="comment">      if(tor101&gt;0.1&amp;&amp;tortgt&gt;0.1&amp;&amp;hbw&lt;2.9&amp;&amp;vbw&lt;2.9&amp;&amp;</span>
01290 <span class="comment">         hpos2&gt;-2&amp;&amp;hpos2&lt;0&amp;&amp;vpos2&gt;0&amp;&amp;vpos2&lt;2&amp;&amp;fabs(hornI)&gt;50&amp;&amp;</span>
01291 <span class="comment">         fabs(closestspill)&lt;2){</span>
01292 <span class="comment">        goodbeam=1;</span>
01293 <span class="comment">      }</span>
01294 <span class="comment">      */</span>
01295       <span class="comment">//use Mark D. BMSpillAna to set good beam</span>
01296       bmana.<a class="code" href="classBMSpillAna.html#a7">SetSpill</a>(*bs);
01297       bmana.<a class="code" href="classBMSpillAna.html#a10">SetTimeDiff</a>(closestspill);
01298       <span class="keywordflow">if</span>(bmana.<a class="code" href="classBMSpillAna.html#a12">SelectSpill</a>()){
01299         goodbeam=1;
01300       }
01301       <span class="keywordflow">else</span>{
01302         goodbeam=0;
01303       }
01304 
01305 
01306       <span class="keywordflow">if</span>(<a class="code" href="classMadMKAnalysis.html#r2">fDataUseMCBeam</a>==<span class="keyword">true</span>){
01307         <span class="comment">//allow us to force the data to use the MC beam</span>
01308         current_beam=<a class="code" href="classMadMKAnalysis.html#r1">fMCBeam</a>;
01309       }
01310       <span class="keywordflow">else</span>{
01311         <span class="comment">// attempt to deduce beam type from beam monitoring</span>
01312         current_beam = <a class="code" href="namespaceBeamType.html#a29">BeamType::FromBeamMon</a>(beamcnf);
01313       }
01314       
01315       <span class="keywordflow">if</span>(goodbeam==1&amp;&amp;spilltype!=3){<span class="comment">//don't count fake spills</span>
01316         pot+=tortgt;
01317         pottor101+=tor101;
01318         pottortgt+=tortgt;
01319       }
01320     }
01321 
01322     <span class="comment">// Write a special record for each spill!</span>
01323     event=-1; ntrack=-1; nshower=-1; reco_emu=0.0; reco_enu=0.0; reco_eshw=0;
01324     true_enu=0.0; true_emu=0.0; true_eshw=0.0;
01325     pass=0; is_fid=0;
01326     tree-&gt;Fill();
01327     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> iwt=0; iwt&lt;n_inuke_wts; iwt++) inuke_wts[iwt]=-1.0;
01328     <span class="keywordflow">if</span>(inukerw!=0 &amp;&amp; inukerw!=tree) inukerw-&gt;Fill();
01329 
01330     <span class="keywordflow">if</span>(nevent==0) <span class="keywordflow">continue</span>;    
01331     <span class="comment">//fill tree once for each reconstructed event</span>
01332     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="classMadBase.html#p10">eventSummary</a>-&gt;<a class="code" href="classNtpSREventSummary.html#o6">nevent</a>;i++){ 
01333       <span class="keywordflow">if</span>(!<a class="code" href="classMadBase.html#b3">LoadEvent</a>(i)) <span class="keywordflow">continue</span>; <span class="comment">//no event found</span>
01334 
01335       <span class="comment">//set event index:</span>
01336       event = i;
01337       ntrack = <a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o14">ntrack</a>;
01338       nshower = <a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o12">nshower</a>;
01339       nstrip = <a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o4">nstrip</a>;
01340 
01342       <span class="comment">//zero all tree values</span>
01343       true_enu = 0; true_emu = 0; true_eshw = 0; true_x = 0; true_y = 0; 
01344       true_q2 = 0; true_w2 = 0; true_dircosneu = 0; true_dircosz = 0;
01345       true_vtxx = 0; true_vtxy = 0; true_vtxz = 0; true_pitt_fid=0;
01346       true_trk_cmplt=0.;
01347       resnum=0;
01348       npp=npm=npz=np=nn=0;
01349       epp=epm=epz=ep=en=0.0;
01350 
01351       fluxrun=0; fluxevtno=0; nudxdz=0.; nudydz=0.; nupz=0.; nuenergy=0.;
01352       nudxdznear=0.; nudydznear=0.; nuenergynear=0.; nwtnear=0.; nudxdzfar=0.;
01353       nudydzfar=0.; nuenergyfar=0.; nwtfar=0.; norig=0; ndecay=0; ntype=0;
01354       vx=0.; vy=0.; vz=0.; pdpx=0.; pdpy=0.; pdpz=0.; ppdxdz=0.; ppdydz=0.; pppz=0.;
01355       ppenergy=0.; ppmedium=0; ptype=0; ppvx=0.; ppvy=0.; ppvz=0.;
01356       muparpx=0.; muparpy=0.; muparpz=0.; mupare=0.; necm=0.; nimpwt=0.;
01357       xpoint=0.; ypoint=0.; zpoint=0.; tvx=0.; tvy=0.; tvz=0.; tpx=0.;
01358       tpy=0.; tpz=0.; tptype=0; tgen=0;
01359       
01360       flavour = 0; process = 0; nucleus = 0; cc_nc = 0; initial_state = 0;
01361 
01362       mcevent = -1;
01363       is_fid = 0; is_cev = 0; is_mc = 0; pass_basic = 0; 
01364       is_pitt_fid=0; pitt_evt_class=0; pitt_trk_qual=0; nd_radial_fid=0;
01365       is_trk_fid=0;
01366       duvvtx=0;
01367       pid0 = 0; pid1 = 0; pid2 = 0; pass = 0;
01368       reco_enu = 0; reco_emu = 0; reco_eshw = 0; reco_wtd_eshw=0; 
01369       reco_vtx_eshw=0; reco_vtx_wtd_eshw=0;
01370       reco_qe_enu = 0;  reco_mushw=0;
01371       reco_qe_q2 = 0; reco_dircosneu = 0; reco_dircosz = 0;
01372       reco_vtxx = reco_vtxy = reco_vtxz = reco_vtxr=0; 
01373       reco_trk_vtxx = reco_trk_vtxy = reco_trk_vtxz = reco_trk_vtxr=0; 
01374       reco_shw_vtxx = reco_shw_vtxy = reco_shw_vtxz = reco_shw_vtxr=0; 
01375       reco_trk_endx = reco_trk_endy = reco_trk_endz = reco_trk_endr=0; 
01376       evt_nstrips = slc_nstrips = trk_nstrips=0;
01377       evt_nplanes = slc_nplanes = trk_nplanes=0;
01378       shw_nplanes_cut=shw_nplanes_raw=0;
01379       shw_ph_cut=shw_ph_raw=0.0;
01380 
01381       evtlength = trklength = shwlength=trknstp=0; 
01382       trkphfrac = trkphplane = 0;
01383       ntrklike= trkend=trkendu=trkendv=shwbeg=shwend=0;
01384       trkmomrange = 0; trkqp = 0; trkeqp = 0;
01385       trkchi2=0.0; trkndf=0;
01386       pass_track=0; emu_meth=0;
01387       <span class="comment">// kinematic quantities always positive</span>
01388       <span class="comment">// convention: -1 indicates unfilled variable (NC events)</span>
01389       reco_y = reco_x = reco_Q2 = reco_W2 = -1;
01390       
01391       shw_pur = shw_comp = -1;
01392 
01393       <span class="comment">// vertex back tracking</span>
01394 
01395       nvsi=nvti=bvsi=bvti=-1;
01396       nvsevt=bvsevt=nvtevt=bvtevt=-1;
01397       nvsd=nvtd=bvsd=bvtd=999999;
01398       nvst=bvst=nvtt=bvtt=1e6;
01399       nvsp=nvtp=bvsp=bvtp=-1.0;
01400 
01401       evtph=0; evtphgev=0;
01402       evtsigfull=evtsigpart=trksigfull=trksigpart=0;            
01403 
01404       evttimemin=evttimemax=evttimeln=0.;
01405       evttimeminphc=evttimemaxphc=evttimelnphc=0.;
01406 
01407       earlywph=earlywphpw=earlywphsphere=0.;
01408       ph1000=ph500=ph100=0.;
01409       lateph1000=lateph500=lateph100=lateph50=0.;
01410 
01411       nduprs=0;
01412       dupphrs=0.;
01413       
01414       nu_px=nu_py=nu_pz=tar_px=tar_py=tar_pz=tar_e=0.0;
01415       inu=0;
01416       ntotss=0;
01417       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> iss=0; iss&lt;6; iss++){nss[iss]=0; ess[iss]=0;}
01418 
01419       med_qe_pid=-1001.0;
01420       med_qe_pass=0;
01421       niki_cc_pid=-999;
01422       dave_cc_pid=-999;
01423 
01424       is_fid = <a class="code" href="classMadMKAnalysis.html#b7">InFidVol</a>();
01425             
01426       <span class="comment">//check for a corresponding mc event</span>
01427       <span class="comment">// first, looks to match reconstructed track</span>
01428       <span class="comment">// then, looks to match reconstructed shower</span>
01429       <span class="keywordflow">if</span>(<a class="code" href="classMadBase.html#b19">LoadTruthForRecoTH</a>(i,mcevent)) {
01430 
01431         <span class="comment">// should flag with a "bad truth word"</span>
01432         <span class="comment">// in case the function above returns false</span>
01433 
01434         <span class="comment">//true info for tree:</span>
01435         is_mc             = 1;
01436         nucleus           = <a class="code" href="classMadQuantities.html#a27">Nucleus</a>(mcevent);
01437         flavour           = <a class="code" href="classMadQuantities.html#a19">Flavour</a>(mcevent);
01438         initial_state     = <a class="code" href="classMadQuantities.html#a26">Initial_state</a>(mcevent);
01439         process           = <a class="code" href="classMadQuantities.html#a21">IResonance</a>(mcevent); 
01440         cc_nc             = <a class="code" href="classMadQuantities.html#a20">IAction</a>(mcevent);
01441         true_enu          = <a class="code" href="classMadQuantities.html#a30">TrueNuEnergy</a>(mcevent); 
01442         true_emu          = <a class="code" href="classMadQuantities.html#a33">TrueMuEnergy</a>(mcevent); 
01443         true_eshw         = <a class="code" href="classMadQuantities.html#a36">TrueShwEnergy</a>(mcevent); 
01444         true_x            = <a class="code" href="classMadQuantities.html#a22">X</a>(mcevent);
01445         true_y            = <a class="code" href="classMadQuantities.html#a23">Y</a>(mcevent);
01446         true_q2           = <a class="code" href="classMadQuantities.html#a24">Q2</a>(mcevent);
01447         true_w2           = <a class="code" href="classMadQuantities.html#a25">W2</a>(mcevent);
01448         true_dircosz      = <a class="code" href="classMadQuantities.html#a38">TrueMuDCosZ</a>(mcevent);
01449         true_dircosneu    = <a class="code" href="classMadQuantities.html#a39">TrueMuDCosNeu</a>(mcevent);
01450         
01451 
01452         <span class="comment">//flux info</span>
01453         <span class="keywordflow">if</span>(<a class="code" href="classMadBase.html#b7">LoadTruth</a>(mcevent)){
01454           fluxrun=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o1">fluxrun</a>;
01455           fluxevtno=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o2">fluxevtno</a>;
01456           nudxdz=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o3">ndxdz</a>;
01457           nudydz=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o4">ndydz</a>;
01458           nupz=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o5">npz</a>;
01459           nuenergy=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o6">nenergy</a>;
01460           nudxdznear=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o7">ndxdznear</a>;
01461           nudydznear=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o8">ndydznear</a>;
01462           nuenergynear=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o9">nenergynear</a>;
01463           nwtnear=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o10">nwtnear</a>;
01464           nudxdzfar=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o11">ndxdzfar</a>;
01465           nudydzfar=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o12">ndydzfar</a>;
01466           nuenergyfar=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o13">nenergyfar</a>;
01467           nwtfar=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o14">nwtfar</a>;
01468           norig=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o15">norig</a>;
01469           ndecay=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o16">ndecay</a>;
01470           ntype=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o17">ntype</a>;
01471           vx=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o18">vx</a>;
01472           vy=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o19">vy</a>;
01473           vz=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o20">vz</a>;
01474           pdpx=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o21">pdpx</a>;
01475           pdpy=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o22">pdpy</a>;
01476           pdpz=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o23">pdpz</a>;
01477           ppdxdz=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o24">ppdxdz</a>;
01478           ppdydz=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o25">ppdydz</a>;
01479           pppz=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o26">pppz</a>;
01480           ppenergy=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o27">ppenergy</a>;
01481           ppmedium=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o28">ppmedium</a>;
01482           ptype=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o29">ptype</a>;
01483           ppvx=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o30">ppvx</a>;
01484           ppvy=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o31">ppvy</a>;
01485           ppvz=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o32">ppvz</a>;
01486           muparpx=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o33">muparpx</a>;
01487           muparpy=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o34">muparpy</a>;
01488           muparpz=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o35">muparpz</a>;
01489           mupare=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o36">mupare</a>;
01490           necm=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o37">necm</a>;
01491           nimpwt=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o38">nimpwt</a>;
01492           xpoint=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o39">xpoint</a>;
01493           ypoint=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o40">ypoint</a>;
01494           zpoint=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o41">zpoint</a>;
01495           tvx=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o42">tvx</a>;
01496           tvy=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o43">tvy</a>;
01497           tvz=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o44">tvz</a>;
01498           tpx=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o45">tpx</a>;
01499           tpy=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o46">tpy</a>;
01500           tpz=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o47">tpz</a>;
01501           tptype=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o48">tptype</a>;
01502           tgen=<a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o35">flux</a>.<a class="code" href="classNtpMCFluxInfo.html#o49">tgen</a>;       
01503         }
01504 
01505         <span class="keywordflow">if</span>(<a class="code" href="classMadBase.html#p27">ntpTHTrack</a>){
01506           <span class="keywordflow">if</span>(<a class="code" href="classMadBase.html#p27">ntpTHTrack</a>-&gt;<a class="code" href="classNtpTHTrack.html#o1">neumc</a>==mcevent){
01507             true_trk_cmplt=<a class="code" href="classMadBase.html#p27">ntpTHTrack</a>-&gt;<a class="code" href="classNtpTHTrack.html#o6">completeslc</a>;
01508           }
01509         }
01510         
01511         Float_t* true_p = <a class="code" href="classMadQuantities.html#a31">TrueNuMom</a>(mcevent);
01512         <span class="keywordflow">if</span>(true_p){
01513           nu_px=true_p[0]; nu_py=true_p[1]; nu_pz=true_p[2];
01514           <span class="keyword">delete</span>[] true_p; true_p=0;
01515         }
01516         true_p = <a class="code" href="classMadQuantities.html#a29">Target4Vector</a>(mcevent);
01517         <span class="keywordflow">if</span>(true_p){
01518           tar_px=true_p[0]; tar_py=true_p[1]; tar_pz=true_p[2]; 
01519           tar_e=true_p[3];
01520           <span class="keyword">delete</span>[] true_p; true_p=0;
01521         }
01522 
01523         Float_t *vtx = <a class="code" href="classMadQuantities.html#a32">TrueVtx</a>(mcevent);
01524         true_vtxx         = vtx[0];
01525         true_vtxy         = vtx[1];
01526         true_vtxz         = vtx[2];
01527         <span class="keywordtype">float</span> true_vtxu = (true_vtxx + true_vtxy)/sqrt(2.0);
01528         <span class="keywordtype">float</span> true_vtxv = (true_vtxy - true_vtxx)/sqrt(2.0);
01529         true_pitt_fid=<a class="code" href="classMadMKAnalysis.html#e0">PittInFidVol</a>(true_vtxx, true_vtxy, 
01530                                    true_vtxz,
01531                                    true_vtxu, true_vtxv);
01532 
01533         resnum = <a class="code" href="classMadQuantities.html#a28">HadronicFinalState</a>(mcevent);
01534         npp = <a class="code" href="classMadQuantities.html#a48">NumFSPion</a>(mcevent,+1);
01535         npm = <a class="code" href="classMadQuantities.html#a48">NumFSPion</a>(mcevent,-1);
01536         npz = <a class="code" href="classMadQuantities.html#a54">NumFSPiZero</a>(mcevent);
01537         np = <a class="code" href="classMadQuantities.html#a42">NumFSProton</a>(mcevent);
01538         nn = <a class="code" href="classMadQuantities.html#a45">NumFSNeutron</a>(mcevent);
01539         
01540         epp = <a class="code" href="classMadQuantities.html#a49">TotFSPionEnergy</a>(mcevent,+1);
01541         epm = <a class="code" href="classMadQuantities.html#a49">TotFSPionEnergy</a>(mcevent,-1);
01542         epz = <a class="code" href="classMadQuantities.html#a55">TotFSPiZeroEnergy</a>(mcevent);
01543         ep = <a class="code" href="classMadQuantities.html#a43">TotFSProtonEnergy</a>(mcevent);
01544         en = <a class="code" href="classMadQuantities.html#a46">TotFSNeutronEnergy</a>(mcevent);
01545         
01546         <span class="comment">// beam energy weights //</span>
01547         inu=0;
01548         inu = <a class="code" href="classMadQuantities.html#a17">INu</a>(mcevent);
01549         <span class="comment">/*</span>
01550 <span class="comment">        bec_inve=bec_le=bec_050=bec_100=bec_200=bec_250=1.0;</span>
01551 <span class="comment">        bec_inve=ecalc.GetWeight(BeamType::kInverseE,det,inu,</span>
01552 <span class="comment">                                 true_enu, bec_high,bec_low);</span>
01553 <span class="comment">        bec_le=ecalc.GetWeight(BeamType::kLE,det,inu,</span>
01554 <span class="comment">                               true_enu, bec_high,bec_low);</span>
01555 <span class="comment">        bec_050=ecalc.GetWeight(BeamType::k050,det,inu,</span>
01556 <span class="comment">                                 true_enu, bec_high,bec_low);</span>
01557 <span class="comment">        bec_100=ecalc.GetWeight(BeamType::k100,det,inu,</span>
01558 <span class="comment">                                 true_enu, bec_high,bec_low);</span>
01559 <span class="comment">        bec_200=ecalc.GetWeight(BeamType::k200,det,inu,</span>
01560 <span class="comment">                                 true_enu, bec_high,bec_low);</span>
01561 <span class="comment">        bec_250=ecalc.GetWeight(BeamType::k250,det,inu,</span>
01562 <span class="comment">                                 true_enu, bec_high,bec_low);</span>
01563 <span class="comment">        */</span>
01565         <span class="keyword">delete</span> [] vtx;
01566       }
01567 
01568       <span class="keywordflow">if</span>(<a class="code" href="classMadAnalysis.html#b1">PassBasicCuts</a>(event)) {
01569         <span class="comment">//reco info for tree:</span>
01570         pass_basic        = 1;
01571         
01572         
01573         <span class="comment">//index will -1 if no track/shower present in event</span>
01574         <span class="keywordtype">int</span> track_index   = -1;
01575         <span class="comment">// track spanning largest number of planes</span>
01576         <a class="code" href="classMadBase.html#b14">LoadLargestTrackFromEvent</a>(i,track_index);
01577 
01578         pass_track = <a class="code" href="classMadQuantities.html#a5">PassTrackCuts</a>(track_index);
01579         <span class="comment">//methods should all be protected against index = -1</span>
01580         
01581         reco_emu          = <a class="code" href="classMadMKAnalysis.html#b3">RecoMKMuEnergy</a>(emu_meth,track_index);
01582 
01583         <span class="keywordtype">int</span> shower_index  = -1;
01584         
01585         <span class="comment">// load the largest shower</span>
01586         <span class="comment">/*</span>
01587 <span class="comment">        if(track_index!=-1) {</span>
01588 <span class="comment">          LoadShowerAtTrackVertex(i,track_index,shower_index);</span>
01589 <span class="comment">        }</span>
01590 <span class="comment">        // shower with the best match to the vertex     </span>
01591 <span class="comment">        else LoadLargestShowerFromEvent(i,shower_index);</span>
01592 <span class="comment">        */</span>
01593         <span class="comment">/*</span>
01594 <span class="comment">        if(nshower&gt;0){</span>
01595 <span class="comment">          shower_index=ntpEvent-&gt;shw[0];</span>
01596 <span class="comment">          LoadShower(shower_index);</span>
01597 <span class="comment">        }</span>
01598 <span class="comment">        */</span>
01599 
01600         <span class="comment">// use the jim shower!</span>
01601         <a class="code" href="classMadBase.html#b15">LoadShower_Jim</a>(i,shower_index,det);
01602         reco_eshw         = <a class="code" href="classMadMKAnalysis.html#b2">RecoShwEnergy</a>(shower_index, det,1,!file_is_mc);
01603         <span class="keywordflow">if</span>(shower_index&gt;-1) reco_wtd_eshw = <a class="code" href="classMadBase.html#p15">ntpShower</a>-&gt;<a class="code" href="classNtpSRShower.html#o29">shwph</a>.<a class="code" href="classNtpSRShowerPulseHeight.html#o1">wtCCgev</a>;
01604         reco_vtx_eshw = reco_eshw;
01605         reco_vtx_wtd_eshw = reco_wtd_eshw;
01606 
01607         <span class="comment">// figure shower truth business out</span>
01608         <span class="keywordflow">if</span>(is_mc &amp;&amp; shower_index&gt;-1){
01609           <a class="code" href="classMadBase.html#b11">LoadTHShower</a>(shower_index);
01610           assert(ntpTHShower);
01611           shw_pur=<a class="code" href="classMadBase.html#p28">ntpTHShower</a>-&gt;<a class="code" href="classNtpTHShower.html#o3">purity</a>;
01612           shw_comp=<a class="code" href="classMadBase.html#p28">ntpTHShower</a>-&gt;<a class="code" href="classNtpTHShower.html#o5">completeslc</a>;
01613         }
01614         
01615         <span class="comment">// provisional, to be updated later</span>
01616         reco_enu = reco_emu + reco_eshw;
01617         <span class="comment">// event energy according to offline</span>
01618         evtphgev = <a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o19">ph</a>.<a class="code" href="classNtpSRStripPulseHeight.html#o2">gev</a>;
01619         <span class="keywordflow">if</span>(reco_enu&gt;0){
01620           reco_qe_enu       = <a class="code" href="classMadQuantities.html#a68">RecoQENuEnergy</a>(track_index);
01621           reco_qe_q2        = <a class="code" href="classMadQuantities.html#a69">RecoQEQ2</a>(track_index);
01622           <span class="comment">// note, NtpSRFiducial isn't filled for ND events</span>
01623           <span class="comment">// is_cev is only useful for FD events</span>
01624           is_cev            = <a class="code" href="classMadQuantities.html#a9">IsFidAll</a>(track_index);
01625           <span class="comment">// use Pitt group's fiducial cuts for ND events</span>
01626           <span class="keywordflow">if</span>(detector==1){
01627             <span class="comment">// for now, use event vertex</span>
01628             <span class="comment">// but maybe should use track vertex...</span>
01629             <span class="comment">// if vertex finder works well it shouldn't matter...</span>
01630             is_pitt_fid = <a class="code" href="classMadMKAnalysis.html#e0">PittInFidVol</a>(<a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o21">vtx</a>.<a class="code" href="classNtpSRVertex.html#o3">x</a>, <a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o21">vtx</a>.<a class="code" href="classNtpSRVertex.html#o4">y</a>, 
01631                                        <a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o21">vtx</a>.<a class="code" href="classNtpSRVertex.html#o5">z</a>,
01632                                        <a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o21">vtx</a>.<a class="code" href="classNtpSRVertex.html#o1">u</a>, <a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o21">vtx</a>.<a class="code" href="classNtpSRVertex.html#o2">v</a>);
01633             nd_radial_fid = <a class="code" href="classMadMKAnalysis.html#e3">NDRadialFidVol</a>(<a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o21">vtx</a>.<a class="code" href="classNtpSRVertex.html#o3">x</a>,<a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o21">vtx</a>.<a class="code" href="classNtpSRVertex.html#o4">y</a>,
01634                                            <a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o21">vtx</a>.<a class="code" href="classNtpSRVertex.html#o5">z</a>);
01635           }
01636           <span class="keywordflow">else</span>{
01637             is_pitt_fid = <a class="code" href="classMadMKAnalysis.html#b7">InFidVol</a>();
01638           }
01639           <span class="comment">// have already checked that ntpEvent exists</span>
01640           reco_vtxx         = <a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o21">vtx</a>.<a class="code" href="classNtpSRVertex.html#o3">x</a>;
01641           reco_vtxy         = <a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o21">vtx</a>.<a class="code" href="classNtpSRVertex.html#o4">y</a>;
01642           reco_vtxz         = <a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o21">vtx</a>.<a class="code" href="classNtpSRVertex.html#o5">z</a>;
01643           
01644           <span class="comment">// check if distance from vertex to shower is too large</span>
01645           <span class="comment">// if so, set reco_eshw =0 </span>
01646           <span class="comment">// idea is to handle case of no vertex shower but runt downstream</span>
01647           <span class="keywordflow">if</span>(shower_index!=-1){
01648             <span class="comment">//      bool shw_ok=true;</span>
01649             <span class="keyword">const</span> <span class="keywordtype">float</span> max_shw_dist=14*0.06; <span class="comment">// about 2 interaction lengths</span>
01650             <span class="keywordtype">float</span> dist_z = fabs(reco_vtxz - <a class="code" href="classMadBase.html#p15">ntpShower</a>-&gt;<a class="code" href="classNtpSRShower.html#o31">vtx</a>.<a class="code" href="classNtpSRVertex.html#o5">z</a>);
01651             <span class="keywordtype">float</span> dist_r = sqrt( <a class="code" href="nrutil__val_8h.html#a22">pow</a>(<a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o21">vtx</a>.<a class="code" href="classNtpSRVertex.html#o1">u</a>-<a class="code" href="classMadBase.html#p15">ntpShower</a>-&gt;<a class="code" href="classNtpSRShower.html#o31">vtx</a>.<a class="code" href="classNtpSRVertex.html#o1">u</a>,2) +
01652                                  <a class="code" href="nrutil__mtl_8h.html#a20">pow</a>(<a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o21">vtx</a>.<a class="code" href="classNtpSRVertex.html#o2">v</a>-<a class="code" href="classMadBase.html#p15">ntpShower</a>-&gt;<a class="code" href="classNtpSRShower.html#o31">vtx</a>.<a class="code" href="classNtpSRVertex.html#o2">v</a>,2) );
01653             <span class="keywordflow">if</span>( (dist_z + dist_r) &gt; max_shw_dist ){
01654               reco_vtx_eshw=0;
01655               reco_vtx_wtd_eshw=0;
01656             }
01657             
01658           }
01659           <span class="comment">// radial position of vertex</span>
01660           <span class="keywordflow">if</span>(detector==1){
01661             reco_vtxr = <a class="code" href="nrutil__val_8h.html#a22">pow</a>(reco_vtxx-kXcenter,2) 
01662               + <a class="code" href="nrutil__val_8h.html#a22">pow</a>(reco_vtxy-kYcenter,2);
01663             reco_vtxr=sqrt(reco_vtxr);
01664           }
01665           <span class="keywordflow">else</span> reco_vtxr = sqrt (<a class="code" href="nrutil__val_8h.html#a22">pow</a>(reco_vtxx,2)+<a class="code" href="nrutil__val_8h.html#a22">pow</a>(reco_vtxy,2));
01666           
01667           <span class="comment">// compute signal in fully and partially instrumented regions</span>
01668           <a class="code" href="classMadMKAnalysis.html#b0">SigInOut</a>(track_index,evtsigfull,evtsigpart,trksigfull,trksigpart);
01669            <span class="keywordflow">if</span>(detector==2){
01670             <span class="comment">//if far det, all signal is in fully instrumented region</span>
01671             evtsigfull=<a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o19">ph</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>;
01672             evtsigpart=0.;
01673             <span class="keywordflow">if</span>(track_index!=-1){
01674               trksigfull=<a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o32">ph</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>;
01675             }
01676             <span class="keywordflow">else</span>{
01677               trksigfull=0.;
01678             }
01679             trksigpart=0.;
01680           }
01681                  
01682           <span class="comment">// angle reconstruction</span>
01683           reco_dircosz      = <a class="code" href="classMadQuantities.html#a70">RecoMuDCosZ</a>(track_index);
01684           
01685           <span class="comment">// event vertex</span>
01686           <span class="keywordtype">float</span> vtx_array[3]; 
01687           vtx_array[0]=<a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o21">vtx</a>.<a class="code" href="classNtpSRVertex.html#o3">x</a>; vtx_array[2]=<a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o21">vtx</a>.<a class="code" href="classNtpSRVertex.html#o4">y</a>;
01688           vtx_array[2]=<a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o21">vtx</a>.<a class="code" href="classNtpSRVertex.html#o5">z</a>;   
01689           <span class="keywordflow">if</span>(detector==1) 
01690             reco_dircosneu = <a class="code" href="classMadMKAnalysis.html#b4">RecoMuDCosNeuND</a>(track_index, vtx_array);
01691           <span class="keywordflow">else</span> reco_dircosneu = <a class="code" href="classMadMKAnalysis.html#b5">RecoMuDCosNeuFD</a>(track_index, vtx_array);
01692         
01693           evtlength         = <a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o20">plane</a>.<a class="code" href="classNtpSRPlane.html#o6">end</a>-<a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o20">plane</a>.<a class="code" href="classNtpSRPlane.html#o3">beg</a>;
01694           <span class="keywordflow">if</span>(track_index!=-1){ <span class="comment">//check track is present before using ntpTrack</span>
01695 
01696             trklength         = <a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o33">plane</a>.<a class="code" href="classNtpSRPlane.html#o6">end</a>-<a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o33">plane</a>.<a class="code" href="classNtpSRPlane.html#o3">beg</a>;
01697             ntrklike =<a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o33">plane</a>.<a class="code" href="classNtpSRTrackPlane.html#o0">ntrklike</a>;
01698             trkend         = <a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o33">plane</a>.<a class="code" href="classNtpSRPlane.html#o6">end</a>;
01699             trkendu         = <a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o33">plane</a>.<a class="code" href="classNtpSRPlane.html#o7">endu</a>;
01700             trkendv         = <a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o33">plane</a>.<a class="code" href="classNtpSRPlane.html#o8">endv</a>;
01701             trknstp       = <a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o4">nstrip</a>;
01702             trkmomrange       = <a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o41">momentum</a>.<a class="code" href="classNtpSRMomentum.html#o0">range</a>;
01703             trkmomrange = <a class="code" href="namespaceEnergyCorrections.html#a56">CorrectMomentumFromRange</a>(trkmomrange,!file_is_mc,det);
01704             trkqp             = <a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o41">momentum</a>.<a class="code" href="classNtpSRMomentum.html#o1">qp</a>;
01705             <span class="keywordflow">if</span>(trkqp!=0){
01706               trkqp = 1.0/<a class="code" href="namespaceEnergyCorrections.html#a58">CorrectSignedMomentumFromCurvature</a>(1.0/trkqp,
01707                                                              !file_is_mc, det);
01708             }
01709 
01710             trkeqp            = <a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o41">momentum</a>.<a class="code" href="classNtpSRMomentum.html#o2">eqp</a>;
01711             trkphfrac         = <a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o32">ph</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>/<a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o19">ph</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>;
01712             trkphplane        = <a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o32">ph</a>.<a class="code" href="classNtpSRStripPulseHeight.html#o1">mip</a>/<a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o33">plane</a>.<a class="code" href="classNtpSRPlane.html#o0">n</a>;
01713             trkchi2           = <a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o42">fit</a>.<a class="code" href="classNtpSRFitTrack.html#o4">chi2</a>;
01714             trkndf           = <a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o42">fit</a>.<a class="code" href="classNtpSRFitTrack.html#o1">ndof</a>;
01715             reco_trk_vtxx         = <a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o34">vtx</a>.<a class="code" href="classNtpSRVertex.html#o3">x</a>;
01716             reco_trk_vtxy         = <a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o34">vtx</a>.<a class="code" href="classNtpSRVertex.html#o4">y</a>;
01717             reco_trk_vtxz         = <a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o34">vtx</a>.<a class="code" href="classNtpSRVertex.html#o5">z</a>;
01718 
01719             reco_trk_endx         = <a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o35">end</a>.<a class="code" href="classNtpSRVertex.html#o3">x</a>;
01720             reco_trk_endy         = <a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o35">end</a>.<a class="code" href="classNtpSRVertex.html#o4">y</a>;
01721             reco_trk_endz         = <a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o35">end</a>.<a class="code" href="classNtpSRVertex.html#o5">z</a>;
01722             <span class="comment">// compute CC event class as defined by Pitt group</span>
01723             pitt_evt_class = <a class="code" href="classMadMKAnalysis.html#e1">PittTrkContained</a>(<a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o35">end</a>.<a class="code" href="classNtpSRVertex.html#o3">x</a>,
01724                                               <a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o35">end</a>.<a class="code" href="classNtpSRVertex.html#o4">y</a>,
01725                                               <a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o35">end</a>.<a class="code" href="classNtpSRVertex.html#o5">z</a>,
01726                                               <a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o35">end</a>.<a class="code" href="classNtpSRVertex.html#o1">u</a>,
01727                                               <a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o35">end</a>.<a class="code" href="classNtpSRVertex.html#o2">v</a>);
01728             duvvtx=<a class="code" href="NtpStNC_8h.html#a17">abs</a>(<a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o33">plane</a>.<a class="code" href="classNtpSRPlane.html#o4">begu</a> - <a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o33">plane</a>.<a class="code" href="classNtpSRPlane.html#o5">begv</a>);
01729             <span class="comment">// based on the event class, go back and recompute</span>
01730             <span class="comment">// the muon and neutrino energy</span>
01731             <span class="keywordflow">if</span>(detector==1){<span class="comment">//if it's the near detector</span>
01732               <span class="keywordflow">if</span>(pitt_evt_class&gt;0){ <span class="comment">// if it was classified</span>
01733                 <span class="keywordtype">int</span> do_meth=0; <span class="comment">// emu reco method we should use</span>
01734                 <span class="keywordflow">if</span>( (pitt_evt_class == 1) || (pitt_evt_class == 3) ) 
01735                   do_meth=2; <span class="comment">// stoppers --&gt; range</span>
01736                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>( (pitt_evt_class == 2) || (pitt_evt_class == 4) ) 
01737                   do_meth=1; <span class="comment">// punch-through --&gt; curvature</span>
01738                 <span class="keywordflow">if</span>(do_meth==1 || do_meth==2){
01739                    reco_emu = <a class="code" href="classMadMKAnalysis.html#b3">RecoMKMuEnergy</a>(do_meth,track_index,
01740                                              !file_is_mc,det);
01741                    reco_enu = reco_emu+reco_eshw;
01742                 }
01743                 emu_meth=do_meth; <span class="comment">// was forgetting about this</span>
01744               }
01745             }
01746             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(detector==2){<span class="comment">//if it's the near detector</span>
01747               <span class="keywordtype">int</span> do_meth=<a class="code" href="classMadMKAnalysis.html#e4">FarTrkContained</a>(<a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o35">end</a>.<a class="code" href="classNtpSRVertex.html#o3">x</a>,
01748                                           <a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o35">end</a>.<a class="code" href="classNtpSRVertex.html#o4">y</a>,
01749                                           <a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o35">end</a>.<a class="code" href="classNtpSRVertex.html#o5">z</a>);
01750               <span class="keywordflow">if</span>(do_meth==1 || do_meth==2){
01751                 reco_emu = <a class="code" href="classMadMKAnalysis.html#b3">RecoMKMuEnergy</a>(do_meth,track_index);
01752                 reco_enu = reco_emu+reco_eshw;
01753               }
01754               emu_meth=do_meth; <span class="comment">// was forgetting about this</span>
01755             }                               
01756 
01757             <span class="comment">//check to see if track vertex is in fid. vol</span>
01758             <span class="keywordflow">if</span>(detector==1){
01759               is_trk_fid = <a class="code" href="classMadMKAnalysis.html#e0">PittInFidVol</a>(<a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o34">vtx</a>.<a class="code" href="classNtpSRVertex.html#o3">x</a>, <a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o34">vtx</a>.<a class="code" href="classNtpSRVertex.html#o4">y</a>, 
01760                                         <a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o34">vtx</a>.<a class="code" href="classNtpSRVertex.html#o5">z</a>,
01761                                         <a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o34">vtx</a>.<a class="code" href="classNtpSRVertex.html#o1">u</a>, <a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o34">vtx</a>.<a class="code" href="classNtpSRVertex.html#o2">v</a>);
01762             }
01763             <span class="keywordflow">else</span>{
01764               is_trk_fid = <a class="code" href="classMadMKAnalysis.html#b7">InFidVol</a>(<a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o34">vtx</a>.<a class="code" href="classNtpSRVertex.html#o3">x</a>,<a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o34">vtx</a>.<a class="code" href="classNtpSRVertex.html#o4">y</a>,
01765                                     <a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o34">vtx</a>.<a class="code" href="classNtpSRVertex.html#o5">z</a>);
01766             }
01767             
01768             <span class="comment">// look for showers along muon track</span>
01769             reco_mushw=<a class="code" href="classMadMKAnalysis.html#b15">MuonShowerEnergy</a>(ntpEvent, ntpTrack);
01770             
01771             <span class="comment">// CEDAR apparently has 5 plane long tracks, with ndf==0</span>
01772             Double_t tmp_ndof=<a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o42">fit</a>.<a class="code" href="classNtpSRFitTrack.html#o1">ndof</a>;
01773             <span class="keywordflow">if</span>(tmp_ndof&lt;=0.0) tmp_ndof=1.0;
01774             <span class="comment">// pitt tracking quality cuts</span>
01775             <span class="keywordflow">if</span>( (<a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o42">fit</a>.<a class="code" href="classNtpSRFitTrack.html#o0">pass</a>&gt;0) 
01776                 &amp;&amp; (<a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o42">fit</a>.<a class="code" href="classNtpSRFitTrack.html#o4">chi2</a>/tmp_ndof &lt;20 )
01777                 &amp;&amp; <a class="code" href="NtpStNC_8h.html#a17">abs</a>(<a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o33">plane</a>.<a class="code" href="classNtpSRPlane.html#o4">begu</a> - <a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o33">plane</a>.<a class="code" href="classNtpSRPlane.html#o5">begv</a>)&lt;6 )
01778               pitt_trk_qual=1;
01779             
01781             <span class="keyword">const</span> <span class="keywordtype">double</span> M=(0.93827 + 0.93957)/2.0; <span class="comment">// &lt;nucleon mass&gt;</span>
01782             <span class="keywordflow">if</span>(reco_emu&gt;0) reco_Q2 = 
01783                              2*reco_enu*reco_emu*(1.0 - reco_dircosneu);
01784             reco_W2 = M*M - reco_Q2 + 2*M*reco_eshw;      
01785             <span class="keywordflow">if</span>(reco_enu&gt;0) reco_y = reco_eshw/reco_enu;
01786             <span class="keywordflow">if</span>(reco_eshw&gt;0 &amp;&amp; reco_Q2&gt;0) reco_x =  reco_Q2/(2*M*reco_eshw);
01788 
01790             <span class="keyword">const</span> <span class="keywordtype">double</span> muM=0.10566; <span class="comment">// muon mass</span>
01791             <span class="keyword">const</span> <span class="keywordtype">double</span> muP=sqrt(reco_emu*reco_emu -muM*muM);
01792             reco_qe_enu = (M*reco_emu - muM*muM/2.0)
01793               /(M - reco_emu + muP*reco_dircosneu);
01794             reco_qe_q2 = <a class="code" href="NtpStNC_8h.html#a17">abs</a>(-2.0*reco_qe_enu*(reco_emu-muP*reco_dircosneu)+muM*muM);
01796             
01798 
01799             med_qe_pid=<a class="code" href="classMadMKAnalysis.html#o2">qeid</a>.<a class="code" href="classMadQEID.html#a3">AltCalcQEID</a>(<span class="keyword">this</span>,event,reco_enu,reco_W2);
01800             med_qe_pass=<a class="code" href="classMadMKAnalysis.html#o2">qeid</a>.<a class="code" href="classMadQEID.html#a8">PassMEDQECut</a>(reco_enu,med_qe_pid);
01802 
01804             <span class="keywordflow">if</span>(<a class="code" href="classMadMKAnalysis.html#o0">nsid</a>.<a class="code" href="classMadNsID.html#a3">ChooseWeightFile</a>(det,current_beam)){
01805               <span class="keywordflow">if</span>(!<a class="code" href="classMadMKAnalysis.html#o0">nsid</a>.<a class="code" href="classMadNsID.html#a1">GetPID</a>(<span class="keyword">this</span>,event,det,niki_cc_pid)) niki_cc_pid=-999;
01806             }
01807             <span class="keywordflow">else</span> niki_cc_pid=-999;
01808             <span class="comment">// original code made detector dependent fiducial volume cut here</span>
01809             <span class="comment">// but, it's not necessary since PID has already been</span>
01810             <span class="comment">// calculated...</span>
01811             <span class="comment">// must reevaluate efficiency or make same cut downstream       </span>
01813 <span class="comment"></span>
01815             <span class="keywordflow">if</span>(det==<a class="code" href="classDetector.html#w8w3">Detector::kFar</a> &amp;&amp; !file_is_mc){
01816               <a class="code" href="classMadMKAnalysis.html#o1">dpid</a>.<a class="code" href="classMadDpID.html#a10">SetPHCorrection</a>(1.018);
01817             }
01818             <span class="keywordflow">if</span>(<a class="code" href="classMadMKAnalysis.html#o1">dpid</a>.<a class="code" href="classMadDpID.html#a6">ChoosePDFs</a>(det,current_beam)){
01819               dave_cc_pid = <a class="code" href="classMadMKAnalysis.html#o1">dpid</a>.<a class="code" href="classMadDpID.html#a2">CalcPID</a>(<span class="keyword">this</span>,event,0);
01820             }
01822 
01823             TObject *recobj=0;
01824             <span class="keywordflow">if</span>(<a class="code" href="classMadBase.html#p7">record</a>!=0){
01825               recobj=<a class="code" href="classMadBase.html#p7">record</a>;
01826             }
01827             <span class="keywordflow">else</span>{
01828               recobj=<a class="code" href="classMadBase.html#p6">strecord</a>;
01829             }
01830               
01831     
01832             <a class="code" href="classMadBase.html#b0">LoadTrack</a>(track_index);
01833             <span class="comment">//figure out planes in trk &gt; 1.5 pe</span>
01834             <span class="keywordtype">float</span> temp_ph;
01835             trk_nplanes=<a class="code" href="classMadMKAnalysis.html#b11">NPlanesInObj</a>(recobj,ntpTrack,1.5,temp_ph);
01836             <span class="comment">//figure out strips in trk &gt; 1.5 pe</span>
01837             trk_nstrips=<a class="code" href="classMadMKAnalysis.html#b12">NStripsInObj</a>(recobj,ntpTrack,1.5,temp_ph);
01838 
01839           }
01840           <span class="keywordflow">else</span> {
01841             trklength         = 0;
01842             trkmomrange       = 0;
01843             trkqp             = 0;
01844             trkeqp            = 0;
01845             trkphfrac         = 0;
01846             trkphplane        = 0;
01847             is_trk_fid        = -1;
01848           }
01849 
01850           <span class="comment">//this used to load the slice associated with the track</span>
01851           <span class="comment">//but we really want the slice associated witht the event</span>
01852           <span class="comment">//tv 10-19-05</span>
01853           <a class="code" href="classMadBase.html#b4">LoadSlice</a>(<a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o1">slc</a>);
01854           <span class="comment">//        cout&lt;&lt;"*********SNARL="&lt;&lt;snarl&lt;&lt;" "&lt;&lt;event</span>
01855           <span class="comment">//            &lt;&lt;"*********************************"&lt;&lt;endl;</span>
01856           TObject *recobj=0;
01857           <span class="keywordflow">if</span>(<a class="code" href="classMadBase.html#p7">record</a>!=0){
01858             recobj=<a class="code" href="classMadBase.html#p7">record</a>;
01859           }
01860           <span class="keywordflow">else</span>{
01861             recobj=<a class="code" href="classMadBase.html#p6">strecord</a>;
01862           }
01863 
01864           <span class="keywordtype">float</span> temp_ph;
01865           <span class="comment">//figure out planes in slice &gt; 1.5 pe</span>
01866           slc_nplanes=<a class="code" href="classMadMKAnalysis.html#b11">NPlanesInObj</a>(recobj,ntpSlice,1.5,temp_ph);
01867           <span class="comment">//figure out planes in evt &gt; 1.5 pe</span>
01868           evt_nplanes=<a class="code" href="classMadMKAnalysis.html#b11">NPlanesInObj</a>(recobj,ntpEvent,1.5,temp_ph);
01869           <span class="comment">//figure out strips in slice &gt; 1.5 pe</span>
01870           slc_nstrips=<a class="code" href="classMadMKAnalysis.html#b12">NStripsInObj</a>(recobj,ntpSlice,1.5,temp_ph);
01871           <span class="comment">//figure out strips in evt &gt; 1.5 pe</span>
01872           evt_nstrips=<a class="code" href="classMadMKAnalysis.html#b12">NStripsInObj</a>(recobj,ntpEvent,1.5,temp_ph);
01873           
01874           
01875           <span class="keywordflow">if</span>(shower_index!=-1 &amp;&amp; reco_eshw&gt;0){ <span class="comment">// case of no vertex shower</span>
01876             <a class="code" href="classMadBase.html#b1">LoadShower</a>(shower_index);
01877             shwlength=<a class="code" href="classMadBase.html#p15">ntpShower</a>-&gt;<a class="code" href="classNtpSRShower.html#o30">plane</a>.<a class="code" href="classNtpSRPlane.html#o0">n</a>;
01878             shw_nplanes_raw=<a class="code" href="classMadMKAnalysis.html#b11">NPlanesInObj</a>(recobj,ntpShower,0.0,shw_ph_raw);
01879             shw_nplanes_cut=<a class="code" href="classMadMKAnalysis.html#b11">NPlanesInObj</a>(recobj,ntpShower,1.5,shw_ph_cut);
01880             
01881             shwend=<a class="code" href="classMadBase.html#p15">ntpShower</a>-&gt;<a class="code" href="classNtpSRShower.html#o30">plane</a>.<a class="code" href="classNtpSRPlane.html#o6">end</a>;
01882             shwbeg=<a class="code" href="classMadBase.html#p15">ntpShower</a>-&gt;<a class="code" href="classNtpSRShower.html#o30">plane</a>.<a class="code" href="classNtpSRPlane.html#o3">beg</a>;
01883             reco_shw_vtxx=<a class="code" href="classMadBase.html#p15">ntpShower</a>-&gt;<a class="code" href="classNtpSRShower.html#o31">vtx</a>.<a class="code" href="classNtpSRVertex.html#o3">x</a>;
01884             reco_shw_vtxy=<a class="code" href="classMadBase.html#p15">ntpShower</a>-&gt;<a class="code" href="classNtpSRShower.html#o31">vtx</a>.<a class="code" href="classNtpSRVertex.html#o4">y</a>;
01885             reco_shw_vtxz=<a class="code" href="classMadBase.html#p15">ntpShower</a>-&gt;<a class="code" href="classNtpSRShower.html#o31">vtx</a>.<a class="code" href="classNtpSRVertex.html#o5">z</a>;
01886             
01887             
01889             <span class="keywordtype">int</span> ncl = <a class="code" href="classMadBase.html#p15">ntpShower</a>-&gt;<a class="code" href="classNtpSRShower.html#o25">ncluster</a>;
01890 
01891             <span class="comment">//Float_t   zvtx</span>
01892             <span class="comment">//Float_t   tposvtx</span>
01893             <span class="comment">//Float_t   slope</span>
01894             <span class="comment">//Float_t   avgdev</span>
01895             <span class="comment">/*</span>
01896 <span class="comment">            static TH1F hswu("hswu","",400,4,-4);</span>
01897 <span class="comment">            static TH1F hswu_wtd("hswu_wtd","",400,4,-4);</span>
01898 <span class="comment">            static TH1F hswv("hswv","",400,4,-4);</span>
01899 <span class="comment">            static TH1F hswv_wtd("hswv_wtd","",400,4,-4);</span>
01900 <span class="comment">            hswu.Reset();</span>
01901 <span class="comment">            hswu_wtd.Reset();</span>
01902 <span class="comment">            hswv.Reset();</span>
01903 <span class="comment">            hswv_wtd.Reset();</span>
01904 <span class="comment">            */</span>
01905             <a class="code" href="classMoments.html">Moments</a> mom_swu;
01906             <a class="code" href="classMoments.html">Moments</a> mom_swu_wtd;
01907             <a class="code" href="classMoments.html">Moments</a> mom_swv;
01908             <a class="code" href="classMoments.html">Moments</a> mom_swv_wtd;
01909 
01910             etu=etv=elu=elv=0.0; 
01911             swu=swv=wswu=wswv=0.0;
01912 
01913             <span class="comment">//      const float ss_cut=0.150;//GeV</span>
01914             <span class="keyword">const</span> <span class="keywordtype">float</span> ss_cut=0.0;<span class="comment">//GeV</span>
01915             <span class="keywordtype">float</span> totsigssu=0.0; <span class="comment">// em and hadr subshowers</span>
01916             <span class="keywordtype">float</span> totsigssv=0.0; <span class="comment">// em and hadr subshowers</span>
01917             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ii=0; ii&lt;ncl; ii++){
01918               <span class="keywordflow">if</span>(<a class="code" href="classMadBase.html#b2">LoadCluster</a>(<a class="code" href="classMadBase.html#p15">ntpShower</a>-&gt;<a class="code" href="classNtpSRShower.html#o26">clu</a>[ii])){
01919                 <span class="keywordflow">if</span>(<a class="code" href="classMadBase.html#p16">ntpCluster</a>-&gt;<a class="code" href="classNtpSRCluster.html#o16">ph</a>.<a class="code" href="classNtpSRStripPulseHeight.html#o2">gev</a> &gt;ss_cut){
01920                   nss[<a class="code" href="classMadBase.html#p16">ntpCluster</a>-&gt;<a class="code" href="classNtpSRCluster.html#o5">id</a>]+=1;
01921                   ess[<a class="code" href="classMadBase.html#p16">ntpCluster</a>-&gt;<a class="code" href="classNtpSRCluster.html#o5">id</a>]+=<a class="code" href="classMadBase.html#p16">ntpCluster</a>-&gt;<a class="code" href="classNtpSRCluster.html#o16">ph</a>.<a class="code" href="classNtpSRStripPulseHeight.html#o2">gev</a>;
01922                   ntotss++;
01923                   <span class="keywordflow">if</span>(<a class="code" href="classMadBase.html#p16">ntpCluster</a>-&gt;<a class="code" href="classNtpSRCluster.html#o5">id</a> &lt;2){
01924                     <span class="comment">// slope = tpos/zpos?</span>
01925                     <span class="keywordtype">float</span> sinang = sin(atan(<a class="code" href="classMadBase.html#p16">ntpCluster</a>-&gt;<a class="code" href="classNtpSRCluster.html#o14">slope</a>));
01926                     <span class="keywordflow">if</span>(<a class="code" href="classMadBase.html#p16">ntpCluster</a>-&gt;<a class="code" href="classNtpSRCluster.html#o1">planeview</a>==PlaneView::kU){
01927                       totsigssu+=<a class="code" href="classMadBase.html#p16">ntpCluster</a>-&gt;<a class="code" href="classNtpSRCluster.html#o16">ph</a>.<a class="code" href="classNtpSRStripPulseHeight.html#o2">gev</a>;
01928                       <span class="comment">//hswu.Fill(ntpCluster-&gt;tposvtx);</span>
01929                       mom_swu.<a class="code" href="classMoments.html#a1">AddPoint</a>(<a class="code" href="classMadBase.html#p16">ntpCluster</a>-&gt;<a class="code" href="classNtpSRCluster.html#o13">tposvtx</a>);
01930                       mom_swu_wtd.<a class="code" href="classMoments.html#a1">AddPoint</a>(<a class="code" href="classMadBase.html#p16">ntpCluster</a>-&gt;<a class="code" href="classNtpSRCluster.html#o13">tposvtx</a>,
01931                                            <a class="code" href="classMadBase.html#p16">ntpCluster</a>-&gt;<a class="code" href="classNtpSRCluster.html#o16">ph</a>.<a class="code" href="classNtpSRStripPulseHeight.html#o2">gev</a>);
01932                       
01933                       etu += sinang*<a class="code" href="classMadBase.html#p16">ntpCluster</a>-&gt;<a class="code" href="classNtpSRCluster.html#o16">ph</a>.<a class="code" href="classNtpSRStripPulseHeight.html#o2">gev</a>;
01934                       elu += sqrt(fabs(1-sinang*sinang))*<a class="code" href="classMadBase.html#p16">ntpCluster</a>-&gt;<a class="code" href="classNtpSRCluster.html#o16">ph</a>.<a class="code" href="classNtpSRStripPulseHeight.html#o2">gev</a>;
01935                     }
01936                     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classMadBase.html#p16">ntpCluster</a>-&gt;<a class="code" href="classNtpSRCluster.html#o1">planeview</a>==PlaneView::kV){
01937                       totsigssv+=<a class="code" href="classMadBase.html#p16">ntpCluster</a>-&gt;<a class="code" href="classNtpSRCluster.html#o16">ph</a>.<a class="code" href="classNtpSRStripPulseHeight.html#o2">gev</a>;
01938                       <span class="comment">//hswv.Fill(ntpCluster-&gt;tposvtx);</span>
01939                       mom_swv.<a class="code" href="classMoments.html#a1">AddPoint</a>(<a class="code" href="classMadBase.html#p16">ntpCluster</a>-&gt;<a class="code" href="classNtpSRCluster.html#o13">tposvtx</a>);
01940                       mom_swv_wtd.<a class="code" href="classMoments.html#a1">AddPoint</a>(<a class="code" href="classMadBase.html#p16">ntpCluster</a>-&gt;<a class="code" href="classNtpSRCluster.html#o13">tposvtx</a>,
01941                                            <a class="code" href="classMadBase.html#p16">ntpCluster</a>-&gt;<a class="code" href="classNtpSRCluster.html#o16">ph</a>.<a class="code" href="classNtpSRStripPulseHeight.html#o2">gev</a>);
01942 
01943                       etv += sinang*<a class="code" href="classMadBase.html#p16">ntpCluster</a>-&gt;<a class="code" href="classNtpSRCluster.html#o16">ph</a>.<a class="code" href="classNtpSRStripPulseHeight.html#o2">gev</a>;
01944                       elv += sqrt(fabs(1-sinang*sinang))*<a class="code" href="classMadBase.html#p16">ntpCluster</a>-&gt;<a class="code" href="classNtpSRCluster.html#o16">ph</a>.<a class="code" href="classNtpSRStripPulseHeight.html#o2">gev</a>;
01945                     }
01946                   }
01947                 }
01948               }
01949             }
01950             <span class="comment">/*</span>
01951 <span class="comment">            for(int ii=0; ii&lt;ncl; ii++){</span>
01952 <span class="comment">              if(LoadCluster(ntpShower-&gt;clu[ii])){</span>
01953 <span class="comment">                if(ntpCluster-&gt;ph.gev &gt;ss_cut){</span>
01954 <span class="comment">                  if(ntpCluster-&gt;id &lt;2){</span>
01955 <span class="comment">                    if(ntpCluster-&gt;planeview==PlaneView::kU){</span>
01956 <span class="comment">                      totsigssu+=ntpCluster-&gt;ph.gev;</span>
01957 <span class="comment">                      hswu_wtd.Fill(ntpCluster-&gt;tposvtx);</span>
01958 <span class="comment">                    }</span>
01959 <span class="comment">                    else if(ntpCluster-&gt;planeview==PlaneView::kV){</span>
01960 <span class="comment">                      totsigssv+=ntpCluster-&gt;ph.gev;</span>
01961 <span class="comment">                      hswv_wtd.Fill(ntpCluster-&gt;tposvtx);</span>
01962 <span class="comment">                    }</span>
01963 <span class="comment">                  }</span>
01964 <span class="comment">                }</span>
01965 <span class="comment">              }</span>
01966 <span class="comment">            }</span>
01967 <span class="comment">            */</span>
01968             <span class="comment">/*</span>
01969 <span class="comment">            swv=hswv.GetRMS();</span>
01970 <span class="comment">            swu=hswu.GetRMS();</span>
01971 <span class="comment">            wswv=hswv_wtd.GetRMS();</span>
01972 <span class="comment">            wswu=hswu_wtd.GetRMS();</span>
01973 <span class="comment">            */</span>
01974             swv=mom_swv.<a class="code" href="classMoments.html#a3">GetRMS</a>();
01975             swu=mom_swu.<a class="code" href="classMoments.html#a3">GetRMS</a>();
01976             wswv=mom_swv_wtd.<a class="code" href="classMoments.html#a3">GetRMS</a>();
01977             wswu=mom_swu_wtd.<a class="code" href="classMoments.html#a3">GetRMS</a>();
01978             
01980           }
01981           <span class="keywordflow">if</span>(ntrack==1 &amp;&amp; reco_enu&gt;0.0 &amp;&amp; reco_enu&lt;140
01982              &amp;&amp; is_pitt_fid &amp;&amp; pitt_trk_qual &amp;&amp; (is_trk_fid!=0)) pass=1;
01983 
01984         } <span class="comment">// if(reco_enu&gt;0)</span>
01985       } <span class="comment">// if(PassBasicCuts())</span>
01986       
01987       <span class="comment">// for both near in time and near in space</span>
01988       <span class="comment">// index of nearest, dist of nearest, ph of nearest</span>
01989       <span class="comment">// near_vtx_space_idx, near_vtx_space_dist, near_vtx_space_ph </span>
01990       <span class="comment">// nvsi, nvsd, nvsp</span>
01991       <span class="comment">// near_vtx_time_idx, near_vtx_time_dist, near_vtx_time_ph </span>
01992       <span class="comment">// nvti, nvtd, nvtp</span>
01993       <span class="comment">// for the nearest event, the index of the event nearest it</span>
01994       <span class="comment">// ph of event nearest it, distance of event nearest it</span>
01995       <span class="comment">//  maybe use for event rehashing</span>
01996       <span class="comment">// back_vtx_space_idx, back_vtx_space_dist, back_vtx_space_ph </span>
01997       <span class="comment">// bvsi, bvsd, bvsp</span>
01998       <span class="comment">// back_vtx_time_idx, back_vtx_time_dist, back_vtx_time_ph </span>
01999       <span class="comment">// bvti, bvtd, bvtp</span>
02000 
02001       nby.<a class="code" href="classNearbyVertexFinder.html#a4">ClosestSpatial</a>(i,nvsi,nvsd,nvst,nvsp,nvsevt);
02002       nby.<a class="code" href="classNearbyVertexFinder.html#a4">ClosestSpatial</a>(nvsi,bvsi,bvsd,bvst,bvsp,bvsevt);
02003       nby.<a class="code" href="classNearbyVertexFinder.html#a5">ClosestTemporal</a>(i,nvti,nvtd,nvtt,nvtp,nvtevt);
02004       nby.<a class="code" href="classNearbyVertexFinder.html#a5">ClosestTemporal</a>(nvti,bvti,bvtd,bvtt,bvtp,bvtevt);
02005 
02006       <a class="code" href="classMadMKAnalysis.html#b13">GetEvtTimeChar</a>(evttimemin,evttimemax,evttimeln);
02007       <a class="code" href="classMadMKAnalysis.html#b14">GetEvtTimeCharPHC</a>(evttimeminphc,evttimemaxphc,evttimelnphc);
02008       <a class="code" href="classMadMKAnalysis.html#b16">EarlyActivity</a>(i,earlywph,earlywphpw,earlywphsphere,
02009                     ph1000,ph500,ph100,lateph1000,lateph500,
02010                     lateph100,lateph50);
02011       evtph = <a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o19">ph</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>;
02012 
02013       <a class="code" href="classMadMKAnalysis.html#b17">DupRecoStrips</a>(i,nduprs,dupphrs);
02014 
02016       <span class="keywordflow">if</span>(file_is_mc){
02017         <span class="keywordflow">if</span>(gnumi-&gt;<a class="code" href="classGnumiInterface.html#a3">Status</a>()) {
02018           <span class="keywordflow">if</span>(<a class="code" href="classMadBase.html#p35">isST</a>) gnumi-&gt;<a class="code" href="classGnumiInterface.html#a4">GetParent</a>(strecord,mcevent,*nuparent);
02019           <span class="keywordflow">else</span> gnumi-&gt;<a class="code" href="classGnumiInterface.html#a4">GetParent</a>(mcrecord,mcevent,*nuparent);
02020         }               
02021       }
02023 
02027       <span class="keywordflow">if</span>(<a class="code" href="classMadMKAnalysis.html#r3">fDoInukeReweight</a> &amp;&amp; file_is_mc &amp;&amp; inukerw!=0) {
02028         
02029         <span class="keywordflow">if</span>((<a class="code" href="classMadMKAnalysis.html#r4">fOnlyWriteFidEvents</a> &amp;&amp; is_pitt_fid==1) || !<a class="code" href="classMadMKAnalysis.html#r4">fOnlyWriteFidEvents</a>){
02030           std::vector&lt;double&gt; weights(n_inuke_wts,1.0);
02031           <span class="comment">//    std::cout&lt;&lt;"snarl, event: "&lt;&lt;snarl&lt;&lt;", "&lt;&lt;event&lt;&lt;std::endl;</span>
02032           <a class="code" href="namespaceinuke__reweight.html#a15">inuke_reweight::calc_weights</a>(strecord,ntpTruth,psets,weights,nucrad,wrad,<span class="keyword">false</span>);
02033           <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iwt=0; iwt&lt;weights.size(); iwt++) inuke_wts[iwt]=weights[iwt];
02034         }
02035         <span class="comment">// nuclear radius and weighting factor</span>
02036 
02037       }
02041 
02043       <span class="keywordflow">if</span>((<a class="code" href="classMadMKAnalysis.html#r4">fOnlyWriteFidEvents</a> &amp;&amp; is_pitt_fid==1) || !<a class="code" href="classMadMKAnalysis.html#r4">fOnlyWriteFidEvents</a>) {
02044         tree-&gt;Fill(); <span class="keywordflow">if</span>(inukerw!=0 &amp;&amp; inukerw!=tree) inukerw-&gt;Fill();
02045       }
02046 
02047 
02048     } <span class="comment">// loop over events</span>
02049   } <span class="comment">// loop over entries</span>
02050   
02051   <span class="comment">// delete nuparent; // should I do this?</span>
02052   save.cd();
02053   pottree-&gt;Fill();
02054   pottree-&gt;Write();
02055   tree-&gt;Write();<span class="keywordflow">if</span>(inukerw!=0 &amp;&amp; inukerw!=tree) inukerw-&gt;Write();
02056 
02057   save.Write();
02058   save.Close();
02059 
02060 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="MadMKAnalysis::DoInukeReweight" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void MadMKAnalysis::DoInukeReweight </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">bool&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>t</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8h-source.html#l00141">141</a> of file <a class="el" href="MadMKAnalysis_8h-source.html">MadMKAnalysis.h</a>.
<p>
References <a class="el" href="MadMKAnalysis_8h-source.html#l00229">fDoInukeReweight</a>.
<p>
<div class="fragment"><pre>00141 {<a class="code" href="classMadMKAnalysis.html#r3">fDoInukeReweight</a>=t;}
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="b17" doxytag="MadMKAnalysis::DupRecoStrips" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void MadMKAnalysis::DupRecoStrips </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>evidx</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>nduprs</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>float &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>dupphrs</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8cxx-source.html#l03158">3158</a> of file <a class="el" href="MadMKAnalysis_8cxx-source.html">MadMKAnalysis.cxx</a>.
<p>
References <a class="el" href="MadBase_8cxx-source.html#l00536">MadBase::LoadEvent()</a>, <a class="el" href="MadBase_8cxx-source.html#l00692">MadBase::LoadStrip()</a>, <a class="el" href="NtpSREventSummary_8h-source.html#l00045">NtpSREventSummary::nevent</a>, <a class="el" href="NtpSREvent_8h-source.html#l00062">NtpSREvent::nstrip</a>, <a class="el" href="NtpSRStrip_8h-source.html#l00059">NtpSRStrip::ph0</a>, <a class="el" href="NtpSRStrip_8h-source.html#l00060">NtpSRStrip::ph1</a>, <a class="el" href="NtpSRPulseHeight_8h-source.html#l00037">NtpSRPulseHeight::sigcor</a>, and <a class="el" href="NtpSREvent_8h-source.html#l00063">NtpSREvent::stp</a>.
<p>
Referenced by <a class="el" href="MadMKAnalysis_8cxx-source.html#l00265">CreatePAN()</a>.
<p>
<div class="fragment"><pre>03159 {
03160   <span class="comment">//zero the variables</span>
03161   nduprs=0;
03162   dupphrs=0.;
03163 
03164   <span class="keywordflow">if</span>(!<a class="code" href="classMadBase.html#b3">LoadEvent</a>(evidx)) <span class="keywordflow">return</span>; <span class="comment">//no event found</span>
03165   
03166   map&lt;int,float&gt; sindex;
03167   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o4">nstrip</a>;i++){
03168     <span class="keywordtype">int</span> si = <a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o5">stp</a>[i];
03169     <span class="keywordflow">if</span>(!<a class="code" href="classMadBase.html#b6">LoadStrip</a>(si)) <span class="keywordflow">continue</span>;
03170     <span class="keywordtype">float</span> ph = <a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o12">ph0</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>+<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o13">ph1</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>;
03171     sindex[<a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o5">stp</a>[i]]=ph;
03172   }
03173 
03174   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="classMadBase.html#p10">eventSummary</a>-&gt;<a class="code" href="classNtpSREventSummary.html#o6">nevent</a>;i++){
03175     <span class="keywordflow">if</span>(i==evidx){
03176       <span class="keywordflow">continue</span>;
03177     }
03178     <a class="code" href="classMadBase.html#b3">LoadEvent</a>(i);  <span class="comment">//load a new event</span>
03179     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;<a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o4">nstrip</a>;j++){
03180       map&lt;int,float&gt;::iterator it(sindex.find(<a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o5">stp</a>[j]));
03181       <span class="keywordflow">if</span>(it!=sindex.end()){
03182         nduprs++;
03183         dupphrs+=it-&gt;second;
03184       }
03185     }
03186   }
03187 
03188   <span class="comment">//reload the current event</span>
03189   <a class="code" href="classMadBase.html#b3">LoadEvent</a>(evidx);
03190 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="b16" doxytag="MadMKAnalysis::EarlyActivity" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void MadMKAnalysis::EarlyActivity </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>evidx</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>float &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>earlywph</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>float &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>earlywphpw</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>float &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>earlywphsphere</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>float &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>ph1000</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>float &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>ph500</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>float &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>ph100</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>float &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>lateph1000</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>float &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>lateph500</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>float &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>lateph100</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>float &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>lateph50</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8cxx-source.html#l02802">2802</a> of file <a class="el" href="MadMKAnalysis_8cxx-source.html">MadMKAnalysis.cxx</a>.
<p>
References <a class="el" href="MadMKAnalysis_8cxx-source.html#l00187">fEarlyActivityWindowSize</a>, <a class="el" href="MadMKAnalysis_8cxx-source.html#l00190">fEarlyPlaneSphere</a>, <a class="el" href="MadMKAnalysis_8cxx-source.html#l00189">fNPlaneEarlyAct</a>, <a class="el" href="MadMKAnalysis_8cxx-source.html#l00188">fPMTTimeConstant</a>, <a class="el" href="MadBase_8cxx-source.html#l00536">MadBase::LoadEvent()</a>, <a class="el" href="MadBase_8cxx-source.html#l00692">MadBase::LoadStrip()</a>, <a class="el" href="NtpSREventSummary_8h-source.html#l00040">NtpSREventSummary::nstrip</a>, <a class="el" href="NtpSREvent_8h-source.html#l00062">NtpSREvent::nstrip</a>, <a class="el" href="NtpSRStrip_8h-source.html#l00059">NtpSRStrip::ph0</a>, <a class="el" href="NtpSRStrip_8h-source.html#l00060">NtpSRStrip::ph1</a>, <a class="el" href="NtpSRVertex_8h-source.html#l00037">NtpSRVertex::plane</a>, <a class="el" href="NtpSRStrip_8h-source.html#l00052">NtpSRStrip::plane</a>, <a class="el" href="NtpSRStrip_8h-source.html#l00048">NtpSRStrip::planeview</a>, <a class="el" href="NtpSRStrip_8h-source.html#l00055">NtpSRStrip::pmtindex0</a>, <a class="el" href="NtpSRStrip_8h-source.html#l00056">NtpSRStrip::pmtindex1</a>, <a class="el" href="nrutil__val_8h-source.html#l00374">pow()</a>, <a class="el" href="idep__ldep_8cxx-source.html#l00984">s()</a>, <a class="el" href="NtpSRPulseHeight_8h-source.html#l00037">NtpSRPulseHeight::sigcor</a>, <a class="el" href="NtpSREvent_8h-source.html#l00063">NtpSREvent::stp</a>, <a class="el" href="NtpSRStrip_8h-source.html#l00057">NtpSRStrip::time0</a>, <a class="el" href="NtpSRStrip_8h-source.html#l00058">NtpSRStrip::time1</a>, <a class="el" href="NtpSRStrip_8h-source.html#l00053">NtpSRStrip::tpos</a>, <a class="el" href="NtpSREventSummary_8h-source.html#l00046">NtpSREventSummary::trigtime</a>, <a class="el" href="NtpSRVertex_8h-source.html#l00038">NtpSRVertex::u</a>, <a class="el" href="NtpSRVertex_8h-source.html#l00039">NtpSRVertex::v</a>, <a class="el" href="NtpSREvent_8h-source.html#l00086">NtpSREvent::vtx</a>, <a class="el" href="NtpSRStrip_8h-source.html#l00054">NtpSRStrip::z</a>, and <a class="el" href="NtpSRVertex_8h-source.html#l00042">NtpSRVertex::z</a>.
<p>
Referenced by <a class="el" href="MadMKAnalysis_8cxx-source.html#l00265">CreatePAN()</a>.
<p>
<div class="fragment"><pre>02812 {
02813   <span class="comment">//zero the variables</span>
02814   earlywph=0.;
02815   earlywphpw=0.; 
02816   earlywphsphere=0.;
02817   ph1000=0.;
02818   ph500=0.;
02819   ph100=0.;
02820   lateph1000=0.;
02821   lateph500=0.;
02822   lateph100=0.;
02823   lateph50=0.;
02824 
02825   <span class="keywordflow">if</span>(!<a class="code" href="classMadBase.html#b3">LoadEvent</a>(evidx)) <span class="keywordflow">return</span>; <span class="comment">//no event found</span>
02826   
02827   <span class="comment">//find the time of the earliest strip in the event</span>
02828   <span class="keywordtype">double</span> earliestEventTime = 1.e20;
02829   <span class="keywordtype">double</span> latestEventTime = 0.;
02830   map&lt;int,int&gt; eventPlanes;
02831   <span class="keywordtype">double</span> trigtime = <a class="code" href="classMadBase.html#p10">eventSummary</a>-&gt;<a class="code" href="classNtpSREventSummary.html#o7">trigtime</a>;
02832 
02833   <span class="comment">//loop over strips in the event</span>
02834   <span class="comment">//find the earliest strip time </span>
02835   <span class="comment">//make a map of the pmt's hit in this event</span>
02836   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="idep__ldep_8cxx.html#a10">s</a>=0;<a class="code" href="idep__ldep_8cxx.html#a10">s</a>&lt;<a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o4">nstrip</a>;<a class="code" href="idep__ldep_8cxx.html#a10">s</a>++){
02837     <span class="keywordtype">int</span> stripindex = <a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o5">stp</a>[<a class="code" href="idep__ldep_8cxx.html#a10">s</a>];
02838     <span class="keywordflow">if</span>(!<a class="code" href="classMadBase.html#b6">LoadStrip</a>(stripindex)) <span class="keywordflow">continue</span>;
02839     <span class="comment">//calculate ph weighted strip time (over the two ends,</span>
02840     <span class="comment">//should be equivalent to ph1 in ND</span>
02841     <span class="keywordtype">float</span> phwt = ((<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o13">ph1</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>*<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o11">time1</a>+
02842                    <a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o12">ph0</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>*<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o10">time0</a>)/
02843                   (<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o13">ph1</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>+<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o12">ph0</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>));
02844       
02845     <span class="keywordtype">double</span> time = 1.e9*(phwt-trigtime);
02846     <span class="keywordflow">if</span>(time&lt;earliestEventTime){
02847       earliestEventTime = time;
02848     }
02849     <span class="keywordflow">if</span>(time&gt;latestEventTime){
02850       latestEventTime=time;
02851     }
02852     <span class="keywordflow">if</span>(<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o13">ph1</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>&gt;0){
02853       <span class="keywordflow">if</span>(eventPlanes.find(<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o9">pmtindex1</a>)==eventPlanes.end()){
02854         eventPlanes[<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o9">pmtindex1</a>] = 1;
02855       }
02856     }
02857     <span class="keywordflow">if</span>(<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o12">ph0</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>&gt;0){
02858       <span class="keywordflow">if</span>(eventPlanes.find(<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o8">pmtindex0</a>)==eventPlanes.end()){
02859         eventPlanes[<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o9">pmtindex1</a>] = 1;
02860       }
02861     }
02862   }
02863 
02864   <span class="comment">//now find the weigthed sum of ADC for the early strips - make sure the early</span>
02865   <span class="comment">//strips come from the same pmts as the event strips.</span>
02866   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="idep__ldep_8cxx.html#a10">s</a>=0;<a class="code" href="idep__ldep_8cxx.html#a10">s</a>&lt;<a class="code" href="classMadBase.html#p10">eventSummary</a>-&gt;<a class="code" href="classNtpSREventSummary.html#o1">nstrip</a>;<a class="code" href="idep__ldep_8cxx.html#a10">s</a>++){
02867     <span class="keywordflow">if</span>(!<a class="code" href="classMadBase.html#b6">LoadStrip</a>(s)) <span class="keywordflow">continue</span>;
02868     <span class="comment">//work in ns</span>
02869     <span class="keywordtype">float</span> phwt = ((<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o13">ph1</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>*<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o11">time1</a>+
02870                    <a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o12">ph0</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>*<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o10">time0</a>)/
02871                   (<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o13">ph1</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>+<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o12">ph0</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>));
02872     <span class="keywordtype">double</span> newtime = 1.e9*(phwt-trigtime);
02873     <span class="keywordtype">double</span> dt=(earliestEventTime-newtime);
02874     <span class="keywordtype">double</span> dtlate=newtime-latestEventTime;
02875     <span class="keywordtype">float</span> d=1000.;
02876     <span class="keywordflow">if</span>((<span class="keywordtype">int</span>)<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o1">planeview</a>==PlaneView::kU){
02877       d=sqrt((<a class="code" href="nrutil__val_8h.html#a22">pow</a>(<a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o21">vtx</a>.<a class="code" href="classNtpSRVertex.html#o1">u</a>-<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o6">tpos</a>,2)+
02878               <a class="code" href="nrutil__mtl_8h.html#a20">pow</a>(<a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o21">vtx</a>.<a class="code" href="classNtpSRVertex.html#o5">z</a>-<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o7">z</a>,2)));
02879     }
02880     <span class="keywordflow">else</span>{
02881       d=sqrt((<a class="code" href="nrutil__val_8h.html#a22">pow</a>(<a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o21">vtx</a>.<a class="code" href="classNtpSRVertex.html#o2">v</a>-<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o6">tpos</a>,2)+
02882               <a class="code" href="nrutil__mtl_8h.html#a20">pow</a>(<a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o21">vtx</a>.<a class="code" href="classNtpSRVertex.html#o5">z</a>-<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o7">z</a>,2)));
02883     }
02884     <span class="keywordflow">if</span>(d&lt;fEarlyPlaneSphere&amp;&amp;dtlate&gt;0.){
02885       <span class="keywordflow">if</span>(dtlate&lt;1000.){
02886         lateph1000+=<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o13">ph1</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>+<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o12">ph0</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>;
02887       }
02888       <span class="keywordflow">if</span>(dtlate&lt;500.){
02889         lateph500+=<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o13">ph1</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>+<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o12">ph0</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>;
02890       }
02891       <span class="keywordflow">if</span>(dtlate&lt;100.){
02892         lateph100+=<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o13">ph1</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>+<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o12">ph0</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>;
02893       }
02894       <span class="keywordflow">if</span>(dtlate&lt;50.){
02895         lateph50+=<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o13">ph1</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>+<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o12">ph0</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>;
02896       }
02897     }   
02898     <span class="keywordflow">if</span>(d&lt;fEarlyPlaneSphere&amp;&amp;dt&gt;0.){
02899       <span class="keywordflow">if</span>(dt&lt;1000.){
02900         ph1000+=<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o13">ph1</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>+<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o12">ph0</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>;
02901       }
02902       <span class="keywordflow">if</span>(dt&lt;500.){
02903         ph500+=<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o13">ph1</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>+<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o12">ph0</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>;
02904       }
02905       <span class="keywordflow">if</span>(dt&lt;100.){
02906         ph100+=<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o13">ph1</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>+<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o12">ph0</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>;
02907       }
02908     }
02909     <span class="keywordflow">if</span>(dt&gt;0.&amp;&amp;dt&lt;1000.*<a class="code" href="classMadMKAnalysis.html#v7">fEarlyActivityWindowSize</a>){
02910       <span class="keywordtype">double</span> eadc = ((<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o13">ph1</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>+<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o13">ph1</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>)*
02911                      TMath::Exp(-1.*dt/fPMTTimeConstant));
02912       <span class="comment">//if this strip has activity in the same pmt as our event,</span>
02913       <span class="comment">//sum up the early pulse height</span>
02914       <span class="keywordflow">if</span>(eventPlanes.find(<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o9">pmtindex1</a>)!=eventPlanes.end()){
02915         earlywph += eadc;
02916       }      
02917       <span class="comment">//if this strip is within some radius of event vertex, </span>
02918       <span class="comment">//add up the early pulse height</span>
02919       <span class="keywordflow">if</span>(d&lt;<a class="code" href="classMadMKAnalysis.html#v10">fEarlyPlaneSphere</a>){
02920         earlywphsphere+=eadc;
02921       }
02922       <span class="comment">//if this strip is within the plane window of event vertex,</span>
02923       <span class="comment">//add up the early pulseheight</span>
02924       <span class="keywordflow">if</span>(<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o5">plane</a>&gt;=<a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o21">vtx</a>.<a class="code" href="classNtpSRVertex.html#o0">plane</a>&amp;&amp;
02925          <a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o5">plane</a>&lt;=<a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o21">vtx</a>.<a class="code" href="classNtpSRVertex.html#o0">plane</a>+<a class="code" href="classMadMKAnalysis.html#v9">fNPlaneEarlyAct</a>){
02926         earlywphpw+=eadc;
02927       }
02928     }
02929   }
02930 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="e4" doxytag="MadMKAnalysis::FarTrkContained" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int MadMKAnalysis::FarTrkContained </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Float_t&nbsp;</td>
          <td class="mdname" nowrap> <em>x</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>Float_t&nbsp;</td>
          <td class="mdname" nowrap> <em>y</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>Float_t&nbsp;</td>
          <td class="mdname" nowrap> <em>z</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8cxx-source.html#l03118">3118</a> of file <a class="el" href="MadMKAnalysis_8cxx-source.html">MadMKAnalysis.cxx</a>.
<p>
Referenced by <a class="el" href="MadMKAnalysis_8cxx-source.html#l00265">CreatePAN()</a>, <a class="el" href="MadScanDisplay_8cxx-source.html#l03257">MadScanDisplay::DrawTextBox()</a>, and <a class="el" href="MadEvDisplay_8cxx-source.html#l02634">MadEvDisplay::DrawTextBox()</a>.
<p>
<div class="fragment"><pre>03119 {
03120   <span class="keywordtype">int</span> is_cont=0;
03121   <span class="comment">//arguments should correspond to track end</span>
03122   <span class="comment">//returns:</span>
03123   <span class="comment">//1 if track is partially contained</span>
03124   <span class="comment">//2 if  track is fully contained</span>
03125   <span class="keyword">const</span> Float_t r = sqrt(x*x+y*y);
03126 
03127   <span class="keywordflow">if</span>(r&lt;=3.5&amp;&amp;r&gt;.5&amp;&amp;((z&gt;=0.5&amp;&amp;z&lt;=14.5)||(z&gt;=16.5&amp;&amp;z&lt;=29.4))){<span class="comment">//contained</span>
03128     is_cont=2;
03129   }
03130   <span class="keywordflow">else</span>{<span class="comment">//not contained</span>
03131     is_cont=1;
03132   }
03133   <span class="keywordflow">return</span> is_cont;
03134 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="MadMKAnalysis::FillMCHists" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void MadMKAnalysis::FillMCHists </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">TFile *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>fout</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8cxx-source.html#l02933">2933</a> of file <a class="el" href="MadMKAnalysis_8cxx-source.html">MadMKAnalysis.cxx</a>.
<p>
References <a class="el" href="NtpMCTruth_8h-source.html#l00045">NtpMCTruth::iaction</a>, <a class="el" href="NtpMCTruth_8h-source.html#l00038">NtpMCTruth::inu</a>, <a class="el" href="NtpMCTruth_8h-source.html#l00044">NtpMCTruth::iresonance</a>, <a class="el" href="MadBase_8cxx-source.html#l00553">MadBase::LoadTruth()</a>, <a class="el" href="MadMKAnalysis_8cxx-source.html#l02266">NDRadialFidVol()</a>, <a class="el" href="NtpMCSummary_8h-source.html#l00037">NtpMCSummary::nmc</a>, <a class="el" href="NtpMCTruth_8h-source.html#l00067">NtpMCTruth::p4neu</a>, <a class="el" href="MadMKAnalysis_8cxx-source.html#l02282">PittInFidVol()</a>, <a class="el" href="NtpMCTruth_8h-source.html#l00064">NtpMCTruth::vtxx</a>, <a class="el" href="NtpMCTruth_8h-source.html#l00065">NtpMCTruth::vtxy</a>, and <a class="el" href="NtpMCTruth_8h-source.html#l00066">NtpMCTruth::vtxz</a>.
<p>
Referenced by <a class="el" href="MadMKAnalysis_8cxx-source.html#l00265">CreatePAN()</a>.
<p>
<div class="fragment"><pre>02933                                           {
02934 
02935   <span class="keyword">static</span> <span class="keywordtype">bool</span> first=<span class="keyword">true</span>;
02936 
02937   <span class="keyword">static</span> TH1* h_numu_pf_tot = <span class="keyword">new</span> TH1F(<span class="stringliteral">"h_numu_pf_tot"</span>,<span class="stringliteral">"CC; true neutrino energy (GeV)"</span>,
02938                                  240,0.0,120.0);
02939 
02940   <span class="keyword">static</span> TH1* h_numu_pf_qe = <span class="keyword">new</span> TH1F(<span class="stringliteral">"h_numu_pf_qe"</span>,<span class="stringliteral">"QE; true neutrino energy (GeV)"</span>,
02941                                  240,0.0,120.0);
02942 
02943   <span class="keyword">static</span> TH1* h_numu_pf_res = <span class="keyword">new</span> TH1F(<span class="stringliteral">"h_numu_pf_res"</span>,<span class="stringliteral">"RES; true neutrino energy (GeV)"</span>,
02944                                  240,0.0,120.0);
02945 
02946   <span class="keyword">static</span> TH1* h_numu_pf_dis = <span class="keyword">new</span> TH1F(<span class="stringliteral">"h_numu_pf_dis"</span>,<span class="stringliteral">"DIS; true neutrino energy (GeV)"</span>,
02947                                  240,0.0,120.0);
02948   <span class="keyword">static</span> TH1* h_numu_pf_nc = <span class="keyword">new</span> TH1F(<span class="stringliteral">"h_numu_pf_nc"</span>,<span class="stringliteral">"NC; true neutrino energy (GeV)"</span>,
02949                                  240,0.0,120.0);
02950   <span class="keywordflow">if</span>(first){
02951     h_numu_pf_tot-&gt;SetDirectory(fout);
02952     h_numu_pf_qe-&gt;SetDirectory(fout);
02953     h_numu_pf_res-&gt;SetDirectory(fout);
02954     h_numu_pf_dis-&gt;SetDirectory(fout);
02955     h_numu_pf_nc-&gt;SetDirectory(fout);
02956   }
02957 
02958   <span class="keyword">static</span> TH1* h_numubar_pf_tot = <span class="keyword">new</span> TH1F(<span class="stringliteral">"h_numubar_pf_tot"</span>,<span class="stringliteral">"CC; true neutrino energy (GeV)"</span>,
02959                                  240,0.0,120.0);
02960 
02961   <span class="keyword">static</span> TH1* h_numubar_pf_qe = <span class="keyword">new</span> TH1F(<span class="stringliteral">"h_numubar_pf_qe"</span>,<span class="stringliteral">"QE; true neutrino energy (GeV)"</span>,
02962                                  240,0.0,120.0);
02963 
02964   <span class="keyword">static</span> TH1* h_numubar_pf_res = <span class="keyword">new</span> TH1F(<span class="stringliteral">"h_numubar_pf_res"</span>,<span class="stringliteral">"RES; true neutrino energy (GeV)"</span>,
02965                                  240,0.0,120.0);
02966 
02967   <span class="keyword">static</span> TH1* h_numubar_pf_dis = <span class="keyword">new</span> TH1F(<span class="stringliteral">"h_numubar_pf_dis"</span>,<span class="stringliteral">"DIS; true neutrino energy (GeV)"</span>,
02968                                  240,0.0,120.0);
02969   <span class="keyword">static</span> TH1* h_numubar_pf_nc = <span class="keyword">new</span> TH1F(<span class="stringliteral">"h_numubar_pf_nc"</span>,<span class="stringliteral">"NC; true neutrino energy (GeV)"</span>,
02970                                  240,0.0,120.0);
02971   <span class="keywordflow">if</span>(first){
02972     h_numubar_pf_tot-&gt;SetDirectory(fout);
02973     h_numubar_pf_qe-&gt;SetDirectory(fout);
02974     h_numubar_pf_res-&gt;SetDirectory(fout);
02975     h_numubar_pf_dis-&gt;SetDirectory(fout);
02976     h_numubar_pf_nc-&gt;SetDirectory(fout);
02977   }
02978 
02979 
02980 
02981   <span class="keyword">static</span> TH1* h_numu_1m_tot = <span class="keyword">new</span> TH1F(<span class="stringliteral">"h_numu_1m_tot"</span>,<span class="stringliteral">"CC; true neutrino energy (GeV)"</span>,
02982                                  240,0.0,120.0);
02983 
02984   <span class="keyword">static</span> TH1* h_numu_1m_qe = <span class="keyword">new</span> TH1F(<span class="stringliteral">"h_numu_1m_qe"</span>,<span class="stringliteral">"QE; true neutrino energy (GeV)"</span>,
02985                                  240,0.0,120.0);
02986 
02987   <span class="keyword">static</span> TH1* h_numu_1m_res = <span class="keyword">new</span> TH1F(<span class="stringliteral">"h_numu_1m_res"</span>,<span class="stringliteral">"RES; true neutrino energy (GeV)"</span>,
02988                                  240,0.0,120.0);
02989 
02990   <span class="keyword">static</span> TH1* h_numu_1m_dis = <span class="keyword">new</span> TH1F(<span class="stringliteral">"h_numu_1m_dis"</span>,<span class="stringliteral">"DIS; true neutrino energy (GeV)"</span>,
02991                                  240,0.0,120.0);
02992   <span class="keyword">static</span> TH1* h_numu_1m_nc = <span class="keyword">new</span> TH1F(<span class="stringliteral">"h_numu_1m_nc"</span>,<span class="stringliteral">"NC; true neutrino energy (GeV)"</span>,
02993                                  240,0.0,120.0);
02994   <span class="keywordflow">if</span>(first){
02995     h_numu_1m_tot-&gt;SetDirectory(fout);
02996     h_numu_1m_qe-&gt;SetDirectory(fout);
02997     h_numu_1m_res-&gt;SetDirectory(fout);
02998     h_numu_1m_dis-&gt;SetDirectory(fout);
02999     h_numu_1m_nc-&gt;SetDirectory(fout);
03000   }
03001 
03002   <span class="keyword">static</span> TH1* h_numubar_1m_tot = <span class="keyword">new</span> TH1F(<span class="stringliteral">"h_numubar_1m_tot"</span>,<span class="stringliteral">"CC; true neutrino energy (GeV)"</span>,
03003                                  240,0.0,120.0);
03004 
03005   <span class="keyword">static</span> TH1* h_numubar_1m_qe = <span class="keyword">new</span> TH1F(<span class="stringliteral">"h_numubar_1m_qe"</span>,<span class="stringliteral">"QE; true neutrino energy (GeV)"</span>,
03006                                  240,0.0,120.0);
03007 
03008   <span class="keyword">static</span> TH1* h_numubar_1m_res = <span class="keyword">new</span> TH1F(<span class="stringliteral">"h_numubar_1m_res"</span>,<span class="stringliteral">"RES; true neutrino energy (GeV)"</span>,
03009                                  240,0.0,120.0);
03010 
03011   <span class="keyword">static</span> TH1* h_numubar_1m_dis = <span class="keyword">new</span> TH1F(<span class="stringliteral">"h_numubar_1m_dis"</span>,<span class="stringliteral">"DIS; true neutrino energy (GeV)"</span>,
03012                                  240,0.0,120.0);
03013   <span class="keyword">static</span> TH1* h_numubar_1m_nc = <span class="keyword">new</span> TH1F(<span class="stringliteral">"h_numubar_1m_nc"</span>,<span class="stringliteral">"NC; true neutrino energy (GeV)"</span>,
03014                                  240,0.0,120.0);
03015   <span class="keywordflow">if</span>(first){
03016     h_numubar_1m_tot-&gt;SetDirectory(fout);
03017     h_numubar_1m_qe-&gt;SetDirectory(fout);
03018     h_numubar_1m_res-&gt;SetDirectory(fout);
03019     h_numubar_1m_dis-&gt;SetDirectory(fout);
03020     h_numubar_1m_nc-&gt;SetDirectory(fout);
03021   }
03022 
03023 
03024   <span class="keyword">static</span> TH1* h_other_pf = <span class="keyword">new</span> TH1F(<span class="stringliteral">"h_other_pf"</span>,
03025                                     <span class="stringliteral">"other; true neutrino energy (GeV)"</span>,
03026                                     240,0.0,120.0);
03027 
03028   <span class="keyword">static</span> TH1* h_other_1m = <span class="keyword">new</span> TH1F(<span class="stringliteral">"h_other_1m"</span>,
03029                                     <span class="stringliteral">"other; true neutrino energy (GeV)"</span>,
03030                                     240,0.0,120.0);
03031   <span class="keywordflow">if</span>(first){
03032     h_other_pf-&gt;SetDirectory(fout);
03033     h_other_1m-&gt;SetDirectory(fout);
03034   }
03035   <span class="keywordflow">if</span>(!<a class="code" href="classMadBase.html#p21">mcHeader</a>) {
03036     first=<span class="keyword">true</span>;
03037     <span class="keywordflow">return</span>;
03038   }
03039   <span class="keywordflow">for</span>(Int_t i=0; i&lt;<a class="code" href="classMadBase.html#p21">mcHeader</a>-&gt;<a class="code" href="classNtpMCSummary.html#o1">nmc</a>; i++){
03040     <span class="keywordflow">if</span>(!<a class="code" href="classMadBase.html#b7">LoadTruth</a>(i)) <span class="keywordflow">continue</span>; <span class="comment">// no ntpmctruth</span>
03041     <span class="keyword">const</span> Float_t k = 1.0/sqrt(2.0);
03042     Float_t x = <a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o23">vtxx</a>;
03043     Float_t y = <a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o24">vtxy</a>;
03044     Float_t z = <a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o25">vtxz</a>;
03045     Float_t u = k*(y+x);
03046     Float_t v = k*(y-x);
03047     Bool_t inpf = <a class="code" href="classMadMKAnalysis.html#e0">PittInFidVol</a>(x,y,z,u,v);    
03048     Int_t ndr = <a class="code" href="classMadMKAnalysis.html#e3">NDRadialFidVol</a>(x,y,z);
03049     Bool_t inr =kFALSE;
03050     <span class="keywordflow">if</span>((ndr&amp;0x8)&gt;0) inr=kTRUE;
03051     Int_t <a class="code" href="classccnc.html">ccnc</a> = <a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o7">iaction</a>;
03052     Int_t <a class="code" href="classprocess.html">process</a> = <a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o6">iresonance</a>;
03053     Int_t inu = <a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o2">inu</a>;
03054     Float_t E = <a class="code" href="classMadBase.html#p22">ntpTruth</a>-&gt;<a class="code" href="classNtpMCTruth.html#o26">p4neu</a>[3];
03055 
03056     
03057     <span class="keywordflow">if</span>(inu==14){ <span class="comment">// neutrinos</span>
03058       <span class="keywordflow">if</span>(ccnc==0){
03059         <span class="keywordflow">if</span>(inpf) h_numu_pf_nc-&gt;Fill(E);
03060         <span class="keywordflow">if</span>(inr) h_numu_1m_nc-&gt;Fill(E);
03061       }
03062       <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ccnc==1){
03063         <span class="keywordflow">if</span>(inpf) h_numu_pf_tot-&gt;Fill(E);
03064         <span class="keywordflow">if</span>(inr) h_numu_1m_tot-&gt;Fill(E);
03065         <span class="keywordflow">switch</span>(process){
03066         <span class="keywordflow">case</span> 1001:
03067           <span class="keywordflow">if</span>(inpf) h_numu_pf_qe-&gt;Fill(E);
03068           <span class="keywordflow">if</span>(inr) h_numu_1m_qe-&gt;Fill(E);
03069           <span class="keywordflow">break</span>;
03070         <span class="keywordflow">case</span> 1002:
03071           <span class="keywordflow">if</span>(inpf) h_numu_pf_res-&gt;Fill(E);
03072           <span class="keywordflow">if</span>(inr) h_numu_1m_res-&gt;Fill(E);
03073           <span class="keywordflow">break</span>;
03074         <span class="keywordflow">case</span> 1003:
03075           <span class="keywordflow">if</span>(inpf) h_numu_pf_dis-&gt;Fill(E);
03076           <span class="keywordflow">if</span>(inr) h_numu_1m_dis-&gt;Fill(E);
03077           <span class="keywordflow">break</span>;
03078         <span class="keywordflow">default</span>:
03079           <span class="keywordflow">break</span>;
03080         }
03081       }
03082     }
03083     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(inu==-14){
03084       <span class="keywordflow">if</span>(ccnc==0){
03085         <span class="keywordflow">if</span>(inpf) h_numubar_pf_nc-&gt;Fill(E);
03086         <span class="keywordflow">if</span>(inr) h_numubar_1m_nc-&gt;Fill(E);
03087       }
03088       <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ccnc==1){
03089         <span class="keywordflow">if</span>(inpf) h_numubar_pf_tot-&gt;Fill(E);
03090         <span class="keywordflow">if</span>(inr) h_numubar_1m_tot-&gt;Fill(E);
03091         <span class="keywordflow">switch</span>(process){
03092         <span class="keywordflow">case</span> 1001:
03093           <span class="keywordflow">if</span>(inpf) h_numubar_pf_qe-&gt;Fill(E);
03094           <span class="keywordflow">if</span>(inr) h_numubar_1m_qe-&gt;Fill(E);
03095           <span class="keywordflow">break</span>;
03096         <span class="keywordflow">case</span> 1002:
03097           <span class="keywordflow">if</span>(inpf) h_numubar_pf_res-&gt;Fill(E);
03098           <span class="keywordflow">if</span>(inr) h_numubar_1m_res-&gt;Fill(E);
03099           <span class="keywordflow">break</span>;
03100         <span class="keywordflow">case</span> 1003:
03101           <span class="keywordflow">if</span>(inpf) h_numubar_pf_dis-&gt;Fill(E);
03102           <span class="keywordflow">if</span>(inr) h_numubar_1m_dis-&gt;Fill(E);
03103           <span class="keywordflow">break</span>;
03104         <span class="keywordflow">default</span>:
03105           <span class="keywordflow">break</span>;
03106         }
03107       }
03108     }
03109     <span class="keywordflow">else</span>{
03110       <span class="keywordflow">if</span>(inpf) h_other_pf-&gt;Fill(E);
03111       <span class="keywordflow">if</span>(inr) h_other_1m-&gt;Fill(E);
03112     }
03113   }
03114   
03115   first=<span class="keyword">false</span>;
03116 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="MadMKAnalysis::ForceMCBeam" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void MadMKAnalysis::ForceMCBeam </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const <a class="el" href="namespaceBeamType.html#a0">BeamType::BeamType_t</a> &amp;&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>beam</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8h-source.html#l00133">133</a> of file <a class="el" href="MadMKAnalysis_8h-source.html">MadMKAnalysis.h</a>.
<p>
References <a class="el" href="namespaceBeamType.html#a0">BeamType::BeamType_t</a>, and <a class="el" href="MadMKAnalysis_8h-source.html#l00227">fMCBeam</a>.
<p>
<div class="fragment"><pre>00133 {<a class="code" href="classMadMKAnalysis.html#r1">fMCBeam</a>=beam;}
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="b10" doxytag="MadMKAnalysis::GetBECRegistry" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="classRegistry.html">Registry</a>&amp; MadMKAnalysis::GetBECRegistry </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline, protected]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8h-source.html#l00178">178</a> of file <a class="el" href="MadMKAnalysis_8h-source.html">MadMKAnalysis.h</a>.
<p>
References <a class="el" href="MadMKAnalysis_8h-source.html#l00226">fBECConfig</a>.
<p>
<div class="fragment"><pre>00178 { <span class="keywordflow">return</span> <a class="code" href="classMadMKAnalysis.html#r0">fBECConfig</a>; }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="b13" doxytag="MadMKAnalysis::GetEvtTimeChar" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void MadMKAnalysis::GetEvtTimeChar </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">double &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>timemin</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>double &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>timemax</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>double &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>timeln</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8cxx-source.html#l02636">2636</a> of file <a class="el" href="MadMKAnalysis_8cxx-source.html">MadMKAnalysis.cxx</a>.
<p>
References <a class="el" href="VldContext_8h-source.html#l00051">VldContext::GetDetector()</a>, <a class="el" href="RecHeader_8h-source.html#l00028">RecHeader::GetVldContext()</a>, <a class="el" href="MadBase_8cxx-source.html#l00692">MadBase::LoadStrip()</a>, <a class="el" href="NtpSREvent_8h-source.html#l00062">NtpSREvent::nstrip</a>, <a class="el" href="NtpSREvent_8h-source.html#l00063">NtpSREvent::stp</a>, <a class="el" href="AltAlgSliceList_8h-source.html#l00043">striptime</a>, <a class="el" href="NtpSRStrip_8h-source.html#l00057">NtpSRStrip::time0</a>, <a class="el" href="NtpSRStrip_8h-source.html#l00058">NtpSRStrip::time1</a>, and <a class="el" href="NtpSREventSummary_8h-source.html#l00046">NtpSREventSummary::trigtime</a>.
<p>
Referenced by <a class="el" href="MadMKAnalysis_8cxx-source.html#l00265">CreatePAN()</a>.
<p>
<div class="fragment"><pre>02637 {
02638   <span class="comment">//cut and pasted, with minor changes from MadDpAnalysis.cxx</span>
02639   <span class="keywordtype">double</span> trgtime=<a class="code" href="classMadBase.html#p10">eventSummary</a>-&gt;<a class="code" href="classNtpSREventSummary.html#o7">trigtime</a>;
02640   <span class="keywordtype">double</span> timemax=0.;
02641   <span class="keywordtype">double</span> timemin=1.e10;
02642 
02643   <span class="comment">//  Find max min time of events by loading strips for ND </span>
02644   <span class="keywordflow">if</span>(<a class="code" href="classMadBase.html#p8">ntpHeader</a>-&gt;<a class="code" href="classRecHeader.html#a3">GetVldContext</a>().<a class="code" href="classVldContext.html#a4">GetDetector</a>()==<a class="code" href="classDetector.html#w8w2">Detector::kNear</a>){
02645     <span class="keywordflow">for</span>(Int_t evss=0;evss&lt;<a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o4">nstrip</a>;evss++){
02646       Int_t stp_index=((<a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o5">stp</a>)[evss]);
02647       <span class="keywordflow">if</span>(!<a class="code" href="classMadBase.html#b6">LoadStrip</a>(stp_index)) <span class="keywordflow">continue</span>;
02648       Double_t <a class="code" href="AltAlgSliceList_8h.html#a19">striptime</a>=<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o11">time1</a>-trgtime;
02649       <span class="keywordflow">if</span>(<a class="code" href="AltAlgSliceList_8h.html#a19">striptime</a>&lt;=timemin) timemin=<a class="code" href="AltAlgSliceList_8h.html#a19">striptime</a>;
02650       <span class="keywordflow">if</span>(<a class="code" href="AltAlgSliceList_8h.html#a19">striptime</a>&gt;=timemax) timemax=<a class="code" href="AltAlgSliceList_8h.html#a19">striptime</a>;
02651     }
02652   }      
02653   
02654   <span class="keywordflow">if</span>(<a class="code" href="classMadBase.html#p8">ntpHeader</a>-&gt;<a class="code" href="classRecHeader.html#a3">GetVldContext</a>().<a class="code" href="classVldContext.html#a4">GetDetector</a>()==<a class="code" href="classDetector.html#w8w3">Detector::kFar</a>){
02655     <span class="keywordflow">for</span>(Int_t evss=0;evss&lt;<a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o4">nstrip</a>;evss++){
02656       Int_t stp_index=((<a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o5">stp</a>)[evss]);
02657       <span class="keywordflow">if</span>(!<a class="code" href="classMadBase.html#b6">LoadStrip</a>(stp_index)) <span class="keywordflow">continue</span>;
02658       Double_t striptime1=<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o11">time1</a>-trgtime;
02659       Double_t striptime0=<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o10">time0</a>-trgtime;
02660       Double_t <a class="code" href="AltAlgSliceList_8h.html#a19">striptime</a> = 0;
02661       <span class="keywordflow">if</span>(striptime1&gt;0 &amp;&amp; striptime0&lt;0)  <a class="code" href="AltAlgSliceList_8h.html#a19">striptime</a>=striptime1;
02662       <span class="keywordflow">if</span>(striptime0&gt;0 &amp;&amp; striptime1&lt;0)  <a class="code" href="AltAlgSliceList_8h.html#a19">striptime</a>=striptime0;
02663       <span class="keywordflow">if</span>(striptime0&gt;0 &amp;&amp; striptime1&gt;0)  <a class="code" href="AltAlgSliceList_8h.html#a19">striptime</a>=(striptime0+striptime1)/2.;
02664       <span class="keywordflow">if</span>(<a class="code" href="AltAlgSliceList_8h.html#a19">striptime</a>&lt;=timemin) timemin=<a class="code" href="AltAlgSliceList_8h.html#a19">striptime</a>;
02665       <span class="keywordflow">if</span>(<a class="code" href="AltAlgSliceList_8h.html#a19">striptime</a>&gt;=timemax) timemax=<a class="code" href="AltAlgSliceList_8h.html#a19">striptime</a>;
02666     }
02667   }
02668 
02669     evttimemax=timemax;
02670     evttimemin=timemin;
02671     evttimeln=timemax-timemin;
02672 
02673 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="b14" doxytag="MadMKAnalysis::GetEvtTimeCharPHC" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void MadMKAnalysis::GetEvtTimeCharPHC </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">double &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>timemin</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>double &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>timemax</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>double &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>timeln</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8cxx-source.html#l02675">2675</a> of file <a class="el" href="MadMKAnalysis_8cxx-source.html">MadMKAnalysis.cxx</a>.
<p>
References <a class="el" href="VldContext_8h-source.html#l00051">VldContext::GetDetector()</a>, <a class="el" href="RecHeader_8h-source.html#l00028">RecHeader::GetVldContext()</a>, <a class="el" href="MadBase_8cxx-source.html#l00692">MadBase::LoadStrip()</a>, <a class="el" href="NtpSREvent_8h-source.html#l00062">NtpSREvent::nstrip</a>, <a class="el" href="NtpSRStrip_8h-source.html#l00059">NtpSRStrip::ph0</a>, <a class="el" href="NtpSRStrip_8h-source.html#l00060">NtpSRStrip::ph1</a>, <a class="el" href="NtpSRPulseHeight_8h-source.html#l00037">NtpSRPulseHeight::sigcor</a>, <a class="el" href="NtpSREvent_8h-source.html#l00063">NtpSREvent::stp</a>, <a class="el" href="AltAlgSliceList_8h-source.html#l00043">striptime</a>, <a class="el" href="NtpSRStrip_8h-source.html#l00057">NtpSRStrip::time0</a>, <a class="el" href="NtpSRStrip_8h-source.html#l00058">NtpSRStrip::time1</a>, and <a class="el" href="NtpSREventSummary_8h-source.html#l00046">NtpSREventSummary::trigtime</a>.
<p>
Referenced by <a class="el" href="MadMKAnalysis_8cxx-source.html#l00265">CreatePAN()</a>.
<p>
<div class="fragment"><pre>02676 {
02677   <span class="comment">//same as GetEvtTimeChar but only looking at hits with </span>
02678   <span class="comment">//pulse height &gt; 200 sig cor (~2pe) in near det</span>
02679   <span class="comment">//pulse height &gt; 160 sig cor in far det</span>
02680   <span class="keywordtype">double</span> trgtime=<a class="code" href="classMadBase.html#p10">eventSummary</a>-&gt;<a class="code" href="classNtpSREventSummary.html#o7">trigtime</a>;
02681   <span class="keywordtype">double</span> timemax=0.;
02682   <span class="keywordtype">double</span> timemin=1.e10;
02683 
02684   <span class="comment">//  Find max min time of events by loading strips for ND </span>
02685   <span class="keywordflow">if</span>(<a class="code" href="classMadBase.html#p8">ntpHeader</a>-&gt;<a class="code" href="classRecHeader.html#a3">GetVldContext</a>().<a class="code" href="classVldContext.html#a4">GetDetector</a>()==<a class="code" href="classDetector.html#w8w2">Detector::kNear</a>){
02686     <span class="keywordflow">for</span>(Int_t evss=0;evss&lt;<a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o4">nstrip</a>;evss++){
02687       Int_t stp_index=((<a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o5">stp</a>)[evss]);
02688       <span class="keywordflow">if</span>(!<a class="code" href="classMadBase.html#b6">LoadStrip</a>(stp_index)) <span class="keywordflow">continue</span>;
02689       Double_t <a class="code" href="AltAlgSliceList_8h.html#a19">striptime</a>=<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o11">time1</a>-trgtime;
02690       <span class="keywordflow">if</span>(<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o13">ph1</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>&gt;200){
02691         <span class="keywordflow">if</span>(<a class="code" href="AltAlgSliceList_8h.html#a19">striptime</a>&lt;=timemin) timemin=<a class="code" href="AltAlgSliceList_8h.html#a19">striptime</a>;
02692         <span class="keywordflow">if</span>(<a class="code" href="AltAlgSliceList_8h.html#a19">striptime</a>&gt;=timemax) timemax=<a class="code" href="AltAlgSliceList_8h.html#a19">striptime</a>;
02693       }
02694     }
02695   }      
02696   
02697   <span class="keywordflow">if</span>(<a class="code" href="classMadBase.html#p8">ntpHeader</a>-&gt;<a class="code" href="classRecHeader.html#a3">GetVldContext</a>().<a class="code" href="classVldContext.html#a4">GetDetector</a>()==<a class="code" href="classDetector.html#w8w3">Detector::kFar</a>){
02698     <span class="keywordflow">for</span>(Int_t evss=0;evss&lt;<a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o4">nstrip</a>;evss++){
02699       Int_t stp_index=((<a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o5">stp</a>)[evss]);
02700       <span class="keywordflow">if</span>(!<a class="code" href="classMadBase.html#b6">LoadStrip</a>(stp_index)) <span class="keywordflow">continue</span>;
02701       Double_t striptime1=<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o11">time1</a>-trgtime;
02702       Double_t striptime0=<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o10">time0</a>-trgtime;
02703       Double_t <a class="code" href="AltAlgSliceList_8h.html#a19">striptime</a> = 0;
02704       <span class="keywordflow">if</span>(striptime1&gt;0 &amp;&amp; striptime0&lt;0)  <a class="code" href="AltAlgSliceList_8h.html#a19">striptime</a>=striptime1;
02705       <span class="keywordflow">if</span>(striptime0&gt;0 &amp;&amp; striptime1&lt;0)  <a class="code" href="AltAlgSliceList_8h.html#a19">striptime</a>=striptime0;
02706       <span class="keywordflow">if</span>(striptime0&gt;0 &amp;&amp; striptime1&gt;0)  <a class="code" href="AltAlgSliceList_8h.html#a19">striptime</a>=(striptime0+striptime1)/2.;
02707       <span class="keywordflow">if</span>(<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o12">ph0</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>+<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o13">ph1</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>&gt;160){
02708         <span class="keywordflow">if</span>(<a class="code" href="AltAlgSliceList_8h.html#a19">striptime</a>&lt;=timemin) timemin=<a class="code" href="AltAlgSliceList_8h.html#a19">striptime</a>;
02709         <span class="keywordflow">if</span>(<a class="code" href="AltAlgSliceList_8h.html#a19">striptime</a>&gt;=timemax) timemax=<a class="code" href="AltAlgSliceList_8h.html#a19">striptime</a>;
02710       }
02711     }
02712   }
02713   
02714   evttimemax=timemax;
02715   evttimemin=timemin;
02716   evttimeln=timemax-timemin;
02717 
02718 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="MadMKAnalysis::GetForcedMCBeam" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> const <a class="el" href="namespaceBeamType.html#a0">BeamType::BeamType_t</a>&amp; MadMKAnalysis::GetForcedMCBeam </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8h-source.html#l00134">134</a> of file <a class="el" href="MadMKAnalysis_8h-source.html">MadMKAnalysis.h</a>.
<p>
References <a class="el" href="namespaceBeamType.html#a0">BeamType::BeamType_t</a>, and <a class="el" href="MadMKAnalysis_8h-source.html#l00227">fMCBeam</a>.
<p>
<div class="fragment"><pre>00134 {<span class="keywordflow">return</span> <a class="code" href="classMadMKAnalysis.html#r1">fMCBeam</a>;}
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="b8" doxytag="MadMKAnalysis::InFidVol" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> bool MadMKAnalysis::InFidVol </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">float&nbsp;</td>
          <td class="mdname" nowrap> <em>vx</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>float&nbsp;</td>
          <td class="mdname" nowrap> <em>vy</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>float&nbsp;</td>
          <td class="mdname" nowrap> <em>vx</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8cxx-source.html#l02072">2072</a> of file <a class="el" href="MadMKAnalysis_8cxx-source.html">MadMKAnalysis.cxx</a>.
<p>
References <a class="el" href="VldContext_8h-source.html#l00051">VldContext::GetDetector()</a>, <a class="el" href="RecHeader_8h-source.html#l00028">RecHeader::GetVldContext()</a>, <a class="el" href="MadMKAnalysis_8cxx-source.html#l00184">kXcenter</a>, <a class="el" href="MadMKAnalysis_8cxx-source.html#l00185">kYcenter</a>, and <a class="el" href="nrutil__val_8h-source.html#l00374">pow()</a>.
<p>
<div class="fragment"><pre>02072                                                         {
02073   <span class="comment">// assumes event has been loaded</span>
02074   <span class="comment">// check that vertex is in fiducial volume</span>
02075   <span class="keywordtype">bool</span> is_fid=<span class="keyword">false</span>;
02076 
02077   <span class="comment">// FD: from doc-1351-v2 : there is no coil cut!</span>
02078   <span class="keywordflow">if</span>(<a class="code" href="classMadBase.html#p8">ntpHeader</a>-&gt;<a class="code" href="classRecHeader.html#a3">GetVldContext</a>().<a class="code" href="classVldContext.html#a4">GetDetector</a>()==<a class="code" href="classDetector.html#w8w3">Detector::kFar</a>){
02079         <span class="comment">//fiducial criteria on vtx for far detector</span>
02080     is_fid = <span class="keyword">true</span>;
02081     <span class="keywordflow">if</span>(vz&lt;0.5 || vz&gt;28.0 ||   <span class="comment">//ends</span>
02082        (vz&lt;16.2&amp;&amp;vz&gt;14.3) ||  <span class="comment">//between SMs</span>
02083        ((vx*vx)+(vy*vy))&gt;14.0) is_fid = <span class="keyword">false</span>;
02084   }
02085   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classMadBase.html#p8">ntpHeader</a>-&gt;<a class="code" href="classRecHeader.html#a3">GetVldContext</a>().<a class="code" href="classVldContext.html#a4">GetDetector</a>()==<a class="code" href="classDetector.html#w8w2">Detector::kNear</a>){
02086     <span class="comment">//fiducial criteria on vtx for near detector</span>
02087 
02088     <span class="comment">//    float beamzerox = 1.4885;</span>
02089     <span class="comment">//    float beamzeroy = 0.1397-reco_vtxz*TMath::Tan(.058);</span>
02090 
02091     <span class="comment">//    float r=sqrt(pow((reco_vtxx-beamzerox),2)+pow((reco_vtxy-beamzeroy),2));</span>
02092 
02093 
02094     is_fid = <span class="keyword">false</span>;
02095     <span class="comment">// MAK: Sept 19, 2005: Modified to account for beam slope</span>
02096     <span class="comment">//    double radius = pow(vx-kXcenter,2) </span>
02097     <span class="comment">//      + pow(vy-(kYcenter -vz*TMath::Tan(0.058)),2);</span>
02098     <span class="keywordtype">double</span> radius = <a class="code" href="nrutil__val_8h.html#a22">pow</a>(vx-kXcenter,2) + <a class="code" href="nrutil__val_8h.html#a22">pow</a>(vy-kYcenter,2);
02099 
02100     radius=sqrt(radius);
02101     <span class="comment">// restrict vertices to target region and 1m radius</span>
02102     <span class="comment">/*</span>
02103 <span class="comment">    if(vz&gt;=kVetoEndZ &amp;&amp; </span>
02104 <span class="comment">       vz&lt;=kTargEndZ &amp;&amp;</span>
02105 <span class="comment">       radius&lt;=0.5) is_fid = true;    </span>
02106 <span class="comment">    */</span>
02107     <span class="comment">// restrict vertices to target region and 1m radius</span>
02108     <span class="keywordflow">if</span>(vz&gt;=1.0 &amp;&amp; vz&lt;=5.0 &amp;&amp; radius&lt;=1.0) is_fid = <span class="keyword">true</span>;
02109   }
02110   <span class="keywordflow">return</span> is_fid;
02111 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="b7" doxytag="MadMKAnalysis::InFidVol" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> bool MadMKAnalysis::InFidVol </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8cxx-source.html#l02067">2067</a> of file <a class="el" href="MadMKAnalysis_8cxx-source.html">MadMKAnalysis.cxx</a>.
<p>
References <a class="el" href="NtpSREvent_8h-source.html#l00086">NtpSREvent::vtx</a>, <a class="el" href="NtpSRVertex_8h-source.html#l00040">NtpSRVertex::x</a>, <a class="el" href="NtpSRVertex_8h-source.html#l00041">NtpSRVertex::y</a>, and <a class="el" href="NtpSRVertex_8h-source.html#l00042">NtpSRVertex::z</a>.
<p>
Referenced by <a class="el" href="MadMKAnalysis_8cxx-source.html#l00265">CreatePAN()</a>, and <a class="el" href="MadMKAnalysis_8cxx-source.html#l02062">InFidVol()</a>.
<p>
<div class="fragment"><pre>02068 {
02069   <span class="keywordflow">return</span> <a class="code" href="classMadMKAnalysis.html#b7">InFidVol</a>(<a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o21">vtx</a>.<a class="code" href="classNtpSRVertex.html#o3">x</a>,<a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o21">vtx</a>.<a class="code" href="classNtpSRVertex.html#o4">y</a>,<a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o21">vtx</a>.<a class="code" href="classNtpSRVertex.html#o5">z</a>);
02070 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="b6" doxytag="MadMKAnalysis::InFidVol" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> bool MadMKAnalysis::InFidVol </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Int_t&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>evidx</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8cxx-source.html#l02062">2062</a> of file <a class="el" href="MadMKAnalysis_8cxx-source.html">MadMKAnalysis.cxx</a>.
<p>
References <a class="el" href="MadMKAnalysis_8cxx-source.html#l02067">InFidVol()</a>, and <a class="el" href="MadBase_8cxx-source.html#l00536">MadBase::LoadEvent()</a>.
<p>
<div class="fragment"><pre>02062                                        {
02063   <span class="keywordflow">if</span>(!<a class="code" href="classMadBase.html#b3">LoadEvent</a>(evidx)) <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">//no event found</span>
02064   <span class="keywordflow">return</span> <a class="code" href="classMadMKAnalysis.html#b7">InFidVol</a>();
02065 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="e2" doxytag="MadMKAnalysis::InPartialRegion" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> Int_t MadMKAnalysis::InPartialRegion </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">UShort_t&nbsp;</td>
          <td class="mdname" nowrap> <em>plane</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>UShort_t&nbsp;</td>
          <td class="mdname" nowrap> <em>strip</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8cxx-source.html#l02350">2350</a> of file <a class="el" href="MadMKAnalysis_8cxx-source.html">MadMKAnalysis.cxx</a>.
<p>
Referenced by <a class="el" href="MadMKAnalysis_8cxx-source.html#l02410">SigInOut()</a>.
<p>
<div class="fragment"><pre>02350                                                                   {
02351   <span class="comment">// figure out if this (plane,strip) corresponds to something in</span>
02352   <span class="comment">// the partially instrumented region</span>
02353   <span class="comment">//</span>
02354   <span class="comment">// this region is defined as:</span>
02355   <span class="comment">// v planes: (strip&lt;=4 || strip&gt;=67)</span>
02356   <span class="comment">// partial u: (strip==0 || strip=63)</span>
02357   <span class="comment">// full u: (strip&lt;=26 || strip&gt;=88) </span>
02358   <span class="comment">//</span>
02359   <span class="comment">// if so, return 1</span>
02360   <span class="comment">// if not, return -1</span>
02361   <span class="comment">// if error, return 0</span>
02362 
02363 
02364   <span class="comment">// make a lookup ptype to hold the type of each plane</span>
02365   <span class="comment">// 1 = v partial   2 = u partial</span>
02366   <span class="comment">// 3 = v full   4 = u full</span>
02367   <span class="comment">// 0 = uninstrumented</span>
02368   <span class="keyword">static</span> <span class="keywordtype">bool</span> first=<span class="keyword">true</span>;
02369   <span class="keyword">static</span> UShort_t ptype[282];
02370   <span class="keywordflow">if</span>(first){
02371     ptype[0]=0;
02372     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=1; i&lt;=281; i++){
02373       <span class="keywordflow">if</span>(i%2==0) ptype[i]=1; <span class="comment">// a v plane</span>
02374       <span class="keywordflow">else</span> ptype[i]=2; <span class="comment">// a u plane</span>
02375       <span class="keywordflow">if</span>((i-1)%5 == 0) ptype[i]+=2; <span class="comment">// fully instrumented</span>
02376       <span class="keywordflow">else</span> <span class="keywordflow">if</span>(i&gt;120) ptype[i]=0; <span class="comment">// not instrumented</span>
02377     }
02378     first=<span class="keyword">false</span>;
02379   }
02380   <span class="keywordflow">if</span>(plane&gt;281){
02381     <span class="comment">//    std::cerr&lt;&lt;"InPartialRegion passed plane = "&lt;&lt;plane&lt;&lt;std::endl;</span>
02382     <span class="keywordflow">return</span> 0;
02383   }
02384   UShort_t pt = ptype[plane];
02385   
02386   Int_t result;
02387   <span class="keywordflow">switch</span>(pt){
02388   <span class="keywordflow">case</span> 1:
02389   <span class="keywordflow">case</span> 3:
02390     <span class="keywordflow">if</span>(strip&lt;=4 || strip&gt;=67) result=1;
02391     <span class="keywordflow">else</span> result = -1;
02392     <span class="keywordflow">break</span>;
02393   <span class="keywordflow">case</span> 2:
02394     <span class="keywordflow">if</span>(strip==0 || strip == 63) result=1;
02395     <span class="keywordflow">else</span> result = -1;
02396     <span class="keywordflow">break</span>;
02397   <span class="keywordflow">case</span> 4:
02398     <span class="keywordflow">if</span>(strip&lt;=26 || strip&gt;=88) result=1;
02399     <span class="keywordflow">else</span> result = -1;
02400     <span class="keywordflow">break</span>;
02401   <span class="keywordflow">case</span> 0:
02402   <span class="keywordflow">default</span>:
02403     result=0;
02404     <span class="keywordflow">break</span>;
02405   }
02406   <span class="keywordflow">return</span> result;
02407 
02408 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="b15" doxytag="MadMKAnalysis::MuonShowerEnergy" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> float MadMKAnalysis::MuonShowerEnergy </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const <a class="el" href="classNtpSREvent.html">NtpSREvent</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>evt</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>const <a class="el" href="classNtpSRTrack.html">NtpSRTrack</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>trk</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8cxx-source.html#l02722">2722</a> of file <a class="el" href="MadMKAnalysis_8cxx-source.html">MadMKAnalysis.cxx</a>.
<p>
References <a class="el" href="NtpSRShowerPulseHeight_8h-source.html#l00037">NtpSRShowerPulseHeight::EMgev</a>, <a class="el" href="MadBase_8cxx-source.html#l00323">MadBase::LoadShower()</a>, <a class="el" href="NtpSREvent_8h-source.html#l00070">NtpSREvent::nshower</a>, <a class="el" href="NtpSRTrack_8h-source.html#l00070">NtpSRTrack::nstrip</a>, <a class="el" href="nrutil__val_8h-source.html#l00374">pow()</a>, <a class="el" href="NtpSREvent_8h-source.html#l00071">NtpSREvent::shw</a>, <a class="el" href="NtpSRShower_8h-source.html#l00096">NtpSRShower::shwph</a>, <a class="el" href="NtpSRTrack_8h-source.html#l00074">NtpSRTrack::stpu</a>, <a class="el" href="NtpSRTrack_8h-source.html#l00075">NtpSRTrack::stpv</a>, <a class="el" href="NtpSRTrack_8h-source.html#l00078">NtpSRTrack::stpz</a>, <a class="el" href="NtpSRVertex_8h-source.html#l00043">NtpSRVertex::t</a>, <a class="el" href="NtpSRVertex_8h-source.html#l00038">NtpSRVertex::u</a>, <a class="el" href="NtpSRVertex_8h-source.html#l00039">NtpSRVertex::v</a>, <a class="el" href="NtpSRTrack_8h-source.html#l00101">NtpSRTrack::vtx</a>, <a class="el" href="NtpSREvent_8h-source.html#l00086">NtpSREvent::vtx</a>, <a class="el" href="NtpSRShower_8h-source.html#l00098">NtpSRShower::vtx</a>, and <a class="el" href="NtpSRVertex_8h-source.html#l00042">NtpSRVertex::z</a>.
<p>
Referenced by <a class="el" href="MadMKAnalysis_8cxx-source.html#l00265">CreatePAN()</a>.
<p>
<div class="fragment"><pre>02722                                                                                 {  
02723   <span class="comment">// Purpose: try to sum up brems along the track</span>
02724 
02725   <span class="keyword">static</span> TH2* hr = <span class="keyword">new</span> TH2F(<span class="stringliteral">"h_mushw_rph"</span>,
02726                             <span class="stringliteral">"; track - shw r dist (m); shower energy (GeV)"</span>, 
02727                             10,0,0.2,40,0,2);
02728 
02729   <span class="keyword">static</span> TH2* hz = <span class="keyword">new</span> TH2F(<span class="stringliteral">"h_mushw_zph"</span>,
02730                             <span class="stringliteral">"; track - shw z dist (m); shower energy (GeV)"</span>, 
02731                             20,-0.2,0.2,40,0,2);
02732 
02733   <span class="keyword">static</span> TH2* ht = <span class="keyword">new</span> TH2F(<span class="stringliteral">"h_mushw_tph"</span>,
02734                             <span class="stringliteral">"; track - shw t dist (m); shower energy (GeV)"</span>, 
02735                             600,-1e-6,10e-6,40,0,2);
02736   
02737 
02738   <span class="keywordflow">if</span>(evt==0 || trk==0) <span class="keywordflow">return</span> 0;
02739   <span class="keywordtype">float</span> result=0;
02740   <a class="code" href="classNtpSRShower.html">NtpSRShower</a>* save_shwr = <a class="code" href="classMadBase.html#p15">ntpShower</a>;  
02741   <span class="comment">// loop through all showers in event</span>
02742   <span class="keyword">const</span> <span class="keywordtype">float</span> max_vtx_dist=14*0.06; <span class="comment">// 2 interaction lengths</span>
02743   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;evt-&gt;<a class="code" href="classNtpSREvent.html#o12">nshower</a>; i++){
02744     <a class="code" href="classMadBase.html#b1">LoadShower</a>(evt-&gt;<a class="code" href="classNtpSREvent.html#o13">shw</a>[i]);
02745     <span class="keywordflow">if</span>(!ntpShower) <span class="keywordflow">continue</span>;
02746     <span class="comment">// calculate distance to vertex</span>
02747     <span class="comment">// don't want to use showers near the vertex</span>
02748     <span class="keywordtype">float</span> dist_vtx = <a class="code" href="nrutil__val_8h.html#a22">pow</a>(ntpShower-&gt;<a class="code" href="classNtpSRShower.html#o31">vtx</a>.<a class="code" href="classNtpSRVertex.html#o5">z</a> - <a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o21">vtx</a>.<a class="code" href="classNtpSRVertex.html#o5">z</a>,2)
02749       + <a class="code" href="nrutil__val_8h.html#a22">pow</a>(ntpShower-&gt;<a class="code" href="classNtpSRShower.html#o31">vtx</a>.<a class="code" href="classNtpSRVertex.html#o1">u</a> - <a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o21">vtx</a>.<a class="code" href="classNtpSRVertex.html#o1">u</a>,2)
02750       + <a class="code" href="nrutil__val_8h.html#a22">pow</a>(ntpShower-&gt;<a class="code" href="classNtpSRShower.html#o31">vtx</a>.<a class="code" href="classNtpSRVertex.html#o2">v</a> - <a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o21">vtx</a>.<a class="code" href="classNtpSRVertex.html#o2">v</a>,2);
02751     dist_vtx=sqrt(dist_vtx);
02752     <span class="keywordflow">if</span>(dist_vtx&lt;max_vtx_dist) <span class="keywordflow">continue</span>;
02753     <span class="comment">// loop through track's strip array</span>
02754     <span class="comment">// calculate distance from strip to shower in time and space</span>
02755     <span class="comment">// save spatial and time distance of closest approach to track</span>
02756     <span class="comment">// if shower is close enough add the shower energy to running sum.</span>
02757     <span class="keywordtype">float</span> min_dist=1e6; <span class="keywordtype">float</span> min_r=1e6; <span class="keywordtype">float</span> min_z=1e6; <span class="keywordtype">float</span> <a class="code" href="structmin__t.html">min_t</a>=1e6;
02758     <span class="keywordtype">float</span> min_ph=0; <span class="keywordtype">float</span> add_ph=0;
02759     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;trk-&gt;<a class="code" href="classNtpSRTrack.html#o4">nstrip</a>; j++){
02760       <span class="keywordtype">float</span> dist_trk= <a class="code" href="nrutil__val_8h.html#a22">pow</a>(trk-&gt;<a class="code" href="classNtpSRTrack.html#o11">stpz</a>[j]-ntpShower-&gt;<a class="code" href="classNtpSRShower.html#o31">vtx</a>.<a class="code" href="classNtpSRVertex.html#o5">z</a>,2)
02761         + <a class="code" href="nrutil__val_8h.html#a22">pow</a>(trk-&gt;<a class="code" href="classNtpSRTrack.html#o7">stpu</a>[j]-ntpShower-&gt;<a class="code" href="classNtpSRShower.html#o31">vtx</a>.<a class="code" href="classNtpSRVertex.html#o1">u</a>,2)
02762         + <a class="code" href="nrutil__val_8h.html#a22">pow</a>(trk-&gt;<a class="code" href="classNtpSRTrack.html#o8">stpv</a>[j]-ntpShower-&gt;<a class="code" href="classNtpSRShower.html#o31">vtx</a>.<a class="code" href="classNtpSRVertex.html#o2">v</a>,2);
02763       dist_trk=sqrt(dist_trk);
02764       <span class="keywordtype">float</span> tdist = (trk-&gt;<a class="code" href="classNtpSRTrack.html#o34">vtx</a>.<a class="code" href="classNtpSRVertex.html#o6">t</a> + (trk-&gt;<a class="code" href="classNtpSRTrack.html#o11">stpz</a>[j]-trk-&gt;<a class="code" href="classNtpSRTrack.html#o34">vtx</a>.<a class="code" href="classNtpSRVertex.html#o5">z</a>)/3e8) 
02765                          - ntpShower-&gt;<a class="code" href="classNtpSRShower.html#o31">vtx</a>.<a class="code" href="classNtpSRVertex.html#o6">t</a>;
02766       
02767         <span class="comment">// = trk-&gt;stpt0[j]*trk-&gt;stpph0[j]+trk-&gt;stp1[j]*trk-&gt;stpph1[j];</span>
02768         <span class="comment">//      if( (trk-&gt;stpph0[j]+trk-&gt;stpph1[j]) &gt; 0){</span>
02769         <span class="comment">//      tdist/=(trk-&gt;stpph0[j]+trk-&gt;stpph1[j]);</span>
02770         <span class="comment">//      }</span>
02771       
02772       <span class="keywordflow">if</span>(fabs(dist_trk)&lt;fabs(min_dist)) {
02773         min_ph=ntpShower-&gt;<a class="code" href="classNtpSRShower.html#o29">shwph</a>.<a class="code" href="classNtpSRShowerPulseHeight.html#o4">EMgev</a>;
02774         min_z = fabs(ntpShower-&gt;<a class="code" href="classNtpSRShower.html#o31">vtx</a>.<a class="code" href="classNtpSRVertex.html#o5">z</a>-trk-&gt;<a class="code" href="classNtpSRTrack.html#o11">stpz</a>[j]);
02775         min_r = sqrt( <a class="code" href="nrutil__val_8h.html#a22">pow</a>(ntpShower-&gt;<a class="code" href="classNtpSRShower.html#o31">vtx</a>.<a class="code" href="classNtpSRVertex.html#o1">u</a>-trk-&gt;<a class="code" href="classNtpSRTrack.html#o7">stpu</a>[j],2)
02776                       + <a class="code" href="nrutil__mtl_8h.html#a20">pow</a>(ntpShower-&gt;<a class="code" href="classNtpSRShower.html#o31">vtx</a>.<a class="code" href="classNtpSRVertex.html#o2">v</a>-trk-&gt;<a class="code" href="classNtpSRTrack.html#o8">stpv</a>[j],2));
02777         min_t = tdist;
02778       }
02779 
02780       <span class="keyword">const</span> <span class="keywordtype">float</span> max_trk_dist=1.76*3.0; <span class="comment">// 3 radiation lengths</span>
02781       <span class="keyword">const</span> <span class="keywordtype">float</span> max_trk_tdist=40e-9;
02782       <span class="keywordflow">if</span>(fabs(dist_trk)&lt;max_trk_dist &amp;&amp; fabs(tdist)&lt;max_trk_tdist){
02783         <span class="comment">// shower correllated with track</span>
02784         add_ph=min_ph;
02785       }
02786     }
02787     result+=min_ph; <span class="comment">// </span>
02788     
02789     <span class="comment">// fill histograms</span>
02790     hr-&gt;Fill(min_r,min_ph);
02791     hz-&gt;Fill(min_z,min_ph);
02792     ht-&gt;Fill(min_t,min_ph);
02793 
02794   }<span class="comment">// end loop over showers</span>
02795 
02796   <span class="comment">// reset shower pointer</span>
02797   ntpShower=save_shwr;
02798   <span class="comment">// all done</span>
02799   <span class="keywordflow">return</span> result;
02800 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="e3" doxytag="MadMKAnalysis::NDRadialFidVol" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> Int_t MadMKAnalysis::NDRadialFidVol </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Float_t&nbsp;</td>
          <td class="mdname" nowrap> <em>x</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>Float_t&nbsp;</td>
          <td class="mdname" nowrap> <em>y</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>Float_t&nbsp;</td>
          <td class="mdname" nowrap> <em>z</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8cxx-source.html#l02266">2266</a> of file <a class="el" href="MadMKAnalysis_8cxx-source.html">MadMKAnalysis.cxx</a>.
<p>
References <a class="el" href="MadMKAnalysis_8cxx-source.html#l00180">kTargEndZ</a>, <a class="el" href="MadMKAnalysis_8cxx-source.html#l00179">kVetoEndZ</a>, <a class="el" href="MadMKAnalysis_8cxx-source.html#l00184">kXcenter</a>, <a class="el" href="MadMKAnalysis_8cxx-source.html#l00185">kYcenter</a>, and <a class="el" href="nrutil__val_8h-source.html#l00374">pow()</a>.
<p>
Referenced by <a class="el" href="MadMKAnalysis_8cxx-source.html#l00265">CreatePAN()</a>, and <a class="el" href="MadMKAnalysis_8cxx-source.html#l02933">FillMCHists()</a>.
<p>
<div class="fragment"><pre>02266                                                                  {
02267 
02268   Float_t rings[5]={0.1,0.25,0.5,1.0,1.5}; <span class="comment">// in meters</span>
02269   Int_t result=0;
02270   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;5; i++){
02271     Float_t radius = <a class="code" href="nrutil__val_8h.html#a22">pow</a>(x-kXcenter,2) 
02272       + <a class="code" href="nrutil__val_8h.html#a22">pow</a>(y-(kYcenter - z*TMath::Tan(0.058)),2);
02273     radius=sqrt(radius);
02274     <span class="comment">// restrict vertices to target region and 1m radius</span>
02275     <span class="keywordflow">if</span>(z&gt;=<a class="code" href="classMadMKAnalysis.html#v0">kVetoEndZ</a> &amp;&amp; 
02276        z&lt;=<a class="code" href="classMadMKAnalysis.html#v1">kTargEndZ</a> &amp;&amp;
02277        radius&lt;=rings[i]) result|=(1&lt;&lt;i);
02278   }
02279   <span class="keywordflow">return</span> result;
02280 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="b11" doxytag="MadMKAnalysis::NPlanesInObj" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> Int_t MadMKAnalysis::NPlanesInObj </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">TObject *&nbsp;</td>
          <td class="mdname" nowrap> <em>rec</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>TObject *&nbsp;</td>
          <td class="mdname" nowrap> <em>obj</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>float&nbsp;</td>
          <td class="mdname" nowrap> <em>phcut</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>float &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>sumph</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8cxx-source.html#l02468">2468</a> of file <a class="el" href="MadMKAnalysis_8cxx-source.html">MadMKAnalysis.cxx</a>.
<p>
References <a class="el" href="NtpStRecord_8h-source.html#l00094">NtpStRecord::evthdr</a>, <a class="el" href="NtpSRRecord_8h-source.html#l00054">NtpSRRecord::evthdr</a>, <a class="el" href="NtpSREventSummary_8h-source.html#l00040">NtpSREventSummary::nstrip</a>, <a class="el" href="NtpSRShower_8h-source.html#l00071">NtpSRShower::nstrip</a>, <a class="el" href="NtpSREvent_8h-source.html#l00062">NtpSREvent::nstrip</a>, <a class="el" href="NtpSRTrack_8h-source.html#l00070">NtpSRTrack::nstrip</a>, <a class="el" href="NtpSRSlice_8h-source.html#l00048">NtpSRSlice::nstrip</a>, <a class="el" href="NtpSRPulseHeight_8h-source.html#l00038">NtpSRPulseHeight::pe</a>, <a class="el" href="NtpSRStrip_8h-source.html#l00059">NtpSRStrip::ph0</a>, <a class="el" href="NtpSRStrip_8h-source.html#l00060">NtpSRStrip::ph1</a>, <a class="el" href="NtpSRStrip_8h-source.html#l00052">NtpSRStrip::plane</a>, <a class="el" href="NtpSRPulseHeight_8h-source.html#l00037">NtpSRPulseHeight::sigcor</a>, <a class="el" href="NtpStRecord_8h-source.html#l00110">NtpStRecord::stp</a>, <a class="el" href="NtpSRRecord_8h-source.html#l00065">NtpSRRecord::stp</a>, <a class="el" href="NtpSRShower_8h-source.html#l00072">NtpSRShower::stp</a>, <a class="el" href="NtpSREvent_8h-source.html#l00063">NtpSREvent::stp</a>, <a class="el" href="NtpSRTrack_8h-source.html#l00071">NtpSRTrack::stp</a>, and <a class="el" href="NtpSRSlice_8h-source.html#l00049">NtpSRSlice::stp</a>.
<p>
Referenced by <a class="el" href="MadMKAnalysis_8cxx-source.html#l00265">CreatePAN()</a>.
<p>
<div class="fragment"><pre>02469 {
02470   sumph=0.0;
02471 
02472   std::set&lt;UShort_t&gt; planes;
02473 
02474   <a class="code" href="classNtpSRRecord.html">NtpSRRecord</a> *srrec = dynamic_cast&lt;NtpSRRecord *&gt;(rec);
02475   <a class="code" href="classNtpStRecord.html">NtpStRecord</a> *strec = dynamic_cast&lt;NtpStRecord *&gt;(rec);
02476 
02477   Int_t *stripindex=0;
02478   Int_t nstrip=0;
02479   <a class="code" href="classNtpSRSlice.html">NtpSRSlice</a> *slc = dynamic_cast&lt;NtpSRSlice *&gt;(obj);
02480   <a class="code" href="classNtpSRTrack.html">NtpSRTrack</a> *trk = dynamic_cast&lt;NtpSRTrack *&gt;(obj);
02481   <a class="code" href="classNtpSREvent.html">NtpSREvent</a> *evt = dynamic_cast&lt;NtpSREvent *&gt;(obj);
02482   <a class="code" href="classNtpSRShower.html">NtpSRShower</a> *shw = dynamic_cast&lt;NtpSRShower *&gt;(obj);
02483 
02484   <span class="keywordflow">if</span>(slc!=0){
02485     stripindex=slc-&gt;<a class="code" href="classNtpSRSlice.html#o4">stp</a>;
02486     nstrip=slc-&gt;<a class="code" href="classNtpSRSlice.html#o3">nstrip</a>;
02487     <span class="comment">//    cout&lt;&lt;"Counting planes in slice"&lt;&lt;endl;</span>
02488   }
02489   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(trk!=0){
02490     stripindex=trk-&gt;<a class="code" href="classNtpSRTrack.html#o5">stp</a>;
02491     nstrip=trk-&gt;<a class="code" href="classNtpSRTrack.html#o4">nstrip</a>;
02492     <span class="comment">//    cout&lt;&lt;"Counting planes in trk"&lt;&lt;endl;</span>
02493   }
02494   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(evt!=0){
02495     stripindex=evt-&gt;<a class="code" href="classNtpSREvent.html#o5">stp</a>;
02496     nstrip=evt-&gt;<a class="code" href="classNtpSREvent.html#o4">nstrip</a>;
02497     <span class="comment">//    cout&lt;&lt;"Counting planes in event"&lt;&lt;endl;</span>
02498   }
02499   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(shw!=0){
02500     stripindex=shw-&gt;<a class="code" href="classNtpSRShower.html#o5">stp</a>;
02501     nstrip=shw-&gt;<a class="code" href="classNtpSRShower.html#o4">nstrip</a>;
02502     <span class="comment">//    cout&lt;&lt;"Counting planes in event"&lt;&lt;endl;</span>
02503   }
02504   
02505   TClonesArray *striplist=0; 
02506   <span class="keywordtype">int</span> TOTSTRIPS=0;
02507   <span class="keywordflow">if</span>(srrec!=0){
02508     striplist = srrec-&gt;<a class="code" href="classNtpSRRecord.html#o10">stp</a>;
02509     TOTSTRIPS=srrec-&gt;<a class="code" href="classNtpSRRecord.html#o0">evthdr</a>.<a class="code" href="classNtpSREventSummary.html#o1">nstrip</a>;
02510     <span class="comment">//    cout&lt;&lt;"Found a sr"&lt;&lt;endl;</span>
02511   }
02512   <span class="keywordflow">else</span>{
02513     striplist = strec-&gt;<a class="code" href="classNtpStRecord.html#o13">stp</a>;
02514     TOTSTRIPS=strec-&gt;<a class="code" href="classNtpStRecord.html#o0">evthdr</a>.<a class="code" href="classNtpSREventSummary.html#o1">nstrip</a>;
02515     <span class="comment">//    cout&lt;&lt;"found a st"&lt;&lt;endl;</span>
02516   }
02517   
02518   <span class="keywordflow">if</span>(striplist!=0){
02519     <span class="comment">//    cout&lt;&lt;"Looping over strip list, nstrip="&lt;&lt;nstrip&lt;&lt;endl;</span>
02520     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;nstrip;i++){
02521       <span class="keywordtype">int</span> sindex = stripindex[i];
02522       <span class="keywordflow">if</span>(sindex&lt;0) <span class="keywordflow">continue</span>;
02523       <span class="keywordflow">if</span>(sindex&lt;TOTSTRIPS){       
02524         <a class="code" href="classNtpSRStrip.html">NtpSRStrip</a> *strip = dynamic_cast&lt;NtpSRStrip *&gt;
02525           ((*striplist)[sindex]);
02526         <span class="keywordflow">if</span>(!strip) <span class="keywordflow">continue</span>;
02527         <span class="comment">//      cout&lt;&lt;"got strip "&lt;&lt;sindex&lt;&lt;" plane "&lt;&lt;strip-&gt;plane</span>
02528         <span class="comment">//          &lt;&lt;" strip "&lt;&lt;strip-&gt;strip</span>
02529         <span class="comment">//          &lt;&lt;" ph "&lt;&lt;strip-&gt;ph0.pe+strip-&gt;ph1.pe&lt;&lt;endl;</span>
02530         <span class="keywordflow">if</span>(strip-&gt;<a class="code" href="classNtpSRStrip.html#o12">ph0</a>.<a class="code" href="classNtpSRPulseHeight.html#o3">pe</a>+strip-&gt;<a class="code" href="classNtpSRStrip.html#o13">ph1</a>.<a class="code" href="classNtpSRPulseHeight.html#o3">pe</a>&gt;phcut){
02531           planes.insert(strip-&gt;<a class="code" href="classNtpSRStrip.html#o5">plane</a>);
02532           sumph+=strip-&gt;<a class="code" href="classNtpSRStrip.html#o12">ph0</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>+strip-&gt;<a class="code" href="classNtpSRStrip.html#o13">ph1</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>;
02533         }     
02534       }
02535     }
02536   }
02537   <span class="keywordflow">else</span>{
02538     <span class="comment">//    cout&lt;&lt;"Getting number of planes in snarl"&lt;&lt;endl;</span>
02539     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;TOTSTRIPS;i++){
02540       <a class="code" href="classNtpSRStrip.html">NtpSRStrip</a> *strip = dynamic_cast&lt;NtpSRStrip *&gt;((*striplist)[i]);
02541       <span class="keywordflow">if</span>(!strip) <span class="keywordflow">continue</span>;
02542       <span class="comment">//      cout&lt;&lt;"got strip "&lt;&lt;i&lt;&lt;" plane "&lt;&lt;strip-&gt;plane</span>
02543       <span class="comment">//          &lt;&lt;" strip "&lt;&lt;strip-&gt;strip</span>
02544       <span class="comment">//          &lt;&lt;" ph "&lt;&lt;strip-&gt;ph0.pe+strip-&gt;ph1.pe&lt;&lt;endl;</span>
02545       <span class="keywordflow">if</span>(strip-&gt;<a class="code" href="classNtpSRStrip.html#o12">ph0</a>.<a class="code" href="classNtpSRPulseHeight.html#o3">pe</a>+strip-&gt;<a class="code" href="classNtpSRStrip.html#o13">ph1</a>.<a class="code" href="classNtpSRPulseHeight.html#o3">pe</a>&gt;phcut){
02546         planes.insert(strip-&gt;<a class="code" href="classNtpSRStrip.html#o5">plane</a>);
02547         sumph+=strip-&gt;<a class="code" href="classNtpSRStrip.html#o12">ph0</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>+strip-&gt;<a class="code" href="classNtpSRStrip.html#o13">ph1</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>;
02548       }     
02549     }
02550   }
02551     
02552   <span class="comment">//  cout&lt;&lt;"I count "&lt;&lt;planes.size()&lt;&lt;" planes &gt; "&lt;&lt;phcut&lt;&lt;" pe"&lt;&lt;endl;</span>
02553   <span class="keywordflow">return</span> planes.size();
02554 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="b12" doxytag="MadMKAnalysis::NStripsInObj" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> Int_t MadMKAnalysis::NStripsInObj </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">TObject *&nbsp;</td>
          <td class="mdname" nowrap> <em>rec</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>TObject *&nbsp;</td>
          <td class="mdname" nowrap> <em>obj</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>float&nbsp;</td>
          <td class="mdname" nowrap> <em>phcut</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>float &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>sumph</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8cxx-source.html#l02557">2557</a> of file <a class="el" href="MadMKAnalysis_8cxx-source.html">MadMKAnalysis.cxx</a>.
<p>
References <a class="el" href="NtpStRecord_8h-source.html#l00094">NtpStRecord::evthdr</a>, <a class="el" href="NtpSRRecord_8h-source.html#l00054">NtpSRRecord::evthdr</a>, <a class="el" href="NtpSREventSummary_8h-source.html#l00040">NtpSREventSummary::nstrip</a>, <a class="el" href="NtpSRShower_8h-source.html#l00071">NtpSRShower::nstrip</a>, <a class="el" href="NtpSREvent_8h-source.html#l00062">NtpSREvent::nstrip</a>, <a class="el" href="NtpSRTrack_8h-source.html#l00070">NtpSRTrack::nstrip</a>, <a class="el" href="NtpSRSlice_8h-source.html#l00048">NtpSRSlice::nstrip</a>, <a class="el" href="NtpSRPulseHeight_8h-source.html#l00038">NtpSRPulseHeight::pe</a>, <a class="el" href="NtpSRStrip_8h-source.html#l00059">NtpSRStrip::ph0</a>, <a class="el" href="NtpSRStrip_8h-source.html#l00060">NtpSRStrip::ph1</a>, <a class="el" href="NtpSRStrip_8h-source.html#l00052">NtpSRStrip::plane</a>, <a class="el" href="NtpSRPulseHeight_8h-source.html#l00037">NtpSRPulseHeight::sigcor</a>, <a class="el" href="NtpStRecord_8h-source.html#l00110">NtpStRecord::stp</a>, <a class="el" href="NtpSRRecord_8h-source.html#l00065">NtpSRRecord::stp</a>, <a class="el" href="NtpSRShower_8h-source.html#l00072">NtpSRShower::stp</a>, <a class="el" href="NtpSREvent_8h-source.html#l00063">NtpSREvent::stp</a>, <a class="el" href="NtpSRTrack_8h-source.html#l00071">NtpSRTrack::stp</a>, and <a class="el" href="NtpSRSlice_8h-source.html#l00049">NtpSRSlice::stp</a>.
<p>
Referenced by <a class="el" href="MadMKAnalysis_8cxx-source.html#l00265">CreatePAN()</a>.
<p>
<div class="fragment"><pre>02558 {
02559   sumph=0.0;
02560   std::vector&lt;UShort_t&gt; strips;
02561 
02562   <a class="code" href="classNtpSRRecord.html">NtpSRRecord</a> *srrec = dynamic_cast&lt;NtpSRRecord *&gt;(rec);
02563   <a class="code" href="classNtpStRecord.html">NtpStRecord</a> *strec = dynamic_cast&lt;NtpStRecord *&gt;(rec);
02564 
02565   Int_t *stripindex=0;
02566   Int_t nstrip=0;
02567   <a class="code" href="classNtpSRSlice.html">NtpSRSlice</a> *slc = dynamic_cast&lt;NtpSRSlice *&gt;(obj);
02568   <a class="code" href="classNtpSRTrack.html">NtpSRTrack</a> *trk = dynamic_cast&lt;NtpSRTrack *&gt;(obj);
02569   <a class="code" href="classNtpSREvent.html">NtpSREvent</a> *evt = dynamic_cast&lt;NtpSREvent *&gt;(obj);
02570   <a class="code" href="classNtpSRShower.html">NtpSRShower</a> *shw = dynamic_cast&lt;NtpSRShower *&gt;(obj);
02571 
02572   <span class="keywordflow">if</span>(slc!=0){
02573     stripindex=slc-&gt;<a class="code" href="classNtpSRSlice.html#o4">stp</a>;
02574     nstrip=slc-&gt;<a class="code" href="classNtpSRSlice.html#o3">nstrip</a>;
02575   }
02576   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(trk!=0){
02577     stripindex=trk-&gt;<a class="code" href="classNtpSRTrack.html#o5">stp</a>;
02578     nstrip=trk-&gt;<a class="code" href="classNtpSRTrack.html#o4">nstrip</a>;
02579   }
02580   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(evt!=0){
02581     stripindex=evt-&gt;<a class="code" href="classNtpSREvent.html#o5">stp</a>;
02582     nstrip=evt-&gt;<a class="code" href="classNtpSREvent.html#o4">nstrip</a>;
02583   }
02584   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(shw!=0){
02585     stripindex=shw-&gt;<a class="code" href="classNtpSRShower.html#o5">stp</a>;
02586     nstrip=shw-&gt;<a class="code" href="classNtpSRShower.html#o4">nstrip</a>;
02587   }
02588   
02589   TClonesArray *striplist=0; 
02590   <span class="keywordtype">int</span> TOTSTRIPS;
02591   <span class="keywordflow">if</span>(srrec!=0){
02592     striplist = srrec-&gt;<a class="code" href="classNtpSRRecord.html#o10">stp</a>;
02593     TOTSTRIPS=srrec-&gt;<a class="code" href="classNtpSRRecord.html#o0">evthdr</a>.<a class="code" href="classNtpSREventSummary.html#o1">nstrip</a>;
02594   }
02595   <span class="keywordflow">else</span>{
02596     striplist = strec-&gt;<a class="code" href="classNtpStRecord.html#o13">stp</a>;
02597     TOTSTRIPS=strec-&gt;<a class="code" href="classNtpStRecord.html#o0">evthdr</a>.<a class="code" href="classNtpSREventSummary.html#o1">nstrip</a>;
02598   }
02599   
02600   <span class="comment">//  cout&lt;&lt;"CHECKING nstrips="&lt;&lt;nstrip&lt;&lt;endl;</span>
02601   <span class="keywordflow">if</span>(striplist!=0){
02602     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;nstrip;i++){
02603       <span class="keywordtype">int</span> sindex=stripindex[i];
02604       <span class="keywordflow">if</span>(sindex&lt;0) <span class="keywordflow">continue</span>;
02605       <a class="code" href="classNtpSRStrip.html">NtpSRStrip</a> *strip = dynamic_cast&lt;NtpSRStrip *&gt;((*striplist)[sindex]);
02606       <span class="keywordflow">if</span>(!strip) <span class="keywordflow">continue</span>;
02607       <span class="keywordflow">if</span>(strip-&gt;<a class="code" href="classNtpSRStrip.html#o12">ph0</a>.<a class="code" href="classNtpSRPulseHeight.html#o3">pe</a>+strip-&gt;<a class="code" href="classNtpSRStrip.html#o13">ph1</a>.<a class="code" href="classNtpSRPulseHeight.html#o3">pe</a>&gt;phcut){
02608         strips.push_back(strip-&gt;<a class="code" href="classNtpSRStrip.html#o5">plane</a>);
02609         sumph+=strip-&gt;<a class="code" href="classNtpSRStrip.html#o12">ph0</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>+strip-&gt;<a class="code" href="classNtpSRStrip.html#o13">ph1</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>;
02610       }     
02611     }
02612   }
02613   <span class="keywordflow">else</span>{
02614     <span class="keywordflow">if</span>(srrec!=0){
02615       nstrip=srrec-&gt;<a class="code" href="classNtpSRRecord.html#o0">evthdr</a>.<a class="code" href="classNtpSREventSummary.html#o1">nstrip</a>;
02616     }
02617     <span class="keywordflow">else</span>{
02618       nstrip=strec-&gt;<a class="code" href="classNtpStRecord.html#o0">evthdr</a>.<a class="code" href="classNtpSREventSummary.html#o1">nstrip</a>;
02619     }
02620     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;nstrip;i++){
02621 
02622       <a class="code" href="classNtpSRStrip.html">NtpSRStrip</a> *strip = dynamic_cast&lt;NtpSRStrip *&gt;((*striplist)[i]);
02623       <span class="comment">//      cout&lt;&lt;"Checking "&lt;&lt;i&lt;&lt;" stripph: "&lt;&lt;strip-&gt;ph0.pe&lt;&lt;" "&lt;&lt;strip-&gt;ph1.pe&lt;&lt;endl;</span>
02624       <span class="keywordflow">if</span>(!strip) <span class="keywordflow">continue</span>;
02625       <span class="keywordflow">if</span>(strip-&gt;<a class="code" href="classNtpSRStrip.html#o12">ph0</a>.<a class="code" href="classNtpSRPulseHeight.html#o3">pe</a>+strip-&gt;<a class="code" href="classNtpSRStrip.html#o13">ph1</a>.<a class="code" href="classNtpSRPulseHeight.html#o3">pe</a>&gt;phcut){
02626         strips.push_back(strip-&gt;<a class="code" href="classNtpSRStrip.html#o5">plane</a>);
02627         sumph+=strip-&gt;<a class="code" href="classNtpSRStrip.html#o12">ph0</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>+strip-&gt;<a class="code" href="classNtpSRStrip.html#o13">ph1</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>;
02628       }     
02629     }
02630   }
02631     
02632   <span class="comment">//  cout&lt;&lt;"returning "&lt;&lt;strips.size()&lt;&lt;endl;</span>
02633   <span class="keywordflow">return</span> strips.size();
02634 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="MadMKAnalysis::OnlyWriteFidEvents" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void MadMKAnalysis::OnlyWriteFidEvents </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">bool&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>x</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8h-source.html#l00136">136</a> of file <a class="el" href="MadMKAnalysis_8h-source.html">MadMKAnalysis.h</a>.
<p>
References <a class="el" href="MadMKAnalysis_8h-source.html#l00230">fOnlyWriteFidEvents</a>.
<p>
<div class="fragment"><pre>00136 {<a class="code" href="classMadMKAnalysis.html#r4">fOnlyWriteFidEvents</a>=x;}
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="e0" doxytag="MadMKAnalysis::PittInFidVol" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> Bool_t MadMKAnalysis::PittInFidVol </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Float_t&nbsp;</td>
          <td class="mdname" nowrap> <em>x</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>Float_t&nbsp;</td>
          <td class="mdname" nowrap> <em>y</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>Float_t&nbsp;</td>
          <td class="mdname" nowrap> <em>z</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>Float_t&nbsp;</td>
          <td class="mdname" nowrap> <em>u</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>Float_t&nbsp;</td>
          <td class="mdname" nowrap> <em>v</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8cxx-source.html#l02282">2282</a> of file <a class="el" href="MadMKAnalysis_8cxx-source.html">MadMKAnalysis.cxx</a>.
<p>
Referenced by <a class="el" href="MadMKAnalysis_8cxx-source.html#l00265">CreatePAN()</a>, and <a class="el" href="MadMKAnalysis_8cxx-source.html#l02933">FillMCHists()</a>.
<p>
<div class="fragment"><pre>02282                                                                                        {
02283 
02284   
02285   <span class="comment">// Is the event vertex, (x,y,u,v,z) inside the fiducial volume</span>
02286   <span class="comment">// used by the pittsburgh group?</span>
02287 
02288   <span class="keywordflow">if</span>( !( z&gt;0.6 &amp;&amp; z&lt;3.56) ) <span class="keywordflow">return</span> kFALSE;
02289   <span class="keywordflow">if</span>( !( u&gt;0.3 &amp;&amp; u&lt;1.8) ) <span class="keywordflow">return</span> kFALSE;
02290   <span class="keywordflow">if</span>( !( v&gt;-1.8 &amp;&amp; v&lt; -0.3) ) <span class="keywordflow">return</span> kFALSE;
02291   <span class="keywordflow">if</span>( x&gt;=2.4) <span class="keywordflow">return</span> kFALSE;
02292   <span class="keyword">const</span> Float_t coil_cut=0.8*0.8;
02293   <span class="keywordflow">if</span>( (x*x + y*y) &lt;= coil_cut) <span class="keywordflow">return</span> kFALSE;
02294   <span class="keywordflow">return</span> kTRUE;
02295 
02296 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="e1" doxytag="MadMKAnalysis::PittTrkContained" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> Int_t MadMKAnalysis::PittTrkContained </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Float_t&nbsp;</td>
          <td class="mdname" nowrap> <em>x</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>Float_t&nbsp;</td>
          <td class="mdname" nowrap> <em>y</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>Float_t&nbsp;</td>
          <td class="mdname" nowrap> <em>z</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>Float_t&nbsp;</td>
          <td class="mdname" nowrap> <em>u</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>Float_t&nbsp;</td>
          <td class="mdname" nowrap> <em>v</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8cxx-source.html#l02298">2298</a> of file <a class="el" href="MadMKAnalysis_8cxx-source.html">MadMKAnalysis.cxx</a>.
<p>
Referenced by <a class="el" href="MadMKAnalysis_8cxx-source.html#l00265">CreatePAN()</a>, <a class="el" href="MadScanDisplay_8cxx-source.html#l03257">MadScanDisplay::DrawTextBox()</a>, and <a class="el" href="MadEvDisplay_8cxx-source.html#l02634">MadEvDisplay::DrawTextBox()</a>.
<p>
<div class="fragment"><pre>02299                                                            {
02300   <span class="comment">// what is the containment status of this track </span>
02301   <span class="comment">// as defined by the pitt group</span>
02302   <span class="comment">//</span>
02303  <span class="comment">// takes the track end point (x,y,u,v,z)</span>
02304   <span class="comment">// returns:</span>
02305   <span class="comment">// 1 = track is fully contained in the upstream region</span>
02306   <span class="comment">// 2 = track is partially contained in the upstream region</span>
02307   <span class="comment">// 3 = track is fully contained in the downstream region</span>
02308   <span class="comment">// 4 = track is partially contained in the downstream region</span>
02309   <span class="comment">// </span>
02310   <span class="comment">// the rationale is that these categories have different momentum resolution</span>
02311   <span class="comment">//</span>
02312 
02313   <span class="keyword">const</span> Float_t radsq = x*x + y*y;
02314   <span class="keywordtype">int</span> result=0;
02315   <span class="keywordflow">if</span>(z&lt;7.0) {
02316     <span class="comment">// track in upstream region</span>
02317     <span class="keyword">static</span> <span class="keyword">const</span> Float_t coil_cut=0.8*0.8;
02318     <span class="comment">// was asking for u&gt;3 &amp;&amp; u&lt;1.8 here before -- a bug</span>
02319     <span class="keywordflow">if</span>( (u&gt;0.3 &amp;&amp; u&lt;1.8) &amp;&amp; (v&gt;-1.8 &amp;&amp; v&lt;-0.3) &amp;&amp; (x&lt;2.4) &amp;&amp; (radsq&gt;coil_cut) )
02320       result=1;
02321     <span class="keywordflow">else</span> result=2;
02322   }
02323   <span class="keywordflow">else</span>{
02324     <span class="comment">// downstream region</span>
02325     <span class="comment">// uses an ellipse in x,y</span>
02326     <span class="comment">// major axis (x) = a = 1.7 m</span>
02327     <span class="comment">// minor axis (y) = b = 1.4 m</span>
02328     <span class="comment">// centered on x,y = (0.8,0)</span>
02329     <span class="comment">// (x-x0)^2/a^2 + (y-y0)^2/b^2 = 1</span>
02330     <span class="comment">// should change this to 0.8</span>
02331     <span class="comment">//    static const Float_t coil_cut=0.5*0.5; // note differs from above</span>
02332 
02333     <span class="comment">//changed from 0.5 to 0.8 by TV on 7-29-05</span>
02334     <span class="keyword">static</span> <span class="keyword">const</span> Float_t coil_cut=0.8*0.8;
02335     <span class="keyword">static</span> <span class="keyword">const</span> Float_t x0=0.8;
02336     <span class="keyword">static</span> <span class="keyword">const</span> Float_t y0=0.0;
02337     <span class="keyword">static</span> <span class="keyword">const</span> Float_t a=1.7;
02338     <span class="keyword">static</span> <span class="keyword">const</span> Float_t b=1.4;
02339     <span class="keyword">const</span> Float_t xsc = (x-x0)/a; <span class="comment">// rescale ellipse to unit circle</span>
02340     <span class="keyword">const</span> Float_t ysc = (y-y0)/b;
02341     <span class="comment">//MAK: cut on z was 16.0 till Aug 2, 2005</span>
02342     <span class="keywordflow">if</span>( (sqrt(xsc*xsc + ysc*ysc)&lt;1.0) &amp;&amp; (radsq&gt;coil_cut) &amp;&amp; (z&lt;15.6)) 
02343       result = 3;
02344     <span class="keywordflow">else</span> result = 4;
02345   }
02346   <span class="keywordflow">return</span> result;
02347   
02348 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="b3" doxytag="MadMKAnalysis::RecoMKMuEnergy" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> Float_t MadMKAnalysis::RecoMKMuEnergy </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Int_t &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>opt</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>Int_t&nbsp;</td>
          <td class="mdname" nowrap> <em>itrk</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>bool&nbsp;</td>
          <td class="mdname" nowrap> <em>isdata</em> = true, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="classDetector.html#w0">Detector::Detector_t</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>det</em> = Detector::kNear</td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8cxx-source.html#l02113">2113</a> of file <a class="el" href="MadMKAnalysis_8cxx-source.html">MadMKAnalysis.cxx</a>.
<p>
References <a class="el" href="EnergyCorrections_8cxx-source.html#l00690">EnergyCorrections::CorrectMomentumFromRange()</a>, <a class="el" href="EnergyCorrections_8cxx-source.html#l00709">EnergyCorrections::CorrectSignedMomentumFromCurvature()</a>, <a class="el" href="classDetector.html#w0">Detector::Detector_t</a>, <a class="el" href="NtpSRFiducial_8h-source.html#l00034">NtpSRFiducial::dr</a>, <a class="el" href="NtpSRFiducial_8h-source.html#l00036">NtpSRFiducial::dz</a>, <a class="el" href="NtpSRTrack_8h-source.html#l00106">NtpSRTrack::fidall</a>, <a class="el" href="MadBase_8cxx-source.html#l00227">MadBase::LoadTrack()</a>, <a class="el" href="NtpSRTrack_8h-source.html#l00109">NtpSRTrack::momentum</a>, <a class="el" href="NtpSRMomentum_8h-source.html#l00037">NtpSRMomentum::qp</a>, and <a class="el" href="NtpSRMomentum_8h-source.html#l00033">NtpSRMomentum::range</a>.
<p>
Referenced by <a class="el" href="MadMKAnalysis_8cxx-source.html#l00265">CreatePAN()</a>.
<p>
<div class="fragment"><pre>02113                                                                                                      {
02114   <span class="keyword">const</span> <span class="keywordtype">float</span> mumass=0.10566;
02115   <span class="keywordflow">if</span>(<a class="code" href="classMadBase.html#b0">LoadTrack</a>(itrk)){
02116      <span class="keywordtype">float</span> mr=<a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o41">momentum</a>.<a class="code" href="classNtpSRMomentum.html#o0">range</a>;
02117      mr=<a class="code" href="namespaceEnergyCorrections.html#a56">CorrectMomentumFromRange</a>(mr,isdata,det);
02118      <span class="keywordtype">float</span> mc=0.0; <span class="comment">// signed momentum from curvature</span>
02119      <span class="keywordflow">if</span>(<a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o41">momentum</a>.<a class="code" href="classNtpSRMomentum.html#o1">qp</a>!=0) mc = 1.0/(<a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o41">momentum</a>.<a class="code" href="classNtpSRMomentum.html#o1">qp</a>);
02120      mc=<a class="code" href="namespaceEnergyCorrections.html#a58">CorrectSignedMomentumFromCurvature</a>(mc,isdata,det);
02121 
02122     <span class="keywordflow">if</span>(opt==0){  
02123       <span class="comment">//return the most appropriate measure of momentum</span>
02124       <span class="comment">// assign opt based on our choice</span>
02125       <span class="keywordflow">if</span>(<a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o39">fidall</a>.<a class="code" href="classNtpSRFiducial.html#o0">dr</a>&gt;0.5&amp;&amp;<a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o39">fidall</a>.<a class="code" href="classNtpSRFiducial.html#o1">dz</a>&gt;0.5) {
02126         opt=2;
02127         <span class="keywordflow">return</span> sqrt(mr*mr+ mumass*mumass);
02128       }
02129       <span class="keywordflow">else</span> {
02130         opt=1;
02131         <span class="comment">// in R1.9 the tracker will apparently return (q/p)=0.0</span>
02132         <span class="comment">// maybe it's when a track looks perfectly rigid?</span>
02133         <span class="comment">// if so, we have to do something</span>
02134         <span class="comment">// I don't want to use the range, that could be very wrong</span>
02135         <span class="comment">// but wrong in a more subtle way ...</span>
02136         <span class="comment">// so, we'll return an obviously ridiculous value of 10 TeV</span>
02137         <span class="keywordflow">if</span>(<a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o41">momentum</a>.<a class="code" href="classNtpSRMomentum.html#o1">qp</a> == 0.0) <span class="keywordflow">return</span> 10000.0; 
02138         <span class="keywordflow">else</span> <span class="keywordflow">return</span> sqrt(mc*mc+mumass*mumass);
02139       }
02140     }
02141     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(opt==1) { <span class="comment">//return curvature measurement</span>
02142         <span class="keywordflow">if</span>(<a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o41">momentum</a>.<a class="code" href="classNtpSRMomentum.html#o1">qp</a> == 0.0) <span class="keywordflow">return</span> 10000.0; 
02143         <span class="keywordflow">else</span> <span class="keywordflow">return</span> sqrt(mc*mc+mumass*mumass);
02144     }
02145     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(opt==2) <span class="comment">//return range measurement</span>
02146       <span class="keywordflow">return</span> sqrt(mr*mr + mumass*mumass);
02147     <span class="keywordflow">else</span> <span class="keywordflow">return</span> 0;
02148   }
02149   <span class="keywordflow">return</span> 0.;
02150 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="b5" doxytag="MadMKAnalysis::RecoMuDCosNeuFD" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> Float_t MadMKAnalysis::RecoMuDCosNeuFD </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Int_t&nbsp;</td>
          <td class="mdname" nowrap> <em>itr</em> = 0, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>Float_t *&nbsp;</td>
          <td class="mdname" nowrap> <em>vtx</em> = 0</td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected, virtual]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8cxx-source.html#l02191">2191</a> of file <a class="el" href="MadMKAnalysis_8cxx-source.html">MadMKAnalysis.cxx</a>.
<p>
References <a class="el" href="NtpSRVertex_8h-source.html#l00047">NtpSRVertex::dcosy</a>, <a class="el" href="NtpSRVertex_8h-source.html#l00048">NtpSRVertex::dcosz</a>, <a class="el" href="MadBase_8cxx-source.html#l00227">MadBase::LoadTrack()</a>, and <a class="el" href="NtpSRTrack_8h-source.html#l00101">NtpSRTrack::vtx</a>.
<p>
Referenced by <a class="el" href="MadMKAnalysis_8cxx-source.html#l00265">CreatePAN()</a>.
<p>
<div class="fragment"><pre>02191                                                                    {
02192   <span class="keywordflow">if</span>(!<a class="code" href="classMadBase.html#b0">LoadTrack</a>(itr)) <span class="keywordflow">return</span> 0.;
02193 
02194   Float_t bl_z = TMath::Cos(TMath::Pi()*3./180.); <span class="comment">//3degree beam</span>
02195   Float_t bl_y = sqrt(1. - bl_z*bl_z);
02196   Float_t costhbl = <a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o34">vtx</a>.<a class="code" href="classNtpSRVertex.html#o11">dcosz</a>*bl_z + <a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o34">vtx</a>.<a class="code" href="classNtpSRVertex.html#o10">dcosy</a>*bl_y;
02197   
02198   <span class="keywordflow">return</span>  costhbl;
02199 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="b4" doxytag="MadMKAnalysis::RecoMuDCosNeuND" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> Float_t MadMKAnalysis::RecoMuDCosNeuND </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Int_t&nbsp;</td>
          <td class="mdname" nowrap> <em>itr</em> = 0, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>Float_t *&nbsp;</td>
          <td class="mdname" nowrap> <em>vtx</em> = 0</td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected, virtual]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8cxx-source.html#l02201">2201</a> of file <a class="el" href="MadMKAnalysis_8cxx-source.html">MadMKAnalysis.cxx</a>.
<p>
References <a class="el" href="NtpSRVertex_8h-source.html#l00047">NtpSRVertex::dcosy</a>, <a class="el" href="NtpSRVertex_8h-source.html#l00048">NtpSRVertex::dcosz</a>, <a class="el" href="MadBase_8cxx-source.html#l00227">MadBase::LoadTrack()</a>, and <a class="el" href="NtpSRTrack_8h-source.html#l00101">NtpSRTrack::vtx</a>.
<p>
Referenced by <a class="el" href="MadMKAnalysis_8cxx-source.html#l00265">CreatePAN()</a>.
<p>
<div class="fragment"><pre>02201                                                                    {
02202   <span class="keywordflow">if</span>(!<a class="code" href="classMadBase.html#b0">LoadTrack</a>(itr)) <span class="keywordflow">return</span> 0.;
02203   <span class="comment">/*</span>
02204 <span class="comment">   // simple correction based on the vertical position</span>
02205 <span class="comment">  float vtxy=0;</span>
02206 <span class="comment">  if(vtx) vtxy=vtx[1]; // in meters</span>
02207 <span class="comment">  // cosine of the typical neutrino angle in the yz plane</span>
02208 <span class="comment">  // calculated as py / sqrt( py^2 + pz^2)</span>
02209 <span class="comment">  float nu_cos = -5.799E-2;</span>
02210 <span class="comment">  if(vtxy&gt;-2.0 &amp;&amp; vtxy&lt;2.0){ //prevents further nuttyness if vtxy is silly</span>
02211 <span class="comment">    nu_cos += vtxy*1.23304E-3 </span>
02212 <span class="comment">      + vtxy*vtxy*1.08212E-5 </span>
02213 <span class="comment">      + vtxy*vtxy*vtxy*(-4.634E-5);</span>
02214 <span class="comment">  }</span>
02215 <span class="comment">  */</span>
02216   <span class="keywordtype">float</span> nu_cos = -5.799E-2;
02217   <span class="keywordtype">float</span> nu_sin = sqrt(1 -nu_cos*nu_cos);
02218   <span class="keywordtype">float</span> cosz = <a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o34">vtx</a>.<a class="code" href="classNtpSRVertex.html#o11">dcosz</a>*nu_sin + <a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o34">vtx</a>.<a class="code" href="classNtpSRVertex.html#o10">dcosy</a>*nu_cos;
02219 
02220   <span class="keywordflow">return</span> cosz;
02221 
02222 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="b2" doxytag="MadMKAnalysis::RecoShwEnergy" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> Float_t MadMKAnalysis::RecoShwEnergy </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>ishw</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>const <a class="el" href="classDetector.html#w0">Detector::Detector_t</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>det</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>mode</em> = 1, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>bool&nbsp;</td>
          <td class="mdname" nowrap> <em>isdata</em> = true</td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8cxx-source.html#l02152">2152</a> of file <a class="el" href="MadMKAnalysis_8cxx-source.html">MadMKAnalysis.cxx</a>.
<p>
References <a class="el" href="EnergyCorrections_8cxx-source.html#l00797">EnergyCorrections::CorrectShowerEnergy()</a>, <a class="el" href="classDetector.html#w0">Detector::Detector_t</a>, <a class="el" href="NtpSRStripPulseHeight_8h-source.html#l00034">NtpSRStripPulseHeight::gev</a>, <a class="el" href="NtpSRShowerPulseHeight_8h-source.html#l00033">NtpSRShowerPulseHeight::linCCgev</a>, <a class="el" href="MadBase_8cxx-source.html#l00323">MadBase::LoadShower()</a>, <a class="el" href="NtpSRShower_8h-source.html#l00095">NtpSRShower::ph</a>, and <a class="el" href="NtpSRShower_8h-source.html#l00096">NtpSRShower::shwph</a>.
<p>
Referenced by <a class="el" href="MadMKAnalysis_8cxx-source.html#l00265">CreatePAN()</a>.
<p>
<div class="fragment"><pre>02152                                                                                                  {
02153   
02154   Float_t result = 0;
02155   <span class="comment">// Return Jim's calculation</span>
02156   Bool_t ok = <a class="code" href="classMadBase.html#b1">LoadShower</a>(opt);
02157   <span class="keywordflow">if</span>(!ok) <span class="keywordflow">return</span> 0;
02158 
02159   <span class="comment">// test for shwph.linCCGeV&lt;=0.0</span>
02160   <span class="comment">// if so, assume that this is an R1.16 object</span>
02161   <span class="comment">// and use ph.gev</span>
02162   result = <a class="code" href="classMadBase.html#p15">ntpShower</a>-&gt;<a class="code" href="classNtpSRShower.html#o29">shwph</a>.<a class="code" href="classNtpSRShowerPulseHeight.html#o0">linCCgev</a>;
02163   <span class="keywordflow">if</span>(result&lt;=0.0) result=(<a class="code" href="classMadBase.html#p15">ntpShower</a>-&gt;<a class="code" href="classNtpSRShower.html#o28">ph</a>.<a class="code" href="classNtpSRStripPulseHeight.html#o2">gev</a>/1.23);
02164   <span class="keywordflow">else</span>{
02165      result = <a class="code" href="namespaceEnergyCorrections.html#a59">CorrectShowerEnergy</a>(result,det,CandShowerHandle::kCC,mode,isdata);
02166   }
02167   <span class="keywordflow">return</span> result;
02168   
02169 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="b9" doxytag="MadMKAnalysis::SetBECFile" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void MadMKAnalysis::SetBECFile </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>f</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8cxx-source.html#l02462">2462</a> of file <a class="el" href="MadMKAnalysis_8cxx-source.html">MadMKAnalysis.cxx</a>.
<p>
References <a class="el" href="MadMKAnalysis_8h-source.html#l00226">fBECConfig</a>, and <a class="el" href="classRegistry.html#a37">Registry::Set()</a>.
<p>
<div class="fragment"><pre>02462                                            {
02463   <span class="keywordflow">if</span>(f){
02464     <a class="code" href="classMadMKAnalysis.html#r0">fBECConfig</a>.<a class="code" href="classRegistry.html#a37">Set</a>(<span class="stringliteral">"beam:flux_file"</span>,f);
02465   }
02466 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="MadMKAnalysis::SetDataUseMCBeam" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void MadMKAnalysis::SetDataUseMCBeam </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">bool&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>x</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8h-source.html#l00135">135</a> of file <a class="el" href="MadMKAnalysis_8h-source.html">MadMKAnalysis.h</a>.
<p>
References <a class="el" href="MadMKAnalysis_8h-source.html#l00228">fDataUseMCBeam</a>.
<p>
<div class="fragment"><pre>00135 {<a class="code" href="classMadMKAnalysis.html#r2">fDataUseMCBeam</a>=x;}
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="MadMKAnalysis::SetNRandomSets" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void MadMKAnalysis::SetNRandomSets </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>i</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8h-source.html#l00142">142</a> of file <a class="el" href="MadMKAnalysis_8h-source.html">MadMKAnalysis.h</a>.
<p>
References <a class="el" href="MadMKAnalysis_8h-source.html#l00231">fNRandomSets</a>.
<p>
<div class="fragment"><pre>00142 {<a class="code" href="classMadMKAnalysis.html#r5">fNRandomSets</a>=i;}
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="b1" doxytag="MadMKAnalysis::SigInOut" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void MadMKAnalysis::SigInOut </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Int_t&nbsp;</td>
          <td class="mdname" nowrap> <em>trkidx</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>Float_t &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>sigfull</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>Float_t &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>sigpart</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>Float_t &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>trkfull</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>Float_t &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>trkpart</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8cxx-source.html#l02454">2454</a> of file <a class="el" href="MadMKAnalysis_8cxx-source.html">MadMKAnalysis.cxx</a>.
<p>
References <a class="el" href="MadBase_8cxx-source.html#l00227">MadBase::LoadTrack()</a>, and <a class="el" href="MadMKAnalysis_8cxx-source.html#l02410">SigInOut()</a>.
<p>
<div class="fragment"><pre>02455                                                                 {
02456   <span class="comment">// will try to load the track pointed to by trkidx</span>
02457   <span class="keywordflow">if</span>(trkidx==-1) <a class="code" href="classMadBase.html#p14">ntpTrack</a>=0;
02458   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!(<a class="code" href="classMadBase.html#b0">LoadTrack</a>(trkidx))) <a class="code" href="classMadBase.html#p14">ntpTrack</a>=0;
02459   <a class="code" href="classMadMKAnalysis.html#b0">SigInOut</a>(sigfull,sigpart,trkfull,trkpart);
02460 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="b0" doxytag="MadMKAnalysis::SigInOut" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void MadMKAnalysis::SigInOut </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Float_t &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>sigfull</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>Float_t &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>sigpart</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>Float_t &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>trkfull</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>Float_t &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>trkpart</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8cxx-source.html#l02410">2410</a> of file <a class="el" href="MadMKAnalysis_8cxx-source.html">MadMKAnalysis.cxx</a>.
<p>
References <a class="el" href="MadMKAnalysis_8cxx-source.html#l02350">InPartialRegion()</a>, <a class="el" href="MadBase_8cxx-source.html#l00692">MadBase::LoadStrip()</a>, <a class="el" href="NtpSRTrack_8h-source.html#l00070">NtpSRTrack::nstrip</a>, <a class="el" href="NtpSREvent_8h-source.html#l00062">NtpSREvent::nstrip</a>, <a class="el" href="NtpSRStrip_8h-source.html#l00059">NtpSRStrip::ph0</a>, <a class="el" href="NtpSRStrip_8h-source.html#l00060">NtpSRStrip::ph1</a>, <a class="el" href="NtpSRStrip_8h-source.html#l00052">NtpSRStrip::plane</a>, <a class="el" href="NtpSRPulseHeight_8h-source.html#l00037">NtpSRPulseHeight::sigcor</a>, <a class="el" href="NtpSRTrack_8h-source.html#l00071">NtpSRTrack::stp</a>, <a class="el" href="NtpSREvent_8h-source.html#l00063">NtpSREvent::stp</a>, and <a class="el" href="NtpSRStrip_8h-source.html#l00051">NtpSRStrip::strip</a>.
<p>
Referenced by <a class="el" href="MadMKAnalysis_8cxx-source.html#l00265">CreatePAN()</a>, and <a class="el" href="MadMKAnalysis_8cxx-source.html#l02454">SigInOut()</a>.
<p>
<div class="fragment"><pre>02411                                                                 {
02412   <span class="comment">// compute the amount of signal in the partially instrumented region</span>
02413   <span class="comment">// and the amount in the fully instrumented region</span>
02414   <span class="comment">//</span>
02415   <span class="comment">// this region is defined as:</span>
02416   <span class="comment">// v planes: (strip&lt;=4 || strip&gt;=67)</span>
02417   <span class="comment">// partial u: (strip==0 || strip=63)</span>
02418   <span class="comment">// full u: (strip&lt;=26 || strip&gt;=88) </span>
02419 
02420   sigfull=sigpart=0;
02421  
02422   <span class="comment">// loop over all strips in the event</span>
02423   <span class="comment">// and sum the signals in the partial and full regions</span>
02424   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o4">nstrip</a>; i++){
02425     <span class="keywordflow">if</span>(!<a class="code" href="classMadBase.html#b6">LoadStrip</a>(<a class="code" href="classMadBase.html#p13">ntpEvent</a>-&gt;<a class="code" href="classNtpSREvent.html#o5">stp</a>[i])) <span class="keywordflow">continue</span>;
02426     Int_t pr = <a class="code" href="classMadMKAnalysis.html#e2">InPartialRegion</a>(<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o5">plane</a>, <a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o4">strip</a>);
02427     <span class="keywordflow">if</span>(pr==1){
02428       sigpart+=<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o12">ph0</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a> + <a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o13">ph1</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>;
02429     }
02430     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(pr==-1){
02431       sigfull+=<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o12">ph0</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a> + <a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o13">ph1</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>;
02432     }
02433   }
02434   
02435   <span class="comment">// loop over those strips in the primary track</span>
02436 
02437   trkfull=trkpart=0;
02438 
02439   <span class="keywordflow">if</span>(<a class="code" href="classMadBase.html#p14">ntpTrack</a>){
02440     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o4">nstrip</a>; i++){
02441       <span class="keywordflow">if</span>(!<a class="code" href="classMadBase.html#b6">LoadStrip</a>(<a class="code" href="classMadBase.html#p14">ntpTrack</a>-&gt;<a class="code" href="classNtpSRTrack.html#o5">stp</a>[i])) <span class="keywordflow">continue</span>;
02442       Int_t pr = <a class="code" href="classMadMKAnalysis.html#e2">InPartialRegion</a>(<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o5">plane</a>, <a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o4">strip</a>);
02443       <span class="keywordflow">if</span>(pr==1){
02444         trkpart+=<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o12">ph0</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a> + <a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o13">ph1</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>;
02445       }
02446       <span class="keywordflow">else</span> <span class="keywordflow">if</span>(pr==-1){
02447         trkfull+=<a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o12">ph0</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a> + <a class="code" href="classMadBase.html#p19">ntpStrip</a>-&gt;<a class="code" href="classNtpSRStrip.html#o13">ph1</a>.<a class="code" href="classNtpSRPulseHeight.html#o2">sigcor</a>;
02448       }
02449     }
02450   }
02451   
02452 }
</pre></div>    </td>
  </tr>
</table>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="o1" doxytag="MadMKAnalysis::dpid" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="classMadDpID.html">MadDpID</a> <a class="el" href="classMadMKAnalysis.html#o1">MadMKAnalysis::dpid</a>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8h-source.html#l00145">145</a> of file <a class="el" href="MadMKAnalysis_8h-source.html">MadMKAnalysis.h</a>.
<p>
Referenced by <a class="el" href="MadMKAnalysis_8cxx-source.html#l00265">CreatePAN()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r0" doxytag="MadMKAnalysis::fBECConfig" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="classRegistry.html">Registry</a> <a class="el" href="classMadMKAnalysis.html#r0">MadMKAnalysis::fBECConfig</a><code> [private]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8h-source.html#l00226">226</a> of file <a class="el" href="MadMKAnalysis_8h-source.html">MadMKAnalysis.h</a>.
<p>
Referenced by <a class="el" href="MadMKAnalysis_8cxx-source.html#l00265">CreatePAN()</a>, <a class="el" href="MadMKAnalysis_8h-source.html#l00178">GetBECRegistry()</a>, <a class="el" href="MadMKAnalysis_8cxx-source.html#l00192">MadMKAnalysis()</a>, and <a class="el" href="MadMKAnalysis_8cxx-source.html#l02462">SetBECFile()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r2" doxytag="MadMKAnalysis::fDataUseMCBeam" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> bool <a class="el" href="classMadMKAnalysis.html#r2">MadMKAnalysis::fDataUseMCBeam</a><code> [private]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8h-source.html#l00228">228</a> of file <a class="el" href="MadMKAnalysis_8h-source.html">MadMKAnalysis.h</a>.
<p>
Referenced by <a class="el" href="MadMKAnalysis_8cxx-source.html#l00265">CreatePAN()</a>, <a class="el" href="MadMKAnalysis_8cxx-source.html#l00192">MadMKAnalysis()</a>, and <a class="el" href="MadMKAnalysis_8h-source.html#l00135">SetDataUseMCBeam()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r3" doxytag="MadMKAnalysis::fDoInukeReweight" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> bool <a class="el" href="classMadMKAnalysis.html#r3">MadMKAnalysis::fDoInukeReweight</a><code> [private]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8h-source.html#l00229">229</a> of file <a class="el" href="MadMKAnalysis_8h-source.html">MadMKAnalysis.h</a>.
<p>
Referenced by <a class="el" href="MadMKAnalysis_8cxx-source.html#l00265">CreatePAN()</a>, <a class="el" href="MadMKAnalysis_8h-source.html#l00141">DoInukeReweight()</a>, and <a class="el" href="MadMKAnalysis_8cxx-source.html#l00192">MadMKAnalysis()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="v7" doxytag="MadMKAnalysis::fEarlyActivityWindowSize" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> const Double_t <a class="el" href="classMadMKAnalysis.html#v7">MadMKAnalysis::fEarlyActivityWindowSize</a> = 10.<code> [static, private]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8cxx-source.html#l00187">187</a> of file <a class="el" href="MadMKAnalysis_8cxx-source.html">MadMKAnalysis.cxx</a>.
<p>
Referenced by <a class="el" href="MadMKAnalysis_8cxx-source.html#l02802">EarlyActivity()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="v10" doxytag="MadMKAnalysis::fEarlyPlaneSphere" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> const Double_t <a class="el" href="classMadMKAnalysis.html#v10">MadMKAnalysis::fEarlyPlaneSphere</a> = 0.5<code> [static, private]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8cxx-source.html#l00190">190</a> of file <a class="el" href="MadMKAnalysis_8cxx-source.html">MadMKAnalysis.cxx</a>.
<p>
Referenced by <a class="el" href="MadMKAnalysis_8cxx-source.html#l02802">EarlyActivity()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r1" doxytag="MadMKAnalysis::fMCBeam" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="namespaceBeamType.html#a0">BeamType::BeamType_t</a> <a class="el" href="classMadMKAnalysis.html#r1">MadMKAnalysis::fMCBeam</a><code> [private]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8h-source.html#l00227">227</a> of file <a class="el" href="MadMKAnalysis_8h-source.html">MadMKAnalysis.h</a>.
<p>
Referenced by <a class="el" href="MadMKAnalysis_8cxx-source.html#l00265">CreatePAN()</a>, <a class="el" href="MadMKAnalysis_8h-source.html#l00133">ForceMCBeam()</a>, <a class="el" href="MadMKAnalysis_8h-source.html#l00134">GetForcedMCBeam()</a>, and <a class="el" href="MadMKAnalysis_8cxx-source.html#l00192">MadMKAnalysis()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="v9" doxytag="MadMKAnalysis::fNPlaneEarlyAct" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> const Int_t <a class="el" href="classMadMKAnalysis.html#v9">MadMKAnalysis::fNPlaneEarlyAct</a> = 30<code> [static, private]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8cxx-source.html#l00189">189</a> of file <a class="el" href="MadMKAnalysis_8cxx-source.html">MadMKAnalysis.cxx</a>.
<p>
Referenced by <a class="el" href="MadMKAnalysis_8cxx-source.html#l02802">EarlyActivity()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r5" doxytag="MadMKAnalysis::fNRandomSets" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int <a class="el" href="classMadMKAnalysis.html#r5">MadMKAnalysis::fNRandomSets</a><code> [private]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8h-source.html#l00231">231</a> of file <a class="el" href="MadMKAnalysis_8h-source.html">MadMKAnalysis.h</a>.
<p>
Referenced by <a class="el" href="MadMKAnalysis_8cxx-source.html#l00265">CreatePAN()</a>, <a class="el" href="MadMKAnalysis_8cxx-source.html#l00192">MadMKAnalysis()</a>, and <a class="el" href="MadMKAnalysis_8h-source.html#l00142">SetNRandomSets()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r4" doxytag="MadMKAnalysis::fOnlyWriteFidEvents" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> bool <a class="el" href="classMadMKAnalysis.html#r4">MadMKAnalysis::fOnlyWriteFidEvents</a><code> [private]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8h-source.html#l00230">230</a> of file <a class="el" href="MadMKAnalysis_8h-source.html">MadMKAnalysis.h</a>.
<p>
Referenced by <a class="el" href="MadMKAnalysis_8cxx-source.html#l00265">CreatePAN()</a>, <a class="el" href="MadMKAnalysis_8cxx-source.html#l00192">MadMKAnalysis()</a>, and <a class="el" href="MadMKAnalysis_8h-source.html#l00136">OnlyWriteFidEvents()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="v8" doxytag="MadMKAnalysis::fPMTTimeConstant" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> const Double_t <a class="el" href="classMadMKAnalysis.html#v8">MadMKAnalysis::fPMTTimeConstant</a> = 700.<code> [static, private]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8cxx-source.html#l00188">188</a> of file <a class="el" href="MadMKAnalysis_8cxx-source.html">MadMKAnalysis.cxx</a>.
<p>
Referenced by <a class="el" href="MadMKAnalysis_8cxx-source.html#l02802">EarlyActivity()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="v2" doxytag="MadMKAnalysis::kCalorEndZ" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> const Float_t <a class="el" href="classMadMKAnalysis.html#v2">MadMKAnalysis::kCalorEndZ</a> = 7.1554<code> [static, private]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8cxx-source.html#l00181">181</a> of file <a class="el" href="MadMKAnalysis_8cxx-source.html">MadMKAnalysis.cxx</a>.    </td>
  </tr>
</table>
<a class="anchor" name="v3" doxytag="MadMKAnalysis::kHalfCalorEndZ" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> const Float_t <a class="el" href="classMadMKAnalysis.html#v3">MadMKAnalysis::kHalfCalorEndZ</a> = <a class="el" href="classMadMKAnalysis.html#v1">kTargEndZ</a>+(<a class="el" href="classMadMKAnalysis.html#v2">kCalorEndZ</a>-<a class="el" href="classMadMKAnalysis.html#v1">kTargEndZ</a>)*0.5<code> [static, private]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8cxx-source.html#l00182">182</a> of file <a class="el" href="MadMKAnalysis_8cxx-source.html">MadMKAnalysis.cxx</a>.    </td>
  </tr>
</table>
<a class="anchor" name="v4" doxytag="MadMKAnalysis::kSpecEndZ" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> const Float_t <a class="el" href="classMadMKAnalysis.html#v4">MadMKAnalysis::kSpecEndZ</a> = 16.656<code> [static, private]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8cxx-source.html#l00183">183</a> of file <a class="el" href="MadMKAnalysis_8cxx-source.html">MadMKAnalysis.cxx</a>.    </td>
  </tr>
</table>
<a class="anchor" name="v1" doxytag="MadMKAnalysis::kTargEndZ" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> const Float_t <a class="el" href="classMadMKAnalysis.html#v1">MadMKAnalysis::kTargEndZ</a> = 3.5914<code> [static, private]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8cxx-source.html#l00180">180</a> of file <a class="el" href="MadMKAnalysis_8cxx-source.html">MadMKAnalysis.cxx</a>.
<p>
Referenced by <a class="el" href="MadMKAnalysis_8cxx-source.html#l02266">NDRadialFidVol()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="v0" doxytag="MadMKAnalysis::kVetoEndZ" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> const Float_t <a class="el" href="classMadMKAnalysis.html#v0">MadMKAnalysis::kVetoEndZ</a> = 1.2154<code> [static, private]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8cxx-source.html#l00179">179</a> of file <a class="el" href="MadMKAnalysis_8cxx-source.html">MadMKAnalysis.cxx</a>.
<p>
Referenced by <a class="el" href="MadMKAnalysis_8cxx-source.html#l02266">NDRadialFidVol()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="v5" doxytag="MadMKAnalysis::kXcenter" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> const Float_t <a class="el" href="classMadMKAnalysis.html#v5">MadMKAnalysis::kXcenter</a> = 1.4885<code> [static, private]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8cxx-source.html#l00184">184</a> of file <a class="el" href="MadMKAnalysis_8cxx-source.html">MadMKAnalysis.cxx</a>.
<p>
Referenced by <a class="el" href="MadMKAnalysis_8cxx-source.html#l00265">CreatePAN()</a>, <a class="el" href="MadMKAnalysis_8cxx-source.html#l02072">InFidVol()</a>, and <a class="el" href="MadMKAnalysis_8cxx-source.html#l02266">NDRadialFidVol()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="v6" doxytag="MadMKAnalysis::kYcenter" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> const Float_t <a class="el" href="classMadMKAnalysis.html#v6">MadMKAnalysis::kYcenter</a> = 0.1397<code> [static, private]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8cxx-source.html#l00185">185</a> of file <a class="el" href="MadMKAnalysis_8cxx-source.html">MadMKAnalysis.cxx</a>.
<p>
Referenced by <a class="el" href="MadMKAnalysis_8cxx-source.html#l00265">CreatePAN()</a>, <a class="el" href="MadMKAnalysis_8cxx-source.html#l02072">InFidVol()</a>, and <a class="el" href="MadMKAnalysis_8cxx-source.html#l02266">NDRadialFidVol()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="o0" doxytag="MadMKAnalysis::nsid" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="classMadNsID.html">MadNsID</a> <a class="el" href="classMadMKAnalysis.html#o0">MadMKAnalysis::nsid</a>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8h-source.html#l00144">144</a> of file <a class="el" href="MadMKAnalysis_8h-source.html">MadMKAnalysis.h</a>.
<p>
Referenced by <a class="el" href="MadMKAnalysis_8cxx-source.html#l00265">CreatePAN()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="o2" doxytag="MadMKAnalysis::qeid" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="classMadQEID.html">MadQEID</a> <a class="el" href="classMadMKAnalysis.html#o2">MadMKAnalysis::qeid</a>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="MadMKAnalysis_8h-source.html#l00146">146</a> of file <a class="el" href="MadMKAnalysis_8h-source.html">MadMKAnalysis.h</a>.
<p>
Referenced by <a class="el" href="MadMKAnalysis_8cxx-source.html#l00265">CreatePAN()</a>.    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="MadMKAnalysis_8h-source.html">MadMKAnalysis.h</a><li><a class="el" href="MadMKAnalysis_8cxx-source.html">MadMKAnalysis.cxx</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Mon Feb 16 04:55:58 2009 for loon by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.5 </small></address>
</body>
</html>
